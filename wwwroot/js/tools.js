(()=>{var arrayApply=function(fs){return function(xs){var l=fs.length;var k=xs.length;var result=new Array(l*k);var n=0;for(var i3=0;i3<l;i3++){var f=fs[i3];for(var j=0;j<k;j++){result[n++]=f(xs[j])}}return result}};var semigroupoidFn={compose:function(f){return function(g){return function(x){return f(g(x))}}}};var compose=function(dict){return dict.compose};var identity=function(dict){return dict.identity};var categoryFn={identity:function(x){return x},Semigroupoid0:function(){return semigroupoidFn}};var otherwise=true;var flip=function(f){return function(b){return function(a3){return f(a3)(b)}}};var $$const=function(a3){return function(v){return a3}};var arrayMap=function(f){return function(arr){var l=arr.length;var result=new Array(l);for(var i3=0;i3<l;i3++){result[i3]=f(arr[i3])}return result}};var unit=void 0;var $$Proxy=function(){function $$Proxy2(){}$$Proxy2.value=new $$Proxy2;return $$Proxy2}();var map=function(dict){return dict.map};var $$void=function(dictFunctor){return map(dictFunctor)($$const(unit))};var functorArray={map:arrayMap};var identity2=identity(categoryFn);var applyArray={apply:arrayApply,Functor0:function(){return functorArray}};var apply=function(dict){return dict.apply};var applySecond=function(dictApply){var apply1=apply(dictApply);var map16=map(dictApply.Functor0());return function(a3){return function(b){return apply1(map16($$const(identity2))(a3))(b)}}};var pure=function(dict){return dict.pure};var when=function(dictApplicative){var pure13=pure(dictApplicative);return function(v){return function(v1){if(v){return v1}if(!v){return pure13(unit)}throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[v.constructor.name,v1.constructor.name])}}};var liftA1=function(dictApplicative){var apply3=apply(dictApplicative.Apply0());var pure13=pure(dictApplicative);return function(f){return function(a3){return apply3(pure13(f))(a3)}}};var concatArray=function(xs){return function(ys){if(xs.length===0)return ys;if(ys.length===0)return xs;return xs.concat(ys)}};var reflectSymbol=function(dict){return dict.reflectSymbol};var unsafeGet=function(label6){return function(rec){return rec[label6]}};var semigroupArray={append:concatArray};var append=function(dict){return dict.append};var topInt=2147483647;var bottomInt=-2147483648;var topChar=String.fromCharCode(65535);var bottomChar=String.fromCharCode(0);var topNumber=Number.POSITIVE_INFINITY;var bottomNumber=Number.NEGATIVE_INFINITY;var unsafeCompareImpl=function(lt){return function(eq2){return function(gt){return function(x){return function(y){return x<y?lt:x===y?eq2:gt}}}}};var ordIntImpl=unsafeCompareImpl;var ordCharImpl=unsafeCompareImpl;var refEq=function(r1){return function(r2){return r1===r2}};var eqBooleanImpl=refEq;var eqIntImpl=refEq;var eqCharImpl=refEq;var eqStringImpl=refEq;var eqArrayImpl=function(f){return function(xs){return function(ys){if(xs.length!==ys.length)return false;for(var i3=0;i3<xs.length;i3++){if(!f(xs[i3])(ys[i3]))return false}return true}}};var eqString={eq:eqStringImpl};var eqRowNil={eqRecord:function(v){return function(v1){return function(v2){return true}}}};var eqRecord=function(dict){return dict.eqRecord};var eqRec=function(){return function(dictEqRecord){return{eq:eqRecord(dictEqRecord)($$Proxy.value)}}};var eqInt={eq:eqIntImpl};var eqChar={eq:eqCharImpl};var eqBoolean={eq:eqBooleanImpl};var eq=function(dict){return dict.eq};var eqArray=function(dictEq){return{eq:eqArrayImpl(eq(dictEq))}};var eqRowCons=function(dictEqRecord){var eqRecord1=eqRecord(dictEqRecord);return function(){return function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(dictEq){var eq3=eq(dictEq);return{eqRecord:function(v){return function(ra){return function(rb){var tail2=eqRecord1($$Proxy.value)(ra)(rb);var key=reflectSymbol2($$Proxy.value);var get2=unsafeGet(key);return eq3(get2(ra))(get2(rb))&&tail2}}}}}}}};var LT=function(){function LT2(){}LT2.value=new LT2;return LT2}();var GT=function(){function GT2(){}GT2.value=new GT2;return GT2}();var EQ=function(){function EQ2(){}EQ2.value=new EQ2;return EQ2}();var intSub=function(x){return function(y){return x-y|0}};var intAdd=function(x){return function(y){return x+y|0}};var intMul=function(x){return function(y){return x*y|0}};var semiringInt={add:intAdd,zero:0,mul:intMul,one:1};var add=function(dict){return dict.add};var ringInt={sub:intSub,Semiring0:function(){return semiringInt}};var ordInt=function(){return{compare:ordIntImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqInt}}}();var ordChar=function(){return{compare:ordCharImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqChar}}}();var compare=function(dict){return dict.compare};var max=function(dictOrd){var compare3=compare(dictOrd);return function(x){return function(y){var v=compare3(x)(y);if(v instanceof LT){return y}if(v instanceof EQ){return x}if(v instanceof GT){return x}throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[v.constructor.name])}}};var min=function(dictOrd){var compare3=compare(dictOrd);return function(x){return function(y){var v=compare3(x)(y);if(v instanceof LT){return x}if(v instanceof EQ){return x}if(v instanceof GT){return y}throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[v.constructor.name])}}};var top=function(dict){return dict.top};var boundedInt={top:topInt,bottom:bottomInt,Ord0:function(){return ordInt}};var boundedChar={top:topChar,bottom:bottomChar,Ord0:function(){return ordChar}};var bottom=function(dict){return dict.bottom};var showIntImpl=function(n){return n.toString()};var showStringImpl=function(s){var l=s.length;return'"'+s.replace(/[\0-\x1F\x7F"\\]/g,(function(c,i3){switch(c){case'"':case"\\":return"\\"+c;case"":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v"}var k=i3+1;var empty4=k<l&&s[k]>="0"&&s[k]<="9"?"\\&":"";return"\\"+c.charCodeAt(0).toString(10)+empty4}))+'"'};var showArrayImpl=function(f){return function(xs){var ss=[];for(var i3=0,l=xs.length;i3<l;i3++){ss[i3]=f(xs[i3])}return"["+ss.join(",")+"]"}};var showUnit={show:function(v){return"unit"}};var showString={show:showStringImpl};var showInt={show:showIntImpl};var show=function(dict){return dict.show};var showArray=function(dictShow){return{show:showArrayImpl(show(dictShow))}};var identity3=identity(categoryFn);var Nothing=function(){function Nothing2(){}Nothing2.value=new Nothing2;return Nothing2}();var Just=function(){function Just2(value0){this.value0=value0}Just2.create=function(value0){return new Just2(value0)};return Just2}();var maybe=function(v){return function(v1){return function(v2){if(v2 instanceof Nothing){return v}if(v2 instanceof Just){return v1(v2.value0)}throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}};var functorMaybe={map:function(v){return function(v1){if(v1 instanceof Just){return new Just(v(v1.value0))}return Nothing.value}}};var fromMaybe=function(a3){return maybe(a3)(identity3)};var fromJust=function(){return function(v){if(v instanceof Just){return v.value0}throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[v.constructor.name])}};var eqMaybe=function(dictEq){var eq2=eq(dictEq);return{eq:function(x){return function(y){if(x instanceof Nothing&&y instanceof Nothing){return true}if(x instanceof Just&&y instanceof Just){return eq2(x.value0)(y.value0)}return false}}}};var Left=function(){function Left2(value0){this.value0=value0}Left2.create=function(value0){return new Left2(value0)};return Left2}();var Right=function(){function Right2(value0){this.value0=value0}Right2.create=function(value0){return new Right2(value0)};return Right2}();var functorEither={map:function(f){return function(m){if(m instanceof Left){return new Left(m.value0)}if(m instanceof Right){return new Right(f(m.value0))}throw new Error("Failed pattern match at Data.Either (line 0, column 0 - line 0, column 0): "+[m.constructor.name])}}};var map2=map(functorEither);var either=function(v){return function(v1){return function(v2){if(v2 instanceof Left){return v(v2.value0)}if(v2 instanceof Right){return v1(v2.value0)}throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}};var applyEither={apply:function(v){return function(v1){if(v instanceof Left){return new Left(v.value0)}if(v instanceof Right){return map2(v.value0)(v1)}throw new Error("Failed pattern match at Data.Either (line 70, column 1 - line 72, column 30): "+[v.constructor.name,v1.constructor.name])}},Functor0:function(){return functorEither}};var applicativeEither=function(){return{pure:Right.create,Apply0:function(){return applyEither}}}();var foldrArray=function(f){return function(init4){return function(xs){var acc=init4;var len=xs.length;for(var i3=len-1;i3>=0;i3--){acc=f(xs[i3])(acc)}return acc}}};var foldlArray=function(f){return function(init4){return function(xs){var acc=init4;var len=xs.length;for(var i3=0;i3<len;i3++){acc=f(acc)(xs[i3])}return acc}}};var arrayBind=typeof Array.prototype.flatMap==="function"?function(arr){return function(f){return arr.flatMap(f)}}:function(arr){return function(f){var result=[];var l=arr.length;for(var i3=0;i3<l;i3++){var xs=f(arr[i3]);var k=xs.length;for(var j=0;j<k;j++){result.push(xs[j])}}return result}};var bindArray={bind:arrayBind,Apply0:function(){return applyArray}};var bind=function(dict){return dict.bind};var bindFlipped=function(dictBind){return flip(bind(dictBind))};var composeKleisliFlipped=function(dictBind){var bindFlipped1=bindFlipped(dictBind);return function(f){return function(g){return function(a3){return bindFlipped1(f)(g(a3))}}}};var empty=function(dict){return dict.empty};var boolConj=function(b1){return function(b2){return b1&&b2}};var boolDisj=function(b1){return function(b2){return b1||b2}};var boolNot=function(b){return!b};var not=function(dict){return dict.not};var disj=function(dict){return dict.disj};var heytingAlgebraBoolean={ff:false,tt:true,implies:function(a3){return function(b){return disj(heytingAlgebraBoolean)(not(heytingAlgebraBoolean)(a3))(b)}},conj:boolConj,disj:boolDisj,not:boolNot};var intDegree=function(x){return Math.min(Math.abs(x),2147483647)};var intDiv=function(x){return function(y){if(y===0)return 0;return y>0?Math.floor(x/y):-Math.floor(x/-y)}};var intMod=function(x){return function(y){if(y===0)return 0;var yy=Math.abs(y);return(x%yy+yy)%yy}};var commutativeRingInt={Ring0:function(){return ringInt}};var mod=function(dict){return dict.mod};var euclideanRingInt={degree:intDegree,div:intDiv,mod:intMod,CommutativeRing0:function(){return commutativeRingInt}};var div=function(dict){return dict.div};var mempty=function(dict){return dict.mempty};var Tuple=function(){function Tuple2(value0,value1){this.value0=value0;this.value1=value1}Tuple2.create=function(value0){return function(value1){return new Tuple2(value0,value1)}};return Tuple2}();var identity4=identity(categoryFn);var bimap=function(dict){return dict.bimap};var lmap=function(dictBifunctor){var bimap1=bimap(dictBifunctor);return function(f){return bimap1(f)(identity4)}};var bifunctorEither={bimap:function(v){return function(v1){return function(v2){if(v2 instanceof Left){return new Left(v(v2.value0))}if(v2 instanceof Right){return new Right(v1(v2.value0))}throw new Error("Failed pattern match at Data.Bifunctor (line 32, column 1 - line 34, column 36): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}}};var unsafeCoerce2=function(x){return x};var coerce=function(){return unsafeCoerce2};var coerce2=coerce();var unwrap=function(){return coerce2};var foldr=function(dict){return dict.foldr};var traverse_=function(dictApplicative){var applySecond2=applySecond(dictApplicative.Apply0());var pure9=pure(dictApplicative);return function(dictFoldable){var foldr22=foldr(dictFoldable);return function(f){return foldr22((function($454){return applySecond2(f($454))}))(pure9(unit))}}};var for_=function(dictApplicative){var traverse_1=traverse_(dictApplicative);return function(dictFoldable){return flip(traverse_1(dictFoldable))}};var foldl=function(dict){return dict.foldl};var foldMapDefaultR=function(dictFoldable){var foldr22=foldr(dictFoldable);return function(dictMonoid){var append3=append(dictMonoid.Semigroup0());var mempty2=mempty(dictMonoid);return function(f){return foldr22((function(x){return function(acc){return append3(f(x))(acc)}}))(mempty2)}}};var foldableArray={foldr:foldrArray,foldl:foldlArray,foldMap:function(dictMonoid){return foldMapDefaultR(foldableArray)(dictMonoid)}};var pureE=function(a3){return function(){return a3}};var bindE=function(a3){return function(f){return function(){return f(a3())()}}};var ap=function(dictMonad){var bind3=bind(dictMonad.Bind1());var pure9=pure(dictMonad.Applicative0());return function(f){return function(a3){return bind3(f)((function(f$prime){return bind3(a3)((function(a$prime){return pure9(f$prime(a$prime))}))}))}}};var $runtime_lazy=function(name15,moduleName,init4){var state3=0;var val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init4();state3=2;return val}};var monadEffect={Applicative0:function(){return applicativeEffect},Bind1:function(){return bindEffect}};var bindEffect={bind:bindE,Apply0:function(){return $lazy_applyEffect(0)}};var applicativeEffect={pure:pureE,Apply0:function(){return $lazy_applyEffect(0)}};var $lazy_functorEffect=$runtime_lazy("functorEffect","Effect",(function(){return{map:liftA1(applicativeEffect)}}));var $lazy_applyEffect=$runtime_lazy("applyEffect","Effect",(function(){return{apply:ap(monadEffect),Functor0:function(){return $lazy_functorEffect(0)}}}));var functorEffect=$lazy_functorEffect(20);var Aff=function(){var EMPTY={};var PURE="Pure";var THROW="Throw";var CATCH="Catch";var SYNC="Sync";var ASYNC="Async";var BIND="Bind";var BRACKET="Bracket";var FORK="Fork";var SEQ="Sequential";var MAP="Map";var APPLY="Apply";var ALT="Alt";var CONS="Cons";var RESUME="Resume";var RELEASE="Release";var FINALIZER="Finalizer";var FINALIZED="Finalized";var FORKED="Forked";var FIBER="Fiber";var THUNK="Thunk";function Aff2(tag,_1,_2,_3){this.tag=tag;this._1=_1;this._2=_2;this._3=_3}function AffCtr(tag){var fn=function(_1,_2,_3){return new Aff2(tag,_1,_2,_3)};fn.tag=tag;return fn}function nonCanceler(error3){return new Aff2(PURE,void 0)}function runEff(eff){try{eff()}catch(error3){setTimeout((function(){throw error3}),0)}}function runSync(left,right,eff){try{return right(eff())}catch(error3){return left(error3)}}function runAsync(left,eff,k){try{return eff(k)()}catch(error3){k(left(error3))();return nonCanceler}}var Scheduler=function(){var limit=1024;var size5=0;var ix=0;var queue=new Array(limit);var draining=false;function drain(){var thunk;draining=true;while(size5!==0){size5--;thunk=queue[ix];queue[ix]=void 0;ix=(ix+1)%limit;thunk()}draining=false}return{isDraining:function(){return draining},enqueue:function(cb){var i3,tmp;if(size5===limit){tmp=draining;drain();draining=tmp}queue[(ix+size5)%limit]=cb;size5++;if(!draining){drain()}}}}();function Supervisor(util){var fibers={};var fiberId=0;var count=0;return{register:function(fiber){var fid=fiberId++;fiber.onComplete({rethrow:true,handler:function(result){return function(){count--;delete fibers[fid]}}})();fibers[fid]=fiber;count++},isEmpty:function(){return count===0},killAll:function(killError,cb){return function(){if(count===0){return cb()}var killCount=0;var kills={};function kill(fid){kills[fid]=fibers[fid].kill(killError,(function(result){return function(){delete kills[fid];killCount--;if(util.isLeft(result)&&util.fromLeft(result)){setTimeout((function(){throw util.fromLeft(result)}),0)}if(killCount===0){cb()}}}))()}for(var k in fibers){if(fibers.hasOwnProperty(k)){killCount++;kill(k)}}fibers={};fiberId=0;count=0;return function(error3){return new Aff2(SYNC,(function(){for(var k2 in kills){if(kills.hasOwnProperty(k2)){kills[k2]()}}}))}}}}}var SUSPENDED=0;var CONTINUE=1;var STEP_BIND=2;var STEP_RESULT=3;var PENDING=4;var RETURN=5;var COMPLETED=6;function Fiber(util,supervisor,aff){var runTick=0;var status=SUSPENDED;var step2=aff;var fail2=null;var interrupt=null;var bhead=null;var btail=null;var attempts=null;var bracketCount=0;var joinId=0;var joins=null;var rethrow=true;function run4(localRunTick){var tmp,result,attempt;while(true){tmp=null;result=null;attempt=null;switch(status){case STEP_BIND:status=CONTINUE;try{step2=bhead(step2);if(btail===null){bhead=null}else{bhead=btail._1;btail=btail._2}}catch(e){status=RETURN;fail2=util.left(e);step2=null}break;case STEP_RESULT:if(util.isLeft(step2)){status=RETURN;fail2=step2;step2=null}else if(bhead===null){status=RETURN}else{status=STEP_BIND;step2=util.fromRight(step2)}break;case CONTINUE:switch(step2.tag){case BIND:if(bhead){btail=new Aff2(CONS,bhead,btail)}bhead=step2._2;status=CONTINUE;step2=step2._1;break;case PURE:if(bhead===null){status=RETURN;step2=util.right(step2._1)}else{status=STEP_BIND;step2=step2._1}break;case SYNC:status=STEP_RESULT;step2=runSync(util.left,util.right,step2._1);break;case ASYNC:status=PENDING;step2=runAsync(util.left,step2._1,(function(result2){return function(){if(runTick!==localRunTick){return}runTick++;Scheduler.enqueue((function(){if(runTick!==localRunTick+1){return}status=STEP_RESULT;step2=result2;run4(runTick)}))}}));return;case THROW:status=RETURN;fail2=util.left(step2._1);step2=null;break;case CATCH:if(bhead===null){attempts=new Aff2(CONS,step2,attempts,interrupt)}else{attempts=new Aff2(CONS,step2,new Aff2(CONS,new Aff2(RESUME,bhead,btail),attempts,interrupt),interrupt)}bhead=null;btail=null;status=CONTINUE;step2=step2._1;break;case BRACKET:bracketCount++;if(bhead===null){attempts=new Aff2(CONS,step2,attempts,interrupt)}else{attempts=new Aff2(CONS,step2,new Aff2(CONS,new Aff2(RESUME,bhead,btail),attempts,interrupt),interrupt)}bhead=null;btail=null;status=CONTINUE;step2=step2._1;break;case FORK:status=STEP_RESULT;tmp=Fiber(util,supervisor,step2._2);if(supervisor){supervisor.register(tmp)}if(step2._1){tmp.run()}step2=util.right(tmp);break;case SEQ:status=CONTINUE;step2=sequential2(util,supervisor,step2._1);break}break;case RETURN:bhead=null;btail=null;if(attempts===null){status=COMPLETED;step2=interrupt||fail2||step2}else{tmp=attempts._3;attempt=attempts._1;attempts=attempts._2;switch(attempt.tag){case CATCH:if(interrupt&&interrupt!==tmp&&bracketCount===0){status=RETURN}else if(fail2){status=CONTINUE;step2=attempt._2(util.fromLeft(fail2));fail2=null}break;case RESUME:if(interrupt&&interrupt!==tmp&&bracketCount===0||fail2){status=RETURN}else{bhead=attempt._1;btail=attempt._2;status=STEP_BIND;step2=util.fromRight(step2)}break;case BRACKET:bracketCount--;if(fail2===null){result=util.fromRight(step2);attempts=new Aff2(CONS,new Aff2(RELEASE,attempt._2,result),attempts,tmp);if(interrupt===tmp||bracketCount>0){status=CONTINUE;step2=attempt._3(result)}}break;case RELEASE:attempts=new Aff2(CONS,new Aff2(FINALIZED,step2,fail2),attempts,interrupt);status=CONTINUE;if(interrupt&&interrupt!==tmp&&bracketCount===0){step2=attempt._1.killed(util.fromLeft(interrupt))(attempt._2)}else if(fail2){step2=attempt._1.failed(util.fromLeft(fail2))(attempt._2)}else{step2=attempt._1.completed(util.fromRight(step2))(attempt._2)}fail2=null;bracketCount++;break;case FINALIZER:bracketCount++;attempts=new Aff2(CONS,new Aff2(FINALIZED,step2,fail2),attempts,interrupt);status=CONTINUE;step2=attempt._1;break;case FINALIZED:bracketCount--;status=RETURN;step2=attempt._1;fail2=attempt._2;break}}break;case COMPLETED:for(var k in joins){if(joins.hasOwnProperty(k)){rethrow=rethrow&&joins[k].rethrow;runEff(joins[k].handler(step2))}}joins=null;if(interrupt&&fail2){setTimeout((function(){throw util.fromLeft(fail2)}),0)}else if(util.isLeft(step2)&&rethrow){setTimeout((function(){if(rethrow){throw util.fromLeft(step2)}}),0)}return;case SUSPENDED:status=CONTINUE;break;case PENDING:return}}}function onComplete(join3){return function(){if(status===COMPLETED){rethrow=rethrow&&join3.rethrow;join3.handler(step2)();return function(){}}var jid=joinId++;joins=joins||{};joins[jid]=join3;return function(){if(joins!==null){delete joins[jid]}}}}function kill(error3,cb){return function(){if(status===COMPLETED){cb(util.right(void 0))();return function(){}}var canceler=onComplete({rethrow:false,handler:function(){return cb(util.right(void 0))}})();switch(status){case SUSPENDED:interrupt=util.left(error3);status=COMPLETED;step2=interrupt;run4(runTick);break;case PENDING:if(interrupt===null){interrupt=util.left(error3)}if(bracketCount===0){if(status===PENDING){attempts=new Aff2(CONS,new Aff2(FINALIZER,step2(error3)),attempts,interrupt)}status=RETURN;step2=null;fail2=null;run4(++runTick)}break;default:if(interrupt===null){interrupt=util.left(error3)}if(bracketCount===0){status=RETURN;step2=null;fail2=null}}return canceler}}function join2(cb){return function(){var canceler=onComplete({rethrow:false,handler:cb})();if(status===SUSPENDED){run4(runTick)}return canceler}}return{kill:kill,join:join2,onComplete:onComplete,isSuspended:function(){return status===SUSPENDED},run:function(){if(status===SUSPENDED){if(!Scheduler.isDraining()){Scheduler.enqueue((function(){run4(runTick)}))}else{run4(runTick)}}}}}function runPar(util,supervisor,par,cb){var fiberId=0;var fibers={};var killId=0;var kills={};var early=new Error("[ParAff] Early exit");var interrupt=null;var root=EMPTY;function kill(error3,par2,cb2){var step2=par2;var head2=null;var tail2=null;var count=0;var kills2={};var tmp,kid;loop:while(true){tmp=null;switch(step2.tag){case FORKED:if(step2._3===EMPTY){tmp=fibers[step2._1];kills2[count++]=tmp.kill(error3,(function(result){return function(){count--;if(count===0){cb2(result)()}}}))}if(head2===null){break loop}step2=head2._2;if(tail2===null){head2=null}else{head2=tail2._1;tail2=tail2._2}break;case MAP:step2=step2._2;break;case APPLY:case ALT:if(head2){tail2=new Aff2(CONS,head2,tail2)}head2=step2;step2=step2._1;break}}if(count===0){cb2(util.right(void 0))()}else{kid=0;tmp=count;for(;kid<tmp;kid++){kills2[kid]=kills2[kid]()}}return kills2}function join2(result,head2,tail2){var fail2,step2,lhs,rhs,tmp,kid;if(util.isLeft(result)){fail2=result;step2=null}else{step2=result;fail2=null}loop:while(true){lhs=null;rhs=null;tmp=null;kid=null;if(interrupt!==null){return}if(head2===null){cb(fail2||step2)();return}if(head2._3!==EMPTY){return}switch(head2.tag){case MAP:if(fail2===null){head2._3=util.right(head2._1(util.fromRight(step2)));step2=head2._3}else{head2._3=fail2}break;case APPLY:lhs=head2._1._3;rhs=head2._2._3;if(fail2){head2._3=fail2;tmp=true;kid=killId++;kills[kid]=kill(early,fail2===lhs?head2._2:head2._1,(function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail2===null){join2(fail2,null,null)}else{join2(fail2,tail2._1,tail2._2)}}}));if(tmp){tmp=false;return}}else if(lhs===EMPTY||rhs===EMPTY){return}else{step2=util.right(util.fromRight(lhs)(util.fromRight(rhs)));head2._3=step2}break;case ALT:lhs=head2._1._3;rhs=head2._2._3;if(lhs===EMPTY&&util.isLeft(rhs)||rhs===EMPTY&&util.isLeft(lhs)){return}if(lhs!==EMPTY&&util.isLeft(lhs)&&rhs!==EMPTY&&util.isLeft(rhs)){fail2=step2===lhs?rhs:lhs;step2=null;head2._3=fail2}else{head2._3=step2;tmp=true;kid=killId++;kills[kid]=kill(early,step2===lhs?head2._2:head2._1,(function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail2===null){join2(step2,null,null)}else{join2(step2,tail2._1,tail2._2)}}}));if(tmp){tmp=false;return}}break}if(tail2===null){head2=null}else{head2=tail2._1;tail2=tail2._2}}}function resolve(fiber){return function(result){return function(){delete fibers[fiber._1];fiber._3=result;join2(result,fiber._2._1,fiber._2._2)}}}function run4(){var status=CONTINUE;var step2=par;var head2=null;var tail2=null;var tmp,fid;loop:while(true){tmp=null;fid=null;switch(status){case CONTINUE:switch(step2.tag){case MAP:if(head2){tail2=new Aff2(CONS,head2,tail2)}head2=new Aff2(MAP,step2._1,EMPTY,EMPTY);step2=step2._2;break;case APPLY:if(head2){tail2=new Aff2(CONS,head2,tail2)}head2=new Aff2(APPLY,EMPTY,step2._2,EMPTY);step2=step2._1;break;case ALT:if(head2){tail2=new Aff2(CONS,head2,tail2)}head2=new Aff2(ALT,EMPTY,step2._2,EMPTY);step2=step2._1;break;default:fid=fiberId++;status=RETURN;tmp=step2;step2=new Aff2(FORKED,fid,new Aff2(CONS,head2,tail2),EMPTY);tmp=Fiber(util,supervisor,tmp);tmp.onComplete({rethrow:false,handler:resolve(step2)})();fibers[fid]=tmp;if(supervisor){supervisor.register(tmp)}}break;case RETURN:if(head2===null){break loop}if(head2._1===EMPTY){head2._1=step2;status=CONTINUE;step2=head2._2;head2._2=EMPTY}else{head2._2=step2;step2=head2;if(tail2===null){head2=null}else{head2=tail2._1;tail2=tail2._2}}}}root=step2;for(fid=0;fid<fiberId;fid++){fibers[fid].run()}}function cancel(error3,cb2){interrupt=util.left(error3);var innerKills;for(var kid in kills){if(kills.hasOwnProperty(kid)){innerKills=kills[kid];for(kid in innerKills){if(innerKills.hasOwnProperty(kid)){innerKills[kid]()}}}}kills=null;var newKills=kill(error3,root,cb2);return function(killError){return new Aff2(ASYNC,(function(killCb){return function(){for(var kid2 in newKills){if(newKills.hasOwnProperty(kid2)){newKills[kid2]()}}return nonCanceler}}))}}run4();return function(killError){return new Aff2(ASYNC,(function(killCb){return function(){return cancel(killError,killCb)}}))}}function sequential2(util,supervisor,par){return new Aff2(ASYNC,(function(cb){return function(){return runPar(util,supervisor,par,cb)}}))}Aff2.EMPTY=EMPTY;Aff2.Pure=AffCtr(PURE);Aff2.Throw=AffCtr(THROW);Aff2.Catch=AffCtr(CATCH);Aff2.Sync=AffCtr(SYNC);Aff2.Async=AffCtr(ASYNC);Aff2.Bind=AffCtr(BIND);Aff2.Bracket=AffCtr(BRACKET);Aff2.Fork=AffCtr(FORK);Aff2.Seq=AffCtr(SEQ);Aff2.ParMap=AffCtr(MAP);Aff2.ParApply=AffCtr(APPLY);Aff2.ParAlt=AffCtr(ALT);Aff2.Fiber=Fiber;Aff2.Supervisor=Supervisor;Aff2.Scheduler=Scheduler;Aff2.nonCanceler=nonCanceler;return Aff2}();var _pure=Aff.Pure;var _throwError=Aff.Throw;function _catchError(aff){return function(k){return Aff.Catch(aff,k)}}function _map(f){return function(aff){if(aff.tag===Aff.Pure.tag){return Aff.Pure(f(aff._1))}else{return Aff.Bind(aff,(function(value13){return Aff.Pure(f(value13))}))}}}function _bind(aff){return function(k){return Aff.Bind(aff,k)}}var _liftEffect=Aff.Sync;var makeAff=Aff.Async;function _makeFiber(util,aff){return function(){return Aff.Fiber(util,null,aff)}}var _delay=function(){function setDelay(n,k){if(n===0&&typeof setImmediate!=="undefined"){return setImmediate(k)}else{return setTimeout(k,n)}}function clearDelay(n,t){if(n===0&&typeof clearImmediate!=="undefined"){return clearImmediate(t)}else{return clearTimeout(t)}}return function(right,ms){return Aff.Async((function(cb){return function(){var timer=setDelay(ms,cb(right()));return function(){return Aff.Sync((function(){return right(clearDelay(ms,timer))}))}}}))}}();var _sequential=Aff.Seq;function error(msg){return new Error(msg)}function message(e){return e.message}function throwException(e){return function(){throw e}}function catchException(c){return function(t){return function(){try{return t()}catch(e){if(e instanceof Error||Object.prototype.toString.call(e)==="[object Error]"){return c(e)()}else{return c(new Error(e.toString()))()}}}}}var pure2=pure(applicativeEffect);var map3=map(functorEffect);var $$try=function(action2){return catchException((function($3){return pure2(Left.create($3))}))(map3(Right.create)(action2))};var $$throw=function($4){return throwException(error($4))};var throwError=function(dict){return dict.throwError};var catchError=function(dict){return dict.catchError};var $$try2=function(dictMonadError){var catchError1=catchError(dictMonadError);var Monad0=dictMonadError.MonadThrow0().Monad0();var map16=map(Monad0.Bind1().Apply0().Functor0());var pure9=pure(Monad0.Applicative0());return function(a3){return catchError1(map16(Right.create)(a3))((function($52){return pure9(Left.create($52))}))}};var Identity=function(x){return x};var functorIdentity={map:function(f){return function(m){return f(m)}}};var applyIdentity={apply:function(v){return function(v1){return v(v1)}},Functor0:function(){return functorIdentity}};var bindIdentity={bind:function(v){return function(f){return f(v)}},Apply0:function(){return applyIdentity}};var applicativeIdentity={pure:Identity,Apply0:function(){return applyIdentity}};var monadIdentity={Applicative0:function(){return applicativeIdentity},Bind1:function(){return bindIdentity}};var _new=function(val){return function(){return{value:val}}};var read=function(ref){return function(){return ref.value}};var write=function(val){return function(ref){return function(){ref.value=val}}};var $$new=_new;var liftEffect=function(dict){return dict.liftEffect};var map4=map(functorEither);var ExceptT=function(x){return x};var withExceptT=function(dictFunctor){var map16=map(dictFunctor);return function(f){return function(v){var mapLeft=function(v1){return function(v2){if(v2 instanceof Right){return new Right(v2.value0)}if(v2 instanceof Left){return new Left(v1(v2.value0))}throw new Error("Failed pattern match at Control.Monad.Except.Trans (line 43, column 3 - line 43, column 32): "+[v1.constructor.name,v2.constructor.name])}};return map16(mapLeft(f))(v)}}};var runExceptT=function(v){return v};var mapExceptT=function(f){return function(v){return f(v)}};var functorExceptT=function(dictFunctor){var map16=map(dictFunctor);return{map:function(f){return mapExceptT(map16(map4(f)))}}};var monadExceptT=function(dictMonad){return{Applicative0:function(){return applicativeExceptT(dictMonad)},Bind1:function(){return bindExceptT(dictMonad)}}};var bindExceptT=function(dictMonad){var bind3=bind(dictMonad.Bind1());var pure9=pure(dictMonad.Applicative0());return{bind:function(v){return function(k){return bind3(v)(either((function($193){return pure9(Left.create($193))}))((function(a3){var v1=k(a3);return v1})))}},Apply0:function(){return applyExceptT(dictMonad)}}};var applyExceptT=function(dictMonad){var functorExceptT1=functorExceptT(dictMonad.Bind1().Apply0().Functor0());return{apply:ap(monadExceptT(dictMonad)),Functor0:function(){return functorExceptT1}}};var applicativeExceptT=function(dictMonad){return{pure:function(){var $194=pure(dictMonad.Applicative0());return function($195){return ExceptT($194(Right.create($195)))}}(),Apply0:function(){return applyExceptT(dictMonad)}}};var monadThrowExceptT=function(dictMonad){var monadExceptT1=monadExceptT(dictMonad);return{throwError:function(){var $204=pure(dictMonad.Applicative0());return function($205){return ExceptT($204(Left.create($205)))}}(),Monad0:function(){return monadExceptT1}}};var traverseArrayImpl=function(){function array1(a3){return[a3]}function array2(a3){return function(b){return[a3,b]}}function array3(a3){return function(b){return function(c){return[a3,b,c]}}}function concat2(xs){return function(ys){return xs.concat(ys)}}return function(apply3){return function(map16){return function(pure9){return function(f){return function(array){function go2(bot,top3){switch(top3-bot){case 0:return pure9([]);case 1:return map16(array1)(f(array[bot]));case 2:return apply3(map16(array2)(f(array[bot])))(f(array[bot+1]));case 3:return apply3(apply3(map16(array3)(f(array[bot])))(f(array[bot+1])))(f(array[bot+2]));default:var pivot=bot+Math.floor((top3-bot)/4)*2;return apply3(map16(concat2)(go2(bot,pivot)))(go2(pivot,top3))}}return go2(0,array.length)}}}}}}();var identity5=identity(categoryFn);var traverse=function(dict){return dict.traverse};var sequenceDefault=function(dictTraversable){var traverse2=traverse(dictTraversable);return function(dictApplicative){return traverse2(dictApplicative)(identity5)}};var traversableArray={traverse:function(dictApplicative){var Apply0=dictApplicative.Apply0();return traverseArrayImpl(apply(Apply0))(map(Apply0.Functor0()))(pure(dictApplicative))},sequence:function(dictApplicative){return sequenceDefault(traversableArray)(dictApplicative)},Functor0:function(){return functorArray},Foldable1:function(){return foldableArray}};var sequence=function(dict){return dict.sequence};var unsafePerformEffect=function(f){return f()};var _unsafePartial=function(f){return f()};var _crashWith=function(msg){throw new Error(msg)};var crashWith=function(){return _crashWith};var crashWith2=crashWith();var unsafePartial=_unsafePartial;var unsafeCrashWith=function(msg){return unsafePartial((function(){return crashWith2(msg)}))};var $runtime_lazy2=function(name15,moduleName,init4){var state3=0;var val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init4();state3=2;return val}};var $$void2=$$void(functorEffect);var functorAff={map:_map};var ffiUtil=function(){var unsafeFromRight=function(v){if(v instanceof Right){return v.value0}if(v instanceof Left){return unsafeCrashWith("unsafeFromRight: Left")}throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[v.constructor.name])};var unsafeFromLeft=function(v){if(v instanceof Left){return v.value0}if(v instanceof Right){return unsafeCrashWith("unsafeFromLeft: Right")}throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[v.constructor.name])};var isLeft=function(v){if(v instanceof Left){return true}if(v instanceof Right){return false}throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[v.constructor.name])};return{isLeft:isLeft,fromLeft:unsafeFromLeft,fromRight:unsafeFromRight,left:Left.create,right:Right.create}}();var makeFiber=function(aff){return _makeFiber(ffiUtil,aff)};var launchAff=function(aff){return function __do2(){var fiber=makeFiber(aff)();fiber.run();return fiber}};var monadAff={Applicative0:function(){return applicativeAff},Bind1:function(){return bindAff}};var bindAff={bind:_bind,Apply0:function(){return $lazy_applyAff(0)}};var applicativeAff={pure:_pure,Apply0:function(){return $lazy_applyAff(0)}};var $lazy_applyAff=$runtime_lazy2("applyAff","Effect.Aff",(function(){return{apply:ap(monadAff),Functor0:function(){return functorAff}}}));var bindFlipped2=bindFlipped(bindAff);var monadEffectAff={liftEffect:_liftEffect,Monad0:function(){return monadAff}};var liftEffect2=liftEffect(monadEffectAff);var monadThrowAff={throwError:_throwError,Monad0:function(){return monadAff}};var monadErrorAff={catchError:_catchError,MonadThrow0:function(){return monadThrowAff}};var $$try3=$$try2(monadErrorAff);var runAff=function(k){return function(aff){return launchAff(bindFlipped2((function($83){return liftEffect2(k($83))}))($$try3(aff)))}};var runAff_=function(k){return function(aff){return $$void2(runAff(k)(aff))}};var log=function(s){return function(){console.log(s)}};function querySelector_(selector){return document.querySelector(selector)}function createWindowListener_(eventName,updater){window.addEventListener(eventName,(function(event){updater(event)()}))}function createDocumentListener_(eventName,updater){document.addEventListener(eventName,(function(event){updater(event)()}))}function createCustomListener_(eventName,updater){document.addEventListener(eventName,(function(event){updater(event.detail)()}))}function nullable(a3,r,f){return a3==null?r:f(a3)}var toMaybe=function(n){return nullable(n,Nothing.value,Just.create)};var runEffectFn1=function runEffectFn12(fn){return function(a3){return function(){return fn(a3)}}};var runEffectFn2=function runEffectFn22(fn){return function(a3){return function(b){return function(){return fn(a3,b)}}}};var runEffectFn4=function runEffectFn42(fn){return function(a3){return function(b){return function(c){return function(d){return function(){return fn(a3,b,c,d)}}}}}};var querySelector=function(selector){return function __do2(){var selected2=querySelector_(selector);return toMaybe(selected2)}};var createWindowListener=runEffectFn2(createWindowListener_);var createDocumentListener=runEffectFn2(createDocumentListener_);var createCustomListener=runEffectFn2(createCustomListener_);var regexImpl=function(left){return function(right){return function(s1){return function(s2){try{return right(new RegExp(s1,s2))}catch(e){return left(e.message)}}}}};var _replaceBy=function(just){return function(nothing){return function(r){return function(f){return function(s){return s.replace(r,(function(match){var groups=[];var group4,i3=1;while(typeof(group4=arguments[i3++])!=="number"){groups.push(group4==null?nothing:just(group4))}return f(match)(groups)}))}}}}};var singleton=function(c){return c};var length=function(s){return s.length};var drop=function(n){return function(s){return s.substring(n)}};var charAt=function(i3){return function(s){if(i3>=0&&i3<s.length)return s.charAt(i3);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var split=function(sep){return function(s){return s.split(sep)}};var toLower=function(s){return s.toLowerCase()};var toUpper=function(s){return s.toUpperCase()};var $$null=function(s){return s===""};var global={global:true,ignoreCase:false,multiline:false,dotAll:false,sticky:false,unicode:false};var replace$prime=function(){return _replaceBy(Just.create)(Nothing.value)}();var renderFlags=function(v){return function(){if(v.global){return"g"}return""}()+(function(){if(v.ignoreCase){return"i"}return""}()+(function(){if(v.multiline){return"m"}return""}()+(function(){if(v.dotAll){return"s"}return""}()+(function(){if(v.sticky){return"y"}return""}()+function(){if(v.unicode){return"u"}return""}()))))};var regex=function(s){return function(f){return regexImpl(Left.create)(Right.create)(s)(renderFlags(f))}};var classData=2;var propertyData=3;function createProperty(name15){return function(value13){return[propertyData,name15,value13]}}function createClass(array){return[classData,array]}var rangeImpl=function(start3,end){var step2=start3>end?-1:1;var result=new Array(step2*(end-start3)+1);var i3=start3,n=0;while(i3!==end){result[n++]=i3;i3+=step2}result[n]=i3;return result};var replicateFill=function(count,value13){if(count<1){return[]}var result=new Array(count);return result.fill(value13)};var replicatePolyfill=function(count,value13){var result=[];var n=0;for(var i3=0;i3<count;i3++){result[n++]=value13}return result};var replicateImpl=typeof Array.prototype.fill==="function"?replicateFill:replicatePolyfill;var fromFoldableImpl=function(){function Cons2(head2,tail2){this.head=head2;this.tail=tail2}var emptyList={};function curryCons(head2){return function(tail2){return new Cons2(head2,tail2)}}function listToArray(list){var result=[];var count=0;var xs=list;while(xs!==emptyList){result[count++]=xs.head;xs=xs.tail}return result}return function(foldr4,xs){return listToArray(foldr4(curryCons)(emptyList)(xs))}}();var unconsImpl=function(empty4,next,xs){return xs.length===0?empty4({}):next(xs[0])(xs.slice(1))};var findIndexImpl=function(just,nothing,f,xs){for(var i3=0,l=xs.length;i3<l;i3++){if(f(xs[i3]))return just(i3)}return nothing};var _deleteAt=function(just,nothing,i3,l){if(i3<0||i3>=l.length)return nothing;var l1=l.slice();l1.splice(i3,1);return just(l1)};var _updateAt=function(just,nothing,i3,a3,l){if(i3<0||i3>=l.length)return nothing;var l1=l.slice();l1[i3]=a3;return just(l1)};var filterImpl=function(f,xs){return xs.filter(f)};var sortByImpl=function(){function mergeFromTo(compare2,fromOrdering,xs1,xs2,from3,to3){var mid;var i3;var j;var k;var x;var y;var c;mid=from3+(to3-from3>>1);if(mid-from3>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,from3,mid);if(to3-mid>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,mid,to3);i3=from3;j=mid;k=from3;while(i3<mid&&j<to3){x=xs2[i3];y=xs2[j];c=fromOrdering(compare2(x)(y));if(c>0){xs1[k++]=y;++j}else{xs1[k++]=x;++i3}}while(i3<mid){xs1[k++]=xs2[i3++]}while(j<to3){xs1[k++]=xs2[j++]}}return function(compare2,fromOrdering,xs){var out;if(xs.length<2)return xs;out=xs.slice(0);mergeFromTo(compare2,fromOrdering,out,xs.slice(0),0,xs.length);return out}}();function unsafeFreezeThawImpl(xs){return xs}var unsafeFreezeImpl=unsafeFreezeThawImpl;function copyImpl(xs){return xs.slice()}var thawImpl=copyImpl;var sortByImpl2=function(){function mergeFromTo(compare2,fromOrdering,xs1,xs2,from3,to3){var mid;var i3;var j;var k;var x;var y;var c;mid=from3+(to3-from3>>1);if(mid-from3>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,from3,mid);if(to3-mid>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,mid,to3);i3=from3;j=mid;k=from3;while(i3<mid&&j<to3){x=xs2[i3];y=xs2[j];c=fromOrdering(compare2(x)(y));if(c>0){xs1[k++]=y;++j}else{xs1[k++]=x;++i3}}while(i3<mid){xs1[k++]=xs2[i3++]}while(j<to3){xs1[k++]=xs2[j++]}}return function(compare2,fromOrdering,xs){if(xs.length<2)return xs;mergeFromTo(compare2,fromOrdering,xs,xs.slice(0),0,xs.length);return xs}}();var pushImpl=function(a3,xs){return xs.push(a3)};var runSTFn1=function runSTFn12(fn){return function(a3){return function(){return fn(a3)}}};var runSTFn2=function runSTFn22(fn){return function(a3){return function(b){return function(){return fn(a3,b)}}}};var unsafeFreeze=runSTFn1(unsafeFreezeImpl);var thaw=runSTFn1(thawImpl);var withArray=function(f){return function(xs){return function __do2(){var result=thaw(xs)();f(result)();return unsafeFreeze(result)()}}};var push=runSTFn2(pushImpl);var runFn2=function(fn){return function(a3){return function(b){return fn(a3,b)}}};var runFn3=function(fn){return function(a3){return function(b){return function(c){return fn(a3,b,c)}}}};var runFn4=function(fn){return function(a3){return function(b){return function(c){return function(d){return fn(a3,b,c,d)}}}}};var runFn5=function(fn){return function(a3){return function(b){return function(c){return function(d){return function(e){return fn(a3,b,c,d,e)}}}}}};var mapWithIndexArray=function(f){return function(xs){var l=xs.length;var result=Array(l);for(var i3=0;i3<l;i3++){result[i3]=f(i3)(xs[i3])}return result}};var mapWithIndex=function(dict){return dict.mapWithIndex};var functorWithIndexArray={mapWithIndex:mapWithIndexArray,Functor0:function(){return functorArray}};var fromJust2=fromJust();var append2=append(semigroupArray);var updateAt=function(){return runFn5(_updateAt)(Just.create)(Nothing.value)}();var uncons=function(){return runFn3(unconsImpl)($$const(Nothing.value))((function(x){return function(xs){return new Just({head:x,tail:xs})}}))}();var snoc=function(xs){return function(x){return withArray(push(x))(xs)()}};var singleton3=function(a3){return[a3]};var range2=runFn2(rangeImpl);var foldr2=foldr(foldableArray);var findIndex=function(){return runFn4(findIndexImpl)(Just.create)(Nothing.value)}();var filter=runFn2(filterImpl);var deleteAt=function(){return runFn4(_deleteAt)(Just.create)(Nothing.value)}();var deleteBy=function(v){return function(v1){return function(v2){if(v2.length===0){return[]}return maybe(v2)((function(i3){return fromJust2(deleteAt(i3)(v2))}))(findIndex(v(v1))(v2))}}};var $$delete=function(dictEq){return deleteBy(eq(dictEq))};var cons=function(x){return function(xs){return append2([x])(xs)}};var concatMap=flip(bind(bindArray));var hasArrayFrom=typeof Array.from==="function";var hasStringIterator=typeof Symbol!=="undefined"&&Symbol!=null&&typeof Symbol.iterator!=="undefined"&&typeof String.prototype[Symbol.iterator]==="function";var hasFromCodePoint=typeof String.prototype.fromCodePoint==="function";var hasCodePointAt=typeof String.prototype.codePointAt==="function";var _singleton=function(fallback){return hasFromCodePoint?String.fromCodePoint:fallback};function toCharCode(c){return c.charCodeAt(0)}function fromCharCode(c){return String.fromCharCode(c)}var bottom1=bottom(boundedChar);var top1=top(boundedChar);var toEnum=function(dict){return dict.toEnum};var fromEnum=function(dict){return dict.fromEnum};var toEnumWithDefaults=function(dictBoundedEnum){var toEnum1=toEnum(dictBoundedEnum);var fromEnum1=fromEnum(dictBoundedEnum);var bottom22=bottom(dictBoundedEnum.Bounded0());return function(low2){return function(high2){return function(x){var v=toEnum1(x);if(v instanceof Just){return v.value0}if(v instanceof Nothing){var $140=x<fromEnum1(bottom22);if($140){return low2}return high2}throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[v.constructor.name])}}}};var defaultSucc=function(toEnum$prime){return function(fromEnum$prime){return function(a3){return toEnum$prime(fromEnum$prime(a3)+1|0)}}};var defaultPred=function(toEnum$prime){return function(fromEnum$prime){return function(a3){return toEnum$prime(fromEnum$prime(a3)-1|0)}}};var charToEnum=function(v){if(v>=toCharCode(bottom1)&&v<=toCharCode(top1)){return new Just(fromCharCode(v))}return Nothing.value};var enumChar={succ:defaultSucc(charToEnum)(toCharCode),pred:defaultPred(charToEnum)(toCharCode),Ord0:function(){return ordChar}};var boundedEnumChar=function(){return{cardinality:toCharCode(top1)-toCharCode(bottom1)|0,toEnum:charToEnum,fromEnum:toCharCode,Bounded0:function(){return boundedChar},Enum1:function(){return enumChar}}}();var fromNumberImpl=function(just){return function(nothing){return function(n){return(n|0)===n?just(n):nothing}}};var toNumber=function(n){return n};var fromStringAsImpl=function(just){return function(nothing){return function(radix){var digits;if(radix<11){digits="[0-"+(radix-1).toString()+"]"}else if(radix===11){digits="[0-9a]"}else{digits="[0-9a-"+String.fromCharCode(86+radix)+"]"}var pattern2=new RegExp("^[\\+\\-]?"+digits+"+$","i");return function(s){if(pattern2.test(s)){var i3=parseInt(s,radix);return(i3|0)===i3?just(i3):nothing}else{return nothing}}}}};var isFiniteImpl=isFinite;var floor=Math.floor;var top2=top(boundedInt);var bottom2=bottom(boundedInt);var fromStringAs=function(){return fromStringAsImpl(Just.create)(Nothing.value)}();var fromString=fromStringAs(10);var fromNumber=function(){return fromNumberImpl(Just.create)(Nothing.value)}();var unsafeClamp=function(x){if(!isFiniteImpl(x)){return 0}if(x>=toNumber(top2)){return top2}if(x<=toNumber(bottom2)){return bottom2}if(otherwise){return fromMaybe(0)(fromNumber(x))}throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[x.constructor.name])};var floor2=function($39){return unsafeClamp(floor($39))};var fromEnum2=fromEnum(boundedEnumChar);var div2=div(euclideanRingInt);var mod2=mod(euclideanRingInt);var unsurrogate=function(lead){return function(trail){return(((lead-55296|0)*1024|0)+(trail-56320|0)|0)+65536|0}};var isTrail=function(cu){return 56320<=cu&&cu<=57343};var isLead=function(cu){return 55296<=cu&&cu<=56319};var uncons2=function(s){var v=length(s);if(v===0){return Nothing.value}if(v===1){return new Just({head:fromEnum2(charAt(0)(s)),tail:""})}var cu1=fromEnum2(charAt(1)(s));var cu0=fromEnum2(charAt(0)(s));var $43=isLead(cu0)&&isTrail(cu1);if($43){return new Just({head:unsurrogate(cu0)(cu1),tail:drop(2)(s)})}return new Just({head:cu0,tail:drop(1)(s)})};var fromCharCode2=function(){var $75=toEnumWithDefaults(boundedEnumChar)(bottom(boundedChar))(top(boundedChar));return function($76){return singleton($75($76))}}();var singletonFallback=function(v){if(v<=65535){return fromCharCode2(v)}var lead=div2(v-65536|0)(1024)+55296|0;var trail=mod2(v-65536|0)(1024)+56320|0;return fromCharCode2(lead)+fromCharCode2(trail)};var singleton4=_singleton(singletonFallback);function toArrayWithKey(f){return function(m){var r=[];for(var k in m){if(hasOwnProperty.call(m,k)){r.push(f(k)(m[k]))}}return r}}var keys=Object.keys||toArrayWithKey((function(k){return function(){return k}}));var foldr8=foldr(foldableArray);var mapWithIndex2=mapWithIndex(functorWithIndexArray);var foldl8=foldl(foldableArray);var foldrWithIndex=function(dict){return dict.foldrWithIndex};var foldMapWithIndexDefaultR=function(dictFoldableWithIndex){var foldrWithIndex1=foldrWithIndex(dictFoldableWithIndex);return function(dictMonoid){var append3=append(dictMonoid.Semigroup0());var mempty2=mempty(dictMonoid);return function(f){return foldrWithIndex1((function(i3){return function(x){return function(acc){return append3(f(i3)(x))(acc)}}}))(mempty2)}}};var foldableWithIndexArray={foldrWithIndex:function(f){return function(z){var $291=foldr8((function(v){return function(y){return f(v.value0)(v.value1)(y)}}))(z);var $292=mapWithIndex2(Tuple.create);return function($293){return $291($292($293))}}},foldlWithIndex:function(f){return function(z){var $294=foldl8((function(y){return function(v){return f(v.value0)(y)(v.value1)}}))(z);var $295=mapWithIndex2(Tuple.create);return function($296){return $294($295($296))}}},foldMapWithIndex:function(dictMonoid){return foldMapWithIndexDefaultR(foldableWithIndexArray)(dictMonoid)},Foldable0:function(){return foldableArray}};var traverseWithIndexDefault=function(dictTraversableWithIndex){var sequence2=sequence(dictTraversableWithIndex.Traversable2());var mapWithIndex4=mapWithIndex(dictTraversableWithIndex.FunctorWithIndex0());return function(dictApplicative){var sequence12=sequence2(dictApplicative);return function(f){var $174=mapWithIndex4(f);return function($175){return sequence12($174($175))}}}};var traverseWithIndex=function(dict){return dict.traverseWithIndex};var traversableWithIndexArray={traverseWithIndex:function(dictApplicative){return traverseWithIndexDefault(traversableWithIndexArray)(dictApplicative)},FunctorWithIndex0:function(){return functorWithIndexArray},FoldableWithIndex1:function(){return foldableWithIndexArray},Traversable2:function(){return traversableArray}};var fromJust3=fromJust();var crashWith3=crashWith();var show2=show(showString);var map5=map(functorArray);var toClassListString={to:function(){var $46=filter(function(){var $49=not(heytingAlgebraBoolean);return function($50){return $49($$null($50))}}());var $47=split(" ");return function($48){return $46($47($48))}}()};var value=createProperty("value");var type$prime=createProperty("type");var to=function(dict){return dict.to};var caseify=function(name$prime){if(name$prime===toUpper(name$prime)){return toLower(name$prime)}if(otherwise){var v=fromJust3(uncons2(name$prime));var replacer=function($133){return $$const(function(v1){return"-"+v1}(toLower($133)))};var regex2=function(){var v1=regex("[A-Z]")(global);if(v1 instanceof Right){return v1.value0}if(v1 instanceof Left){return crashWith3(show2(v1.value0))}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 90, column 40 - line 92, column 57): "+[v1.constructor.name])}();var hyphenated=replace$prime(regex2)(replacer)(v.tail);return toLower(singleton4(v.head))+hyphenated}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 83, column 1 - line 83, column 26): "+[name$prime.constructor.name])};var class$prime=function(dictToClassList){var $134=map5(caseify);var $135=to(dictToClassList);return function($136){return createClass($134($135($136)))}};var booleanToFalsyString=function(v){if(v){return"true"}if(!v){return""}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 66, column 7 - line 68, column 23): "+[v.constructor.name])};var checked=function(){var $140=createProperty("checked");return function($141){return $140(booleanToFalsyString($141))}}();var textNode=1;var elementNode=2;var styleData=1;var classData2=2;var propertyData2=3;var attributeData=4;var keyData=7;function createElementNode(tag){return function(nodeData){return function(potentialChildren){let children=potentialChildren,text6=void 0;if(potentialChildren.length===1&&potentialChildren[0].nodeType==textNode){children=void 0;text6=potentialChildren[0].text}return{nodeType:elementNode,node:void 0,tag:tag,nodeData:fromNodeData(nodeData),children:children,text:text6}}}}function createDatalessElementNode(tag){return function(potentialChildren){let children=potentialChildren,text6=void 0;if(potentialChildren.length===1&&potentialChildren[0].nodeType==textNode){children=void 0;text6=potentialChildren[0].text}return{nodeType:elementNode,node:void 0,tag:tag,nodeData:{},children:children,text:text6}}}function createSingleElementNode(tag){return function(nodeData){return{nodeType:elementNode,node:void 0,tag:tag,nodeData:fromNodeData(nodeData)}}}function text(value13){return{nodeType:textNode,node:void 0,text:value13}}function fromNodeData(allData){let nodeData={};if(allData!==void 0)for(let data of allData){let dataOne=data[1];switch(data[0]){case styleData:if(nodeData.styles===void 0)nodeData.styles={};for(let key in dataOne)nodeData.styles[key]=dataOne[key];break;case classData2:if(nodeData.classes===void 0)nodeData.classes=[];nodeData.classes=nodeData.classes.concat(dataOne);break;case propertyData2:if(nodeData.properties===void 0)nodeData.properties={};nodeData.properties[dataOne]=data[2];break;case attributeData:if(nodeData.attributes===void 0)nodeData.attributes={};nodeData.attributes[dataOne]=data[2];break;case keyData:nodeData.key=dataOne;break;default:if(nodeData.events===void 0)nodeData.events={};if(nodeData.events[dataOne]===void 0)nodeData.events[dataOne]=[];nodeData.events[dataOne].push(data[2])}}return nodeData}var toNodeNodeDataNodeData={toNode:singleton3};var toNodeHtmlHtml={toNode:singleton3};var toNode=function(dict){return dict.toNode};var toNodeArray=function(dictToNode){return{toNode:concatMap(toNode(dictToNode))}};var createElement_=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(children){return createDatalessElementNode(tag)(toNode1(children))}}};var div_=function(dictToNode){return createElement_("div")(dictToNode)};var createElement$prime=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(nodeData){return createSingleElementNode(tag)(toNode1(nodeData))}}};var input=function(dictToNode){return createElement$prime("input")(dictToNode)};var createElement=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(dictToNode1){var toNode2=toNode(dictToNode1);return function(nodeData){return function(children){return createElementNode(tag)(toNode1(nodeData))(toNode2(children))}}}}};var div3=function(dictToNode){return function(dictToNode1){return createElement("div")(dictToNode)(dictToNode1)}};var h6=function(dictToNode){return function(dictToNode1){return createElement("h6")(dictToNode)(dictToNode1)}};var header=function(dictToNode){return function(dictToNode1){return createElement("header")(dictToNode)(dictToNode1)}};var i=function(dictToNode){return function(dictToNode1){return createElement("i")(dictToNode)(dictToNode1)}};var label=function(dictToNode){return function(dictToNode1){return createElement("label")(dictToNode)(dictToNode1)}};var main=function(dictToNode){return function(dictToNode1){return createElement("main")(dictToNode)(dictToNode1)}};var nav=function(dictToNode){return function(dictToNode1){return createElement("nav")(dictToNode)(dictToNode1)}};var span=function(dictToNode){return function(dictToNode1){return createElement("span")(dictToNode)(dictToNode1)}};var button=function(dictToNode){return function(dictToNode1){return createElement("button")(dictToNode)(dictToNode1)}};var article_=function(dictToNode){return createElement_("article")(dictToNode)};var a=function(dictToNode){return function(dictToNode1){return createElement("a")(dictToNode)(dictToNode1)}};var reUnescapedHtml=/[&<>"']/g;var reHasUnescapedHtml=RegExp(reUnescapedHtml.source);var traverse1Impl=function(){function Cont(fn){this.fn=fn}var emptyList={};var ConsCell=function(head2,tail2){this.head=head2;this.tail=tail2};function finalCell(head2){return new ConsCell(head2,emptyList)}function consList(x){return function(xs){return new ConsCell(x,xs)}}function listToArray(list){var arr=[];var xs=list;while(xs!==emptyList){arr.push(xs.head);xs=xs.tail}return arr}return function(apply3,map16,f){var buildFrom=function(x,ys){return apply3(map16(consList)(f(x)))(ys)};var go2=function(acc,currentLen,xs){if(currentLen===0){return acc}else{var last3=xs[currentLen-1];return new Cont((function(){var built=go2(buildFrom(last3,acc),currentLen-1,xs);return built}))}};return function(array){var acc=map16(finalCell)(f(array[array.length-1]));var result=go2(acc,array.length-1,array);while(result instanceof Cont){result=result.fn()}return map16(listToArray)(result)}}}();var NonEmpty=function(){function NonEmpty2(value0,value1){this.value0=value0;this.value1=value1}NonEmpty2.create=function(value0){return function(value1){return new NonEmpty2(value0,value1)}};return NonEmpty2}();var singleton6=function(dictPlus){var empty4=empty(dictPlus);return function(a3){return new NonEmpty(a3,empty4)}};var functorNonEmpty=function(dictFunctor){var map23=map(dictFunctor);return{map:function(f){return function(m){return new NonEmpty(f(m.value0),map23(f)(m.value1))}}}};var Nil=function(){function Nil2(){}Nil2.value=new Nil2;return Nil2}();var Cons=function(){function Cons2(value0,value1){this.value0=value0;this.value1=value1}Cons2.create=function(value0){return function(value1){return new Cons2(value0,value1)}};return Cons2}();var NonEmptyList=function(x){return x};var toList=function(v){return new Cons(v.value0,v.value1)};var listMap=function(f){var chunkedRevMap=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v;var $tco_done=false;var $tco_result;function $tco_loop(v,v1){if(v1 instanceof Cons&&(v1.value1 instanceof Cons&&v1.value1.value1 instanceof Cons)){$tco_var_v=new Cons(v1,v);$copy_v1=v1.value1.value1.value1;return}var unrolledMap=function(v2){if(v2 instanceof Cons&&(v2.value1 instanceof Cons&&v2.value1.value1 instanceof Nil)){return new Cons(f(v2.value0),new Cons(f(v2.value1.value0),Nil.value))}if(v2 instanceof Cons&&v2.value1 instanceof Nil){return new Cons(f(v2.value0),Nil.value)}return Nil.value};var reverseUnrolledMap=function($copy_v2){return function($copy_v3){var $tco_var_v2=$copy_v2;var $tco_done1=false;var $tco_result2;function $tco_loop2(v2,v3){if(v2 instanceof Cons&&(v2.value0 instanceof Cons&&(v2.value0.value1 instanceof Cons&&v2.value0.value1.value1 instanceof Cons))){$tco_var_v2=v2.value1;$copy_v3=new Cons(f(v2.value0.value0),new Cons(f(v2.value0.value1.value0),new Cons(f(v2.value0.value1.value1.value0),v3)));return}$tco_done1=true;return v3}while(!$tco_done1){$tco_result2=$tco_loop2($tco_var_v2,$copy_v3)}return $tco_result2}};$tco_done=true;return reverseUnrolledMap(v)(unrolledMap(v1))}while(!$tco_done){$tco_result=$tco_loop($tco_var_v,$copy_v1)}return $tco_result}};return chunkedRevMap(Nil.value)};var functorList={map:listMap};var map6=map(functorList);var functorNonEmptyList=functorNonEmpty(functorList);var foldableList={foldr:function(f){return function(b){var rev3=function(){var go2=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v;var $tco_done=false;var $tco_result;function $tco_loop(v,v1){if(v1 instanceof Nil){$tco_done=true;return v}if(v1 instanceof Cons){$tco_var_v=new Cons(v1.value0,v);$copy_v1=v1.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[v.constructor.name,v1.constructor.name])}while(!$tco_done){$tco_result=$tco_loop($tco_var_v,$copy_v1)}return $tco_result}};return go2(Nil.value)}();var $284=foldl(foldableList)(flip(f))(b);return function($285){return $284(rev3($285))}}},foldl:function(f){var go2=function($copy_b){return function($copy_v){var $tco_var_b=$copy_b;var $tco_done1=false;var $tco_result;function $tco_loop(b,v){if(v instanceof Nil){$tco_done1=true;return b}if(v instanceof Cons){$tco_var_b=f(b)(v.value0);$copy_v=v.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[v.constructor.name])}while(!$tco_done1){$tco_result=$tco_loop($tco_var_b,$copy_v)}return $tco_result}};return go2},foldMap:function(dictMonoid){var append22=append(dictMonoid.Semigroup0());var mempty2=mempty(dictMonoid);return function(f){return foldl(foldableList)((function(acc){var $286=append22(acc);return function($287){return $286(f($287))}}))(mempty2)}}};var foldr3=foldr(foldableList);var semigroupList={append:function(xs){return function(ys){return foldr3(Cons.create)(ys)(xs)}}};var append1=append(semigroupList);var semigroupNonEmptyList={append:function(v){return function(as$prime){return new NonEmpty(v.value0,append1(v.value1)(toList(as$prime)))}}};var applyList={apply:function(v){return function(v1){if(v instanceof Nil){return Nil.value}if(v instanceof Cons){return append1(map6(v.value0)(v1))(apply(applyList)(v.value1)(v1))}throw new Error("Failed pattern match at Data.List.Types (line 157, column 1 - line 159, column 48): "+[v.constructor.name,v1.constructor.name])}},Functor0:function(){return functorList}};var apply2=apply(applyList);var applyNonEmptyList={apply:function(v){return function(v1){return new NonEmpty(v.value0(v1.value0),append1(apply2(v.value1)(new Cons(v1.value0,Nil.value)))(apply2(new Cons(v.value0,v.value1))(v1.value1)))}},Functor0:function(){return functorNonEmptyList}};var altList={alt:append1,Functor0:function(){return functorList}};var plusList=function(){return{empty:Nil.value,Alt0:function(){return altList}}}();var applicativeNonEmptyList={pure:function(){var $315=singleton6(plusList);return function($316){return NonEmptyList($315($316))}}(),Apply0:function(){return applyNonEmptyList}};var singleton7=function(){var $200=singleton6(plusList);return function($201){return NonEmptyList($200($201))}}();var get=function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(){return function(l){return function(r){return unsafeGet(reflectSymbol2(l))(r)}}}};function compareReference(a3){return function(b){return a3===b}}var modelHasChanged=function(old){return function($$new2){return!compareReference(old)($$new2)}};var namespace="http://www.w3.org/2000/svg";var eventPrefix="__flame_";var eventPostfix="updater";var textNode2=1;var elementNode2=2;var svgNode=3;var fragmentNode=4;var lazyNode=5;var managedNode=6;var nonBubblingEvents=["focus","blur","scroll","load","unload"];function start_(eventWrapper,root,updater,html){return new F(eventWrapper,root,updater,html,false)}function startFrom_(eventWrapper,root,updater,html){return new F(eventWrapper,root,updater,html,true)}function resume_(f,html){f.resume(html)}function F(eventWrapper,root,updater,html,isDry){this.eventWrapper=eventWrapper;this.applicationEvents=new Map;this.root=root;this.updater=updater;this.cachedHtml=html.node===void 0?html:shallowCopy(html);if(isDry)this.hydrate(this.root,this.cachedHtml);else this.createAllNodes(this.root,this.cachedHtml)}F.prototype.hydrate=function(parent2,html,referenceNode){switch(html.nodeType){case lazyNode:html.node=parent2;html.rendered=html.render(html.arg);html.render=void 0;this.hydrate(parent2,html.rendered);break;case textNode2:html.node=parent2;break;case managedNode:this.createAllNodes(parent2,html,referenceNode);break;default:if(html.nodeType===fragmentNode)html.node=document.createDocumentFragment();else{html.node=parent2;if(html.nodeData.events!==void 0)this.createAllEvents(parent2,html)}let htmlChildrenLength;if(html.text===void 0&&html.children!==void 0&&(htmlChildrenLength=html.children.length)>0){let childNodes=parent2.childNodes;for(let i3=0,cni=0;i3<htmlChildrenLength;++i3,++cni){let c=html.children[i3]=html.children[i3].node===void 0?html.children[i3]:shallowCopy(html.children[i3]);if(childNodes[cni]===void 0)this.createAllNodes(parent2,c);else{if(c.nodeType===fragmentNode){let fragmentChildrenLength=c.children.length;c.node=document.createDocumentFragment();for(let j=0;j<fragmentChildrenLength;++j){let cf=c.children[j]=c.children[j].node===void 0?c.children[j]:shallowCopy(c.children[j]);this.hydrate(childNodes[cni++],cf)}cni--}else if(c.nodeType===managedNode)this.hydrate(parent2,c,childNodes[cni]);else this.hydrate(childNodes[cni],c)}}}}};function shallowCopy(origin2){switch(origin2.nodeType){case textNode2:return{nodeType:textNode2,node:void 0,text:origin2.text};case fragmentNode:return{nodeType:fragmentNode,node:void 0,children:origin2.children};case lazyNode:return{nodeType:lazyNode,node:void 0,nodeData:origin2.nodeData,render:origin2.render,arg:origin2.arg,rendered:void 0,messageMapper:origin2.messageMapper};case managedNode:return{nodeType:managedNode,node:void 0,nodeData:origin2.nodeData,createNode:origin2.createNode,updateNode:origin2.updateNode,arg:origin2.arg,messageMapper:origin2.messageMapper};default:return{nodeType:origin2.nodeType,node:void 0,tag:origin2.tag,nodeData:origin2.nodeData,children:origin2.children,text:origin2.text,messageMapper:origin2.messageMapper}}}F.prototype.createAllNodes=function(parent2,html,referenceNode){let node=this.createNode(html);if(html.text!==void 0)node.textContent=html.text;else{if(html.children!==void 0)this.createChildrenNodes(node,html.children);else if(html.rendered!==void 0){if(html.messageMapper!==void 0)lazyMessageMap(html.messageMapper,html.rendered);if(html.rendered.text!==void 0){node.textContent=html.rendered.text}else if(html.rendered.children!==void 0)this.createChildrenNodes(node,html.rendered.children)}}parent2.insertBefore(node,referenceNode)};F.prototype.checkCreateAllNodes=function(parent2,html,referenceNode){if(html.node!==void 0)html=shallowCopy(html);this.createAllNodes(parent2,html,referenceNode);return html};F.prototype.createChildrenNodes=function(parent2,children){let childrenLength=children.length;for(let i3=0;i3<childrenLength;++i3){let html=children[i3]=children[i3].node===void 0?children[i3]:shallowCopy(children[i3]);this.checkCreateAllNodes(parent2,html,null)}};F.prototype.createNode=function(html){switch(html.nodeType){case lazyNode:html.rendered=html.render(html.arg);html.render=void 0;return html.node=this.createNode(html.rendered);case textNode2:return html.node=document.createTextNode(html.text);case elementNode2:return html.node=this.createElement(html);case svgNode:return html.node=this.createSvg(html);case fragmentNode:return html.node=document.createDocumentFragment();case managedNode:return html.node=this.createManagedNode(html)}};F.prototype.createElement=function(html){let element=document.createElement(html.tag);this.createNodeData(element,html,false);return element};F.prototype.createSvg=function(html){let svg=document.createElementNS(namespace,html.tag);this.createNodeData(svg,html,true);return svg};F.prototype.createManagedNode=function(html){let node=html.createNode(html.arg)();html.createNode=void 0;this.createNodeData(node,html,node instanceof SVGElement||node.nodeName.toLowerCase()==="svg");return node};F.prototype.createNodeData=function(node,html,isSvg){if(html.nodeData.styles!==void 0)createStyles(node,html.nodeData.styles);if(html.nodeData.classes!==void 0&&html.nodeData.classes.length>0)createClasses(node,html.nodeData.classes,isSvg);if(html.nodeData.attributes!==void 0)createAttributes(node,html.nodeData.attributes);if(html.nodeData.properties!==void 0)for(let key in html.nodeData.properties)node[key]=html.nodeData.properties[key];if(html.nodeData.events!==void 0)this.createAllEvents(node,html)};function createStyles(node,styles){for(let key in styles)node.style.setProperty(key,styles[key])}function createClasses(node,classes,isSvg){let joined=classes.join(" ");if(isSvg)node.setAttribute("class",joined);else node.className=joined}function createAttributes(node,attributes){for(let key in attributes)node.setAttribute(key,attributes[key])}F.prototype.createAllEvents=function(node,html){for(let key in html.nodeData.events)this.createEvent(node,key,html)};F.prototype.createEvent=function(node,name15,html){let handlers=html.nodeData.events[name15],eventKey=eventPrefix+name15;if(nonBubblingEvents.includes(name15)){let runNonBubblingEvent=this.runNonBubblingEvent(handlers,html.messageMapper);node[eventKey]=runNonBubblingEvent;node.addEventListener(name15,runNonBubblingEvent,false)}else{node[eventKey]=handlers;if(html.messageMapper!==void 0)node[eventKey+eventPostfix]=html.messageMapper;let synthetic=this.applicationEvents.get(name15);if(synthetic===void 0){let runEvent=this.runEvent.bind(this);this.root.addEventListener(name15,runEvent,false);this.applicationEvents.set(name15,{count:1,handler:runEvent})}else synthetic.count++}};F.prototype.runNonBubblingEvent=function(handlers,messageMapper2){return function(event){this.runHandlers(handlers,messageMapper2,event)}.bind(this)};F.prototype.runEvent=function(event){let node=event.target,eventKey=eventPrefix+event.type;while(node!==this.root){let handlers=node[eventKey];if(handlers!==void 0){this.runHandlers(handlers,node[eventKey+eventPostfix],event);return}node=node.parentNode}};F.prototype.runHandlers=function(handlers,messageMapper2,event){let handlersLength=handlers.length;for(let i3=0;i3<handlersLength;++i3){let h=handlers[i3],maybeMessage=typeof h==="function"?h(event)():this.eventWrapper(h);this.updater(messageMapper2===void 0?maybeMessage:messageMapper2(maybeMessage))()}event.stopPropagation()};F.prototype.resume=function(updatedHtml){this.cachedHtml=this.updateAllNodes(this.root,this.cachedHtml,updatedHtml)};F.prototype.updateAllNodes=function(parent2,currentHtml2,updatedHtml){if(updatedHtml.node!==void 0)updatedHtml=shallowCopy(updatedHtml);if(currentHtml2.tag!==updatedHtml.tag||currentHtml2.nodeType!==updatedHtml.nodeType){if(currentHtml2.nodeType===fragmentNode){this.createAllNodes(parent2,updatedHtml,firstFragmentChildNode(currentHtml2.children));removeFragmentChildren(parent2,currentHtml2.children)}else{this.createAllNodes(parent2,updatedHtml,currentHtml2.node);parent2.removeChild(currentHtml2.node)}}else{updatedHtml.node=currentHtml2.node;switch(updatedHtml.nodeType){case lazyNode:if(updatedHtml.arg!==currentHtml2.arg){updatedHtml.rendered=updatedHtml.render(updatedHtml.arg);if(updatedHtml.messageMapper!==void 0)lazyMessageMap(updatedHtml.messageMapper,updatedHtml.rendered);this.updateAllNodes(parent2,currentHtml2.rendered,updatedHtml.rendered)}else updatedHtml.rendered=currentHtml2.rendered;updatedHtml.render=void 0;break;case managedNode:let node=updatedHtml.updateNode(currentHtml2.node)(currentHtml2.arg)(updatedHtml.arg)(),isSvg=node instanceof SVGElement||node.nodeName.toLowerCase()==="svg";if(node!==currentHtml2.node||node.nodeType!==currentHtml2.node.nodeType||node.nodeName!==currentHtml2.node.nodeName){this.createNodeData(node,updatedHtml,isSvg);parent2.insertBefore(node,currentHtml2.node);parent2.removeChild(currentHtml2.node)}else this.updateNodeData(node,currentHtml2.nodeData,updatedHtml,isSvg);updatedHtml.node=node;break;case textNode2:if(updatedHtml.text!==currentHtml2.text)updatedHtml.node.textContent=updatedHtml.text;break;case fragmentNode:this.updateChildrenNodes(parent2,currentHtml2,updatedHtml);break;default:this.updateNodeData(currentHtml2.node,currentHtml2.nodeData,updatedHtml,updatedHtml.nodeType==svgNode);if((updatedHtml.text!==void 0||updatedHtml.children===void 0&&currentHtml2.text!=void 0)&&!hasInnerHtml(updatedHtml.nodeData)&&updatedHtml.text!=currentHtml2.node.textContent)currentHtml2.node.textContent=updatedHtml.text;else this.updateChildrenNodes(currentHtml2.node,currentHtml2,updatedHtml)}}return updatedHtml};function firstFragmentChildNode(children){let childrenLength=children.length;for(let i3=0;i3<childrenLength;++i3){if(children[i3].nodeType===fragmentNode)return firstFragmentChildNode(children[i3].children);return children[i3].node}return void 0}function removeFragmentChildren(parent2,children){let childrenLength=children.length;for(let i3=0;i3<childrenLength;++i3)if(children[i3].nodeType===fragmentNode)removeFragmentChildren(children[i3].children);else parent2.removeChild(children[i3].node)}function clearNode(node){node.textContent=""}F.prototype.updateChildrenNodes=function(parent2,currentHtml2,updatedHtml){let currentChildren=currentHtml2.children,updatedChildren=updatedHtml.children;if(currentChildren===void 0||currentChildren.length===0){let updatedChildrenLength;if(updatedChildren!==void 0&&(updatedChildrenLength=updatedChildren.length)>0){if(currentHtml2.text!==void 0||hasInnerHtml(currentHtml2.nodeData))clearNode(parent2);for(let i3=0;i3<updatedChildrenLength;++i3)updatedChildren[i3]=this.checkCreateAllNodes(parent2,updatedChildren[i3])}}else if(updatedChildren===void 0||updatedChildren.length===0){if(currentChildren!==void 0&&(currentChildren.length>0||currentHtml2.text!==void 0)&&!hasInnerHtml(updatedHtml.nodeData))clearNode(parent2)}else if(currentChildren[0].nodeData!==void 0&&currentChildren[0].nodeData.key!==void 0&&updatedChildren[0].nodeData!==void 0&&updatedChildren[0].nodeData.key!==void 0)this.updateKeyedChildrenNodes(parent2,currentChildren,updatedChildren);else this.updateNonKeyedChildrenNodes(parent2,currentChildren,updatedChildren)};function hasInnerHtml(parentNodeData){return parentNodeData!==void 0&&parentNodeData.properties!==void 0&&parentNodeData.properties.innerHTML!==void 0}F.prototype.updateKeyedChildrenNodes=function(parent2,currentChildren,updatedChildren){let currentStart=0,updatedStart=0,currentEnd=currentChildren.length-1,updatedEnd=updatedChildren.length-1;let afterNode,currentStartNode=currentChildren[currentStart].node,updatedStartNode=currentStartNode,currentEndNode=currentChildren[currentEnd].node;let loop2=true;fixes:while(loop2){loop2=false;let currentHtml2=currentChildren[currentStart],updatedHtml=updatedChildren[updatedStart];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){updatedHtml=this.updateAllNodes(parent2,currentHtml2,updatedHtml);updatedStartNode=currentStartNode=currentHtml2.node.nextSibling;currentStart++;updatedStart++;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedStart]}currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedEnd];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){updatedHtml=this.updateAllNodes(parent2,currentHtml2,updatedHtml);afterNode=currentEndNode;currentEndNode=currentEndNode.previousSibling;currentEnd--;updatedEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedEnd]}currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedStart];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){loop2=true;updatedHtml=this.updateAllNodes(parent2,currentHtml2,updatedHtml);currentEndNode=currentHtml2.node.previousSibling;parent2.insertBefore(currentHtml2.node,updatedStartNode);updatedStart++;currentEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedStart]}currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedEnd];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){loop2=true;updatedHtml=this.updateAllNodes(parent2,currentHtml2,updatedHtml);parent2.insertBefore(currentHtml2.node,afterNode);afterNode=currentHtml2.node;currentStart++;updatedEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedEnd]}}if(updatedEnd<updatedStart)while(currentStart<=currentEnd){parent2.removeChild(currentChildren[currentEnd].node);currentEnd--}else if(currentEnd<currentStart)while(updatedStart<=updatedEnd){updatedChildren[updatedStart]=this.checkCreateAllNodes(parent2,updatedChildren[updatedStart],afterNode);updatedStart++}else{let P=new Int32Array(updatedEnd+1-updatedStart);let I=new Map;for(let i3=updatedStart;i3<=updatedEnd;i3++){P[i3]=-1;I.set(updatedChildren[i3].nodeData.key,i3)}let reusingNodes=updatedStart+updatedChildren.length-1-updatedEnd,toRemove=[];for(let i3=currentStart;i3<=currentEnd;i3++)if(I.has(currentChildren[i3].nodeData.key)){P[I.get(currentChildren[i3].nodeData.key)]=i3;reusingNodes++}else toRemove.push(i3);if(reusingNodes===0){parent2.textContent="";for(let i3=updatedStart;i3<=updatedEnd;i3++)updatedChildren[i3]=this.checkCreateAllNodes(parent2,updatedChildren[i3])}else{let toRemoveLength=toRemove.length;for(let i3=0;i3<toRemoveLength;i3++)parent2.removeChild(currentChildren[toRemove[i3]].node);let longestSeq=longestSubsequence(P,updatedStart),seqIndex=longestSeq.length-1;for(let i3=updatedEnd;i3>=updatedStart;i3--){if(longestSeq[seqIndex]===i3){currentHtml=currentChildren[P[longestSeq[seqIndex]]];updatedChildren[i3]=this.updateAllNodes(parent2,currentHtml,updatedChildren[i3]);afterNode=currentHtml.node;seqIndex--}else{if(P[i3]===-1){updatedChildren[i3]=this.checkCreateAllNodes(parent2,updatedChildren[i3],afterNode);afterNode=updatedChildren[i3].node}else{currentHtml=currentChildren[P[i3]];updatedChildren[i3]=this.updateAllNodes(parent2,currentHtml,updatedChildren[i3]);parent2.insertBefore(currentHtml.node,afterNode);afterNode=currentHtml.node}}}}}};function longestSubsequence(ns,updatedStart){let seq=[],is=[],l=-1,i3,len,pre=new Int32Array(ns.length);for(i3=updatedStart,len=ns.length;i3<len;i3++){let n=ns[i3];if(n<0)continue;let j=findGreatestIndex(seq,n);if(j!==-1)pre[i3]=is[j];if(j===l){l++;seq[l]=n;is[l]=i3}else if(n<seq[j+1]){seq[j+1]=n;is[j+1]=i3}}for(i3=is[l];l>=0;i3=pre[i3],l--)seq[l]=i3;return seq}function findGreatestIndex(seq,n){let lo=-1,hi=seq.length;if(hi>0&&seq[hi-1]<=n)return hi-1;while(hi-lo>1){let mid=Math.floor((lo+hi)/2);if(seq[mid]>n)hi=mid;else lo=mid}return lo}F.prototype.updateNonKeyedChildrenNodes=function(parent2,currentChildren,updatedChildren){let currentChildrenLength=currentChildren.length,updatedChildrenLength=updatedChildren.length,commonLength=Math.min(currentChildrenLength,updatedChildrenLength);for(let i3=0;i3<commonLength;++i3)updatedChildren[i3]=this.updateAllNodes(parent2,currentChildren[i3],updatedChildren[i3]);if(currentChildrenLength<updatedChildrenLength)for(let i3=commonLength;i3<updatedChildrenLength;++i3)updatedChildren[i3]=this.checkCreateAllNodes(parent2,updatedChildren[i3]);else if(currentChildrenLength>updatedChildrenLength)for(let i3=commonLength;i3<currentChildrenLength;++i3)parent2.removeChild(currentChildren[i3].node)};F.prototype.updateNodeData=function(node,currentNodeData,updatedHtml,isSvg){updateStyles(node,currentNodeData.styles,updatedHtml.nodeData.styles);updateAttributes(node,currentNodeData.attributes,updatedHtml.nodeData.attributes);updateClasses(node,currentNodeData.classes,updatedHtml.nodeData.classes,isSvg);updateProperties(node,currentNodeData.properties,updatedHtml.nodeData.properties);this.updateEvents(node,currentNodeData.events,updatedHtml)};function updateStyles(node,currentStyles,updatedStyles){if(currentStyles===void 0){if(updatedStyles!==void 0)createStyles(node,updatedStyles)}else if(updatedStyles===void 0){if(currentStyles!==void 0)node.removeAttribute("style")}else{let matchCount=0;for(let key in currentStyles){let current=currentStyles[key],updated=updatedStyles[key],hasUpdated=updatedStyles[key]!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node.style.setProperty(key,updated);else node.style.removeProperty(key)}let newKeys=Object.keys(updatedStyles),newKeysLength=newKeys.length;for(let i3=0;matchCount<newKeysLength&&i3<newKeysLength;++i3){let key=newKeys[i3];if(currentStyles[key]===void 0){let updated=updatedStyles[key];++matchCount;node.style.setProperty(key,updated)}}}}function updateClasses(node,currentClasses,updatedClasses,isSvg){let classUpdated=updatedClasses!==void 0&&updatedClasses.length>0;if(currentClasses!==void 0&&currentClasses.length>0&&!classUpdated)createClasses(node,[],isSvg);else if(classUpdated)createClasses(node,updatedClasses,isSvg)}function updateAttributes(node,currentAttributes,updatedAttributes){if(currentAttributes===void 0){if(updatedAttributes!==void 0)createAttributes(node,updatedAttributes)}else if(updatedAttributes===void 0){if(currentAttributes!==void 0)for(let key in currentAttributes)node.removeAttribute(key)}else{let matchCount=0;for(let key in currentAttributes){let current=currentAttributes[key],updated=updatedAttributes[key],hasUpdated=updated!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node.setAttribute(key,updated);else node.removeAttribute(key)}let newKeys=Object.keys(updatedAttributes),newKeysLength=newKeys.length;for(let i3=0;matchCount<newKeysLength&&i3<newKeysLength;++i3){let key=newKeys[i3];if(currentAttributes[key]===void 0){let updated=updatedAttributes[key];++matchCount;node.setAttribute(key,updated)}}}}function updateProperties(node,currentProperties,updatedProperties){let addAll=currentProperties===void 0,removeAll=updatedProperties===void 0;if(addAll){if(!removeAll)for(let key in updatedProperties)node[key]=updatedProperties[key]}else if(removeAll){if(!addAll)for(let key in currentProperties)node.removeAttribute(key)}else{let matchCount=0;for(let key in currentProperties){let current=currentProperties[key],updated=updatedProperties[key],hasUpdated=updated!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node[key]=updated;else node.removeAttribute(key)}let newKeys=Object.keys(updatedProperties),newKeysLength=newKeys.length;for(let i3=0;matchCount<newKeysLength&&i3<newKeysLength;++i3){let key=newKeys[i3];if(currentProperties[key]===void 0){let updated=updatedProperties[key];++matchCount;node[key]=updated}}}}F.prototype.updateEvents=function(node,currentEvents,updatedHtml){let updatedEvents=updatedHtml.nodeData.events;if(currentEvents===void 0){if(updatedEvents!==void 0)this.createAllEvents(node,updatedHtml)}else if(updatedEvents===void 0){if(currentEvents!==void 0)for(let key in currentEvents)this.removeEvent(node,key)}else{let matchCount=0;for(let key in currentEvents){let current=currentEvents[key],updated=updatedEvents[key],hasUpdated=false;if(updated===void 0)this.removeEvent(node,key);else{let currentLength=current.length,updatedLength=updated.length;if(currentLength!=updatedLength)hasUpdated=true;else{for(let i3=0;i3<currentLength;++i3)if(current[i3]!=updated[i3]){hasUpdated=true;break}}}if(hasUpdated){matchCount++;this.removeEvent(node,key);this.createEvent(node,key,updatedHtml)}}let newKeys=Object.keys(updatedEvents),newKeysLength=newKeys.length;for(let i3=0;matchCount<newKeysLength&&i3<newKeysLength;++i3){let key=newKeys[i3];if(currentEvents[key]===void 0){++matchCount;this.createEvent(node,key,updatedHtml)}}}};F.prototype.removeEvent=function(node,name15){let eventKey=eventPrefix+name15;if(nonBubblingEvents.includes(name15)){let runNonBubblingEvent=node[eventKey];node.removeEventListener(name15,runNonBubblingEvent,false)}else{let count=--this.applicationEvents.get(name15).count;if(count===0){this.root.removeEventListener(name15,this.applicationEvents.get(name15).handler,false);this.applicationEvents.delete(name15)}}node[eventKey+eventPostfix]=void 0;node[eventKey]=void 0};function lazyMessageMap(mapper,html){html.messageMapper=mapper;if(html.children!==void 0&&html.children.length>0)for(let i3=0;i3<html.children.length;++i3)lazyMessageMap(mapper,html.children[i3])}var pure3=pure(applicativeEffect);var resume=runEffectFn2(resume_);var maybeUpdater=function(updater){return function(v){if(v instanceof Just){return updater(v.value0)}return pure3(unit)}};var start=function(parent2){return function(updater){return runEffectFn4(start_)(Just.create)(parent2)(maybeUpdater(updater))}};var startFrom=function(parent2){return function(updater){return runEffectFn4(startFrom_)(Just.create)(parent2)(maybeUpdater(updater))}};var applicationIds=new Set;function checkApplicationId_(id3){if(applicationIds.has(id3))throw`Error mounting application: id ${id3} already registered!`;applicationIds.add(id3)}var Window=function(){function Window2(){}Window2.value=new Window2;return Window2}();var Document=function(){function Document2(){}Document2.value=new Document2;return Document2}();var Custom=function(){function Custom2(){}Custom2.value=new Custom2;return Custom2}();function typeOf(value13){return typeof value13}function tagOf(value13){return Object.prototype.toString.call(value13).slice(8,-1)}function isNull2(value13){return value13===null}function isUndefined(value13){return value13===void 0}var isArray=Array.isArray||function(value13){return Object.prototype.toString.call(value13)==="[object Array]"};var pure4=pure(applicativeEither);var ForeignError=function(){function ForeignError2(value0){this.value0=value0}ForeignError2.create=function(value0){return new ForeignError2(value0)};return ForeignError2}();var TypeMismatch2=function(){function TypeMismatch3(value0,value1){this.value0=value0;this.value1=value1}TypeMismatch3.create=function(value0){return function(value1){return new TypeMismatch3(value0,value1)}};return TypeMismatch3}();var ErrorAtIndex=function(){function ErrorAtIndex2(value0,value1){this.value0=value0;this.value1=value1}ErrorAtIndex2.create=function(value0){return function(value1){return new ErrorAtIndex2(value0,value1)}};return ErrorAtIndex2}();var ErrorAtProperty=function(){function ErrorAtProperty2(value0,value1){this.value0=value0;this.value1=value1}ErrorAtProperty2.create=function(value0){return function(value1){return new ErrorAtProperty2(value0,value1)}};return ErrorAtProperty2}();var unsafeToForeign=unsafeCoerce2;var unsafeFromForeign=unsafeCoerce2;var fail=function(dictMonad){var $153=throwError(monadThrowExceptT(dictMonad));return function($154){return $153(singleton7($154))}};var readArray=function(dictMonad){var pure13=pure(applicativeExceptT(dictMonad));var fail1=fail(dictMonad);return function(value13){if(isArray(value13)){return pure13(unsafeFromForeign(value13))}if(otherwise){return fail1(new TypeMismatch2("array",tagOf(value13)))}throw new Error("Failed pattern match at Foreign (line 164, column 1 - line 164, column 99): "+[value13.constructor.name])}};var unsafeReadTagged=function(dictMonad){var pure13=pure(applicativeExceptT(dictMonad));var fail1=fail(dictMonad);return function(tag){return function(value13){if(tagOf(value13)===tag){return pure13(unsafeFromForeign(value13))}if(otherwise){return fail1(new TypeMismatch2(tag,tagOf(value13)))}throw new Error("Failed pattern match at Foreign (line 123, column 1 - line 123, column 104): "+[tag.constructor.name,value13.constructor.name])}}};var readBoolean=function(dictMonad){return unsafeReadTagged(dictMonad)("Boolean")};var readNumber=function(dictMonad){return unsafeReadTagged(dictMonad)("Number")};var readInt=function(dictMonad){var map16=map(dictMonad.Bind1().Apply0().Functor0());var readNumber1=readNumber(dictMonad);return function(value13){var error3=new Left(singleton7(new TypeMismatch2("Int",tagOf(value13))));var fromNumber2=function(){var $155=maybe(error3)(pure4);return function($156){return $155(fromNumber($156))}}();return mapExceptT(map16(either($$const(error3))(fromNumber2)))(readNumber1(value13))}};var readString=function(dictMonad){return unsafeReadTagged(dictMonad)("String")};var createSubscription=function(updater){return function(v){if(v.value0 instanceof Window){return createWindowListener(v.value1.value0)((function($13){return updater(v.value1.value1.value0($13))}))}if(v.value0 instanceof Document){return createDocumentListener(v.value1.value0)((function($14){return updater(v.value1.value1.value0($14))}))}if(v.value0 instanceof Custom){return createCustomListener(v.value1.value0)((function($15){return updater(v.value1.value1.value0($15))}))}throw new Error("Failed pattern match at Flame.Subscription.Internal.Listener (line 31, column 83 - line 34, column 75): "+[v.value0.constructor.name])}};var checkApplicationId=runEffectFn1(checkApplicationId_);var createMessageListener=function(appId){return function(updater){return function __do2(){checkApplicationId(appId)();return createCustomListener(appId)((function($16){return updater(unsafeFromForeign($16))}))()}}};var when2=when(applicativeEffect);var for_2=for_(applicativeEffect)(foldableArray);var pure5=pure(applicativeEffect);var traverse_2=traverse_(applicativeEffect)(foldableArray);var map7=map(functorMaybe);var showId=function(dictShow){var show6=show(dictShow);return function(v){return show6(v)}};var run3=function(parent2){return function(isResumed){return function(appId){return function(v){return function __do2(){var modelState=$$new(v.init.value0)();var renderingState=$$new(21)();var render2=function(model){return function __do3(){var rendering2=read(renderingState)();resume(rendering2)(v.view(model))();return write(model)(modelState)()}};var runUpdate=function(message2){return function __do3(){var currentModel=read(modelState)();var v1=v.update(currentModel)(message2);when2(modelHasChanged(currentModel)(v1.value0))(render2(v1.value0))();return runMessages(v1.value1)()}};var runMessages=function(affs){return for_2(affs)(runAff_((function(v1){if(v1 instanceof Left){return log(message(v1.value0))}if(v1 instanceof Right&&v1.value0 instanceof Just){return runUpdate(v1.value0.value0)}return pure5(unit)})))};var rendering=function(){if(isResumed){return startFrom(parent2)(runUpdate)(v.view(v.init.value0))()}return start(parent2)(runUpdate)(v.view(v.init.value0))()}();write(rendering)(renderingState)();runMessages(v.init.value1)();(function(){if(appId instanceof Nothing){return unit}if(appId instanceof Just){return createMessageListener(appId.value0)(runUpdate)()}throw new Error("Failed pattern match at Flame.Application.EffectList (line 142, column 7 - line 144, column 62): "+[appId.constructor.name])})();return traverse_2(createSubscription(runUpdate))(v.subscribe)()}}}}};var noAppId=function(){return Nothing.value}();var mountWith=function(dictShow){var showId1=showId(dictShow);return function(v){return function(appId){return function(application){return function __do2(){var maybeElement=querySelector(v)();if(maybeElement instanceof Just){return run3(maybeElement.value0)(false)(map7(showId1)(appId))(application)()}if(maybeElement instanceof Nothing){return $$throw("Error mounting application")()}throw new Error("Failed pattern match at Flame.Application.EffectList (line 101, column 7 - line 103, column 62): "+[maybeElement.constructor.name])}}}}};var mountWith1=mountWith(showUnit);var mount_=function(selector){return mountWith1(selector)(noAppId)};var SSave=function(){function SSave2(){}SSave2.value=new SSave2;return SSave2}();var SLoad=function(){function SLoad2(){}SLoad2.value=new SLoad2;return SLoad2}();var SClear=function(){function SClear2(){}SClear2.value=new SClear2;return SClear2}();var Update=function(){function Update2(value0,value1){this.value0=value0;this.value1=value1}Update2.create=function(value0){return function(value1){return new Update2(value0,value1)}};return Update2}();var Description=function(){function Description2(value0,value1){this.value0=value0;this.value1=value1}Description2.create=function(value0){return function(value1){return new Description2(value0,value1)}};return Description2}();var Bonus=function(){function Bonus2(value0,value1){this.value0=value0;this.value1=value1}Bonus2.create=function(value0){return function(value1){return new Bonus2(value0,value1)}};return Bonus2}();var DC=function(){function DC2(value0,value1){this.value0=value0;this.value1=value1}DC2.create=function(value0){return function(value1){return new DC2(value0,value1)}};return DC2}();var Roll=function(){function Roll2(value0){this.value0=value0}Roll2.create=function(value0){return new Roll2(value0)};return Roll2}();var Remove=function(){function Remove2(value0){this.value0=value0}Remove2.create=function(value0){return new Remove2(value0)};return Remove2}();var Advantage=function(){function Advantage2(value0,value1){this.value0=value0;this.value1=value1}Advantage2.create=function(value0){return function(value1){return new Advantage2(value0,value1)}};return Advantage2}();var Disadvantage=function(){function Disadvantage2(value0,value1){this.value0=value0;this.value1=value1}Disadvantage2.create=function(value0){return function(value1){return new Disadvantage2(value0,value1)}};return Disadvantage2}();var Add=function(){function Add2(){}Add2.value=new Add2;return Add2}();var AAdd=function(){function AAdd2(){}AAdd2.value=new AAdd2;return AAdd2}();var ARemove=function(){function ARemove2(value0){this.value0=value0}ARemove2.create=function(value0){return new ARemove2(value0)};return ARemove2}();var ARoll=function(){function ARoll2(value0){this.value0=value0}ARoll2.create=function(value0){return new ARoll2(value0)};return ARoll2}();var AUpdate=function(){function AUpdate2(value0,value1){this.value0=value0;this.value1=value1}AUpdate2.create=function(value0){return function(value1){return new AUpdate2(value0,value1)}};return AUpdate2}();var Attack=function(){function Attack2(value0){this.value0=value0}Attack2.create=function(value0){return new Attack2(value0)};return Attack2}();var Save=function(){function Save2(value0){this.value0=value0}Save2.create=function(value0){return new Save2(value0)};return Save2}();var State=function(){function State2(value0){this.value0=value0}State2.create=function(value0){return new State2(value0)};return State2}();var StateSaved=function(){function StateSaved2(value0){this.value0=value0}StateSaved2.create=function(value0){return new StateSaved2(value0)};return StateSaved2}();var StateLoaded=function(){function StateLoaded2(value0){this.value0=value0}StateLoaded2.create=function(value0){return new StateLoaded2(value0)};return StateLoaded2}();var ChangeTab=function(){function ChangeTab2(value0){this.value0=value0}ChangeTab2.create=function(value0){return new ChangeTab2(value0)};return ChangeTab2}();var initSave=function(){return{description:"",advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:Nothing.value}}();var initModel=function(){return{profile:"Rusty",profiles:[],currentTab:"Attack",attackRolls:[{attackBonus:12,advantage:false,disadvantage:false,description:"Wrecking Ball (Green Flame Blade)",targetAC:0,attackRoll:[],damageDice:[{diceType:10,diceCount:1,damageBonus:7,damageRoll:[],damageType:"Bludgeoning"},{diceType:4,diceCount:1,damageBonus:0,damageRoll:[],damageType:"Acid"},{diceType:8,diceCount:2,damageBonus:10,damageRoll:[],damageType:"Fire"}]}],savingThrows:[{advantage:false,disadvantage:false,saveBonus:4,saveRoll:[],targetDC:Nothing.value,description:"STR Save"},{advantage:false,disadvantage:false,saveBonus:1,saveRoll:[],targetDC:Nothing.value,description:"DEX Save"},{advantage:false,disadvantage:false,saveBonus:8,saveRoll:[],targetDC:Nothing.value,description:"CON Save"},{advantage:false,disadvantage:false,saveBonus:10,saveRoll:[],targetDC:Nothing.value,description:"INT Save"},{advantage:false,disadvantage:false,saveBonus:3,saveRoll:[],targetDC:Nothing.value,description:"WIS Save"},{advantage:false,disadvantage:false,saveBonus:9,saveRoll:[],targetDC:Nothing.value,description:"CHA Save"}]}}();var initDamageDice={diceType:6,diceCount:1,damageBonus:0,damageRoll:[],damageType:"Bludgeoning"};var initAttack={attackBonus:0,advantage:false,disadvantage:false,damageDice:[],description:"",targetAC:0,attackRoll:[]};var random=Math.random;var randomInt=function(low2){return function(high2){return function __do2(){var n=random();var asNumber=(toNumber(high2)-toNumber(low2)+1)*n+toNumber(low2);return floor2(asNumber)}}};var messageEventData=5;var rawEventData=6;function createEvent_(name15){return function(message2){return[messageEventData,name15,message2]}}function createRawEvent_(name15){return function(handler){return[rawEventData,name15,handler]}}function nodeValue_(event){if(event.target.contentEditable===true||event.target.contentEditable==="true"||event.target.contentEditable==="")return event.target.innerText;return event.target.value}function checkedValue_(event){if(event.target.tagName==="INPUT"&&(event.target.type==="checkbox"||event.target.type==="radio"))return event.target.checked;return false}var map8=map(functorEffect);var nodeValue=runEffectFn1(nodeValue_);var createRawEvent=function(name15){return function(handler){return createRawEvent_(name15)(handler)}};var onInput=function(constructor){var handler=function(event){return map8((function($6){return Just.create(constructor($6))}))(nodeValue(event))};return createRawEvent("input")(handler)};var createEvent=function(name15){return function(message2){return createEvent_(name15)(message2)}};var onClick=createEvent("click");var checkedValue=runEffectFn1(checkedValue_);var onCheck=function(constructor){var handler=function(event){return map8((function($9){return Just.create(constructor($9))}))(checkedValue(event))};return createRawEvent("input")(handler)};var add2=add(semiringInt);var max3=max(ordInt);var min3=min(ordInt);var toNodeArray2=toNodeArray(toNodeNodeDataNodeData);var toNodeArray1=toNodeArray(toNodeHtmlHtml);var div4=div3(toNodeArray2)(toNodeArray1);var class$prime2=class$prime(toClassListString);var input2=input(toNodeArray2);var span4=span(toNodeArray2)(toNodeArray1);var label2=label(toNodeArray2)(toNodeArray1);var i2=i(toNodeArray2)(toNodeArray1);var button2=button(toNodeArray2)(toNodeArray1);var pure6=pure(applicativeEffect);var show3=show(showInt);var updateArray=function(dictEq){var eq2=eq(dictEq);return function(arr){return function(item){return function(newItem){var v=findIndex((function(x){return eq2(x)(item)}))(arr);if(v instanceof Nothing){return arr}if(v instanceof Just){var v1=updateAt(v.value0)(newItem)(arr);if(v1 instanceof Nothing){return arr}if(v1 instanceof Just){return v1.value0}throw new Error("Failed pattern match at Utils (line 42, column 17 - line 44, column 28): "+[v1.constructor.name])}throw new Error("Failed pattern match at Utils (line 40, column 3 - line 44, column 28): "+[v.constructor.name])}}}};var sum2=function(arr){return foldr2(add2)(0)(arr)};var rollDice=function(n){return randomInt(1)(n)};var resolveAdvantage=function(adv){return function(dis){return function(rolls){if(rolls.length===2){var $36=adv&&dis;if($36){return rolls[0]}if(adv){return max3(rolls[0])(rolls[1])}if(dis){return min3(rolls[0])(rolls[1])}return rolls[0]}return 0}}};var mkText=function(caption){return function(msg){return function(value13){return div4([class$prime2("small field border")])([input2([type$prime("small text"),value(value13),onInput(msg)]),span4([class$prime2("small helper")])([text(caption)])])}}};var mkCheckbox=function(caption){return function(icon){return function(dirn){return function(msg){return function(value13){return label2([class$prime2("small switch icon")])([input2([class$prime2("small"),type$prime("checkbox"),checked(value13),onCheck(msg)]),span4([class$prime2("small")])([i2([class$prime2("small")])([text(icon)])]),div4([class$prime2("small tooltip "+dirn)])([text(caption)])])}}}}};var mkButton=function(msg){return function(icon){return function(tooltip){return button2([class$prime2("small square round extra"),onClick(msg)])([i2([class$prime2("small")])([text(icon)]),div4([class$prime2("small tooltip left")])([text(tooltip)])])}}};var mapM=function(f){return function(xs){var v=uncons(xs);if(v instanceof Nothing){return pure6([])}if(v instanceof Just){return function __do2(){var z=f(v.value0.head)();var zs=mapM(f)(v.value0.tail)();return cons(z)(zs)}}throw new Error("Failed pattern match at Utils (line 16, column 3 - line 21, column 22): "+[v.constructor.name])}};var fromStr=function(s){var v=fromString(s);if(v instanceof Nothing){return 0}if(v instanceof Just){return v.value0}throw new Error("Failed pattern match at Utils (line 67, column 3 - line 69, column 17): "+[v.constructor.name])};var mkNumber=function(v){return function(v1){return function(v2){if(v2 instanceof Just){return div4([class$prime2("small field border")])([input2([type$prime("small number"),value(show3(v2.value0)),onInput((function(x){return v1(fromStr(x))}))]),span4([class$prime2("small helper")])([text(v)])])}if(v2 instanceof Nothing){return div4([class$prime2("small field border")])([input2([type$prime("small number"),onInput((function(x){return v1(fromStr(x))}))]),span4([class$prime2("small helper")])([text(v)])])}throw new Error("Failed pattern match at Utils (line 53, column 1 - line 53, column 66): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}};var toNodeArray3=toNodeArray(toNodeNodeDataNodeData);var toNodeArray12=toNodeArray(toNodeHtmlHtml);var div5=div3(toNodeArray3)(toNodeArray12);var class$prime3=class$prime(toClassListString);var eqRec2=eqRec();var eqRowCons2=eqRowCons(eqRowNil)();var eqArray2=eqArray(eqInt);var eqRec1=eqRec2(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons2({reflectSymbol:function(){return"diceType"}})(eqInt))()({reflectSymbol:function(){return"diceCount"}})(eqInt))()({reflectSymbol:function(){return"damageType"}})(eqString))()({reflectSymbol:function(){return"damageRoll"}})(eqArray2))()({reflectSymbol:function(){return"damageBonus"}})(eqInt));var updateArray2=updateArray(eqRec1);var show4=show(showArray(showInt));var $$delete3=$$delete(eqRec1);var pure1=pure(applicativeAff);var eqRec22=eqRec2(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons2({reflectSymbol:function(){return"targetAC"}})(eqInt))()({reflectSymbol:function(){return"disadvantage"}})(eqBoolean))()({reflectSymbol:function(){return"description"}})(eqString))()({reflectSymbol:function(){return"damageDice"}})(eqArray(eqRec1)))()({reflectSymbol:function(){return"attackRoll"}})(eqArray2))()({reflectSymbol:function(){return"attackBonus"}})(eqInt))()({reflectSymbol:function(){return"advantage"}})(eqBoolean));var delete1=$$delete(eqRec22);var updateArray1=updateArray(eqRec22);var map9=map(functorAff);var liftEffect3=liftEffect(monadEffectAff);var map1=map(functorArray);var article_2=article_(toNodeArray12);var h62=h6(toNodeArray3)(toNodeArray12);var show1=show(showInt);var viewDice=function(attack){return function(damage){return div5([class$prime3("small s12 grid")])([div5([class$prime3("small s2")])([mkNumber("Dice Count")((function(d){return new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:updateArray2(attack.damageDice)(damage)({diceType:damage.diceType,damageBonus:damage.damageBonus,damageRoll:damage.damageRoll,damageType:damage.damageType,diceCount:d})}))}))(new Just(damage.diceCount))]),div5([class$prime3("small s2")])([mkNumber("Dice Type")((function(d){return new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:updateArray2(attack.damageDice)(damage)({diceCount:damage.diceCount,damageBonus:damage.damageBonus,damageRoll:damage.damageRoll,damageType:damage.damageType,diceType:d})}))}))(new Just(damage.diceType))]),div5([class$prime3("small s2")])([mkNumber("Damage Bonus")((function(d){return new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:updateArray2(attack.damageDice)(damage)({diceType:damage.diceType,diceCount:damage.diceCount,damageRoll:damage.damageRoll,damageType:damage.damageType,damageBonus:d})}))}))(new Just(damage.damageBonus))]),div5([class$prime3("small s2")])([mkText("Damage Type")((function(d){return new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:updateArray2(attack.damageDice)(damage)({diceType:damage.diceType,diceCount:damage.diceCount,damageBonus:damage.damageBonus,damageRoll:damage.damageRoll,damageType:d})}))}))(damage.damageType)]),div5([class$prime3("small s3")])([text("Rolls: "+show4(damage.damageRoll))]),div5([class$prime3("small s1")])([mkButton(new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:$$delete3(damage)(attack.damageDice)})))("delete")("Remove Saving Throw")])])}};var rollAttackDamage=function(damage){return function __do2(){var rolls=mapM((function(v){return rollDice(damage.diceType)}))(range2(1)(damage.diceCount))();return{damageBonus:damage.damageBonus,damageType:damage.damageType,diceCount:damage.diceCount,diceType:damage.diceType,damageRoll:rolls}}};var rollAttack=function(attack){return function __do2(){var a3=rollDice(20)();var b=rollDice(20)();var dmg=mapM(rollAttackDamage)(attack.damageDice)();return{advantage:attack.advantage,attackBonus:attack.attackBonus,description:attack.description,disadvantage:attack.disadvantage,targetAC:attack.targetAC,attackRoll:[a3,b],damageDice:dmg}}};var updateAttack=function(v){return function(v1){if(v1 instanceof AAdd){return new Tuple({currentTab:v.currentTab,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,attackRolls:snoc(v.attackRolls)(initAttack)},[pure1(new Just(new State(SSave.value)))])}if(v1 instanceof ARemove){return new Tuple({currentTab:v.currentTab,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,attackRolls:delete1(v1.value0)(v.attackRolls)},[pure1(new Just(new State(SSave.value)))])}if(v1 instanceof AUpdate){return new Tuple({currentTab:v.currentTab,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,attackRolls:updateArray1(v.attackRolls)(v1.value0)(v1.value1)},[pure1(new Just(new State(SSave.value)))])}if(v1 instanceof ARoll){return new Tuple(v,[map9((function($116){return Just.create(Attack.create($116))}))(map9(AUpdate.create(v1.value0))(liftEffect3(rollAttack(v1.value0))))])}throw new Error("Failed pattern match at AttackRolls (line 17, column 1 - line 17, column 79): "+[v.constructor.name,v1.constructor.name])}};var diceDamage=function(damage){return sum2(damage.damageRoll)+damage.damageBonus|0};var attackDamage=function(attack){return sum2(map1(diceDamage)(attack.damageDice))};var viewAttackRoll=function(attack){return article_2([div5([class$prime3("small grid")])([div5([class$prime3("small s5")])([mkText("Description")((function(s){return new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,damageDice:attack.damageDice,targetAC:attack.targetAC,attackRoll:attack.attackRoll,description:s}))}))(attack.description)]),div5([class$prime3("small s1")])([mkCheckbox("Advantage")("arrow_upward")("bottom")((function(b){return new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,disadvantage:attack.disadvantage,damageDice:attack.damageDice,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,advantage:b}))}))(attack.advantage)]),div5([class$prime3("small s1")])([mkCheckbox("Disadvantage")("arrow_downward")("bottom")((function(b){return new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,damageDice:attack.damageDice,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,disadvantage:b}))}))(attack.disadvantage)]),div5([class$prime3("small s2")])([mkNumber("Attack Bonus")((function(b){return new Attack(new AUpdate(attack,{advantage:attack.advantage,disadvantage:attack.disadvantage,damageDice:attack.damageDice,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,attackBonus:b}))}))(new Just(attack.attackBonus))]),div5([class$prime3("small s2")])([mkNumber("Target AC")((function(b){return new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,damageDice:attack.damageDice,description:attack.description,attackRoll:attack.attackRoll,targetAC:b}))}))(new Just(attack.targetAC))]),div5([class$prime3("small s1")])([mkButton(new Attack(new ARemove(attack)))("delete")("Remove Attack Roll")]),div5([class$prime3("small s11 fill grid middle-align")])([h62([class$prime3("small s11 padding")])([text("Damage Dice")]),div5([class$prime3("small s1")])([mkButton(new Attack(new AUpdate(attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:snoc(attack.damageDice)(initDamageDice)})))("add")("Add Attack Roll")])]),div5([class$prime3("small s1")])([mkButton(new Attack(new ARoll(attack)))("Casino")("Roll The Dice!")]),div5([class$prime3("small s11 grid")])(map1(viewDice(attack))(attack.damageDice)),div5([class$prime3("small s11")])([text("Attack Roll: "+(show1(resolveAdvantage(attack.advantage)(attack.disadvantage)(attack.attackRoll)+attack.attackBonus|0)+(". Target AC: "+(show1(attack.targetAC)+(". Damage: "+(show1(attackDamage(attack))+"."))))))])])])};var max4=max(ordInt);var min4=min(ordInt);var toNodeArray4=toNodeArray(toNodeNodeDataNodeData);var toNodeArray13=toNodeArray(toNodeHtmlHtml);var div6=div3(toNodeArray4)(toNodeArray13);var class$prime4=class$prime(toClassListString);var show5=show(showInt);var div_2=div_(toNodeArray13);var article_3=article_(toNodeArray13);var nav2=nav(toNodeArray4)(toNodeArray13);var eqRec3=eqRec()(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowNil)()({reflectSymbol:function(){return"targetDC"}})(eqMaybe(eqInt)))()({reflectSymbol:function(){return"saveRoll"}})(eqArray(eqInt)))()({reflectSymbol:function(){return"saveBonus"}})(eqInt))()({reflectSymbol:function(){return"disadvantage"}})(eqBoolean))()({reflectSymbol:function(){return"description"}})(eqString))()({reflectSymbol:function(){return"advantage"}})(eqBoolean));var updateArray3=updateArray(eqRec3);var pure12=pure(applicativeAff);var map10=map(functorAff);var liftEffect4=liftEffect(monadEffectAff);var $$delete4=$$delete(eqRec3);var saveRoll=function(save){if(save.saveRoll.length===2){var $71=[save.advantage,save.disadvantage];if($71.length===2&&($71[0]&&!$71[1])){return max4(save["saveRoll"][0])(save["saveRoll"][1])}if($71.length===2&&(!$71[0]&&$71[1])){return min4(save["saveRoll"][0])(save["saveRoll"][1])}return save["saveRoll"][0]}return 0};var saveLine2=function(save){if(save.saveRoll.length===0){return Nothing.value}if(save.targetDC instanceof Nothing){return Nothing.value}if(save.targetDC instanceof Just){var $80=(saveRoll(save)+save.saveBonus|0)>=save.targetDC.value0;if($80){return new Just(div6([class$prime4("small primary")])([text("Target DC: "+(show5(save.targetDC.value0)+", Success!"))]))}return new Just(div6([class$prime4("small error")])([text("Target DC: "+(show5(save.targetDC.value0)+", Failure!"))]))}throw new Error("Failed pattern match at SavingThrows (line 67, column 7 - line 72, column 120): "+[save.targetDC.constructor.name])};var saveLine1=function(save){if(save.saveRoll.length===2){var $83=save.advantage===save.disadvantage;if($83){return"Roll ["+(show5(save["saveRoll"][0])+("] + Bonus ["+(show5(save.saveBonus)+("] = "+show5(saveRoll(save)+save.saveBonus|0)))))}return"Roll ["+(show5(save["saveRoll"][0])+(","+(show5(save["saveRoll"][1])+("] + Bonus ["+(show5(save.saveBonus)+("] = "+show5(saveRoll(save)+save.saveBonus|0)))))))}return"-"};var showSaveResult=function(save){var v=saveLine2(save);if(v instanceof Nothing){return div_2([text(saveLine1(save))])}if(v instanceof Just){return div_2([div_2([text(saveLine1(save))]),v.value0])}throw new Error("Failed pattern match at SavingThrows (line 46, column 3 - line 52, column 8): "+[v.constructor.name])};var viewSavingThrow=function(save){return article_3([nav2([class$prime4("small grid")])([div6([class$prime4("small s2")])([mkText("Description")((function(s){return new Save(new Description(save,s))}))(save.description)]),div6([class$prime4("small s2")])([mkNumber("Save Bonus")((function(b){return new Save(new Bonus(save,b))}))(new Just(save.saveBonus))]),div6([class$prime4("small s1")])([mkCheckbox("Advantage")("arrow_upward")("top")((function(b){return new Save(new Advantage(save,b))}))(save.advantage),mkCheckbox("Disadvantage")("arrow_downward")("bottom")((function(b){return new Save(new Disadvantage(save,b))}))(save.disadvantage)]),div6([class$prime4("small s2")])([mkNumber("Target DC")((function(d){return new Save(new DC(save,d))}))(save.targetDC)]),div6([class$prime4("small s1")])([mkButton(new Save(new Roll(save)))("Casino")("Roll The Dice!")]),div6([class$prime4("small s3")])([showSaveResult(save)]),div6([class$prime4("small s1")])([mkButton(new Save(new Remove(save)))("delete")("Remove Saving Throw")])])])};var rollSave=function(save){return function __do2(){var a3=rollDice(20)();var b=rollDice(20)();var roll=[a3,b];return{advantage:save.advantage,description:save.description,disadvantage:save.disadvantage,saveBonus:save.saveBonus,targetDC:save.targetDC,saveRoll:roll}}};var updateSave=function(v){return function(v1){if(v1 instanceof Update){return new Tuple({attackRolls:v.attackRolls,currentTab:v.currentTab,profile:v.profile,profiles:v.profiles,savingThrows:updateArray3(v.savingThrows)(v1.value0)(v1.value1)},[pure12(new Just(new State(SSave.value)))])}if(v1 instanceof Description){return new Tuple(v,[pure12(new Just(new Save(new Update(v1.value0,{advantage:v1.value0.advantage,disadvantage:v1.value0.disadvantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,description:v1.value1}))))])}if(v1 instanceof Bonus){return new Tuple(v,[pure12(new Just(new Save(new Update(v1.value0,{description:v1.value0.description,advantage:v1.value0.advantage,disadvantage:v1.value0.disadvantage,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,saveBonus:v1.value1}))))])}if(v1 instanceof DC){return new Tuple(v,[pure12(new Just(new Save(new Update(v1.value0,{description:v1.value0.description,advantage:v1.value0.advantage,disadvantage:v1.value0.disadvantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:new Just(v1.value1)}))))])}if(v1 instanceof Advantage){return new Tuple(v,[pure12(new Just(new Save(new Update(v1.value0,{description:v1.value0.description,disadvantage:v1.value0.disadvantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,advantage:v1.value1}))))])}if(v1 instanceof Disadvantage){return new Tuple(v,[pure12(new Just(new Save(new Update(v1.value0,{description:v1.value0.description,advantage:v1.value0.advantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,disadvantage:v1.value1}))))])}if(v1 instanceof Roll){return new Tuple(v,[map10((function($104){return Just.create(Save.create($104))}))(map10(Update.create(v1.value0))(liftEffect4(rollSave(v1.value0))))])}if(v1 instanceof Remove){return new Tuple({attackRolls:v.attackRolls,currentTab:v.currentTab,profile:v.profile,profiles:v.profiles,savingThrows:$$delete4(v1.value0)(v.savingThrows)},[pure12(new Just(new State(SSave.value)))])}if(v1 instanceof Add){return new Tuple({attackRolls:v.attackRolls,currentTab:v.currentTab,profile:v.profile,profiles:v.profiles,savingThrows:snoc(v.savingThrows)(initSave)},[pure12(new Just(new State(SSave.value)))])}throw new Error("Failed pattern match at SavingThrows (line 17, column 1 - line 17, column 75): "+[v.constructor.name,v1.constructor.name])}};var _parseJSON=JSON.parse;var _undefined=void 0;var _unsafeStringify=JSON.stringify;var unwrap2=unwrap();var withExcept=withExceptT(functorIdentity);var runExcept=function($3){return unwrap2(runExceptT($3))};function unsafeReadPropImpl(f,s,key,value13){return value13==null?f:s(value13[key])}var unsafeReadProp=function(dictMonad){var fail2=fail(dictMonad);var pure9=pure(applicativeExceptT(dictMonad));return function(k){return function(value13){return unsafeReadPropImpl(fail2(new TypeMismatch2("object",typeOf(value13))),pure9,k,value13)}}};var readProp=function(dictMonad){return unsafeReadProp(dictMonad)};function copyRecord(rec){var copy={};for(var key in rec){if({}.hasOwnProperty.call(rec,key)){copy[key]=rec[key]}}return copy}function unsafeInsert(l){return function(a3){return function(rec){rec[l]=a3;return rec}}}var semigroupoidBuilder=semigroupoidFn;var insert5=function(){return function(){return function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(l){return function(a3){return function(r1){return unsafeInsert(reflectSymbol2(l))(a3)(r1)}}}}}};var categoryBuilder=categoryFn;var build=function(v){return function(r1){return v(copyRecord(r1))}};var map11=map(functorArray);var applicativeExceptT2=applicativeExceptT(monadIdentity);var pure7=pure(applicativeExceptT2);var map12=map(functorExceptT(functorIdentity));var map22=map(functorNonEmptyList);var bindExceptT2=bindExceptT(monadIdentity);var bindFlipped3=bindFlipped(bindExceptT2);var composeKleisliFlipped2=composeKleisliFlipped(bindExceptT2);var identity6=identity(categoryBuilder);var traverseWithIndex2=traverseWithIndex(traversableWithIndexArray)(applicativeExceptT2);var readArray1=readArray(monadIdentity);var bind2=bind(bindExceptT2);var compose1=compose(semigroupoidBuilder);var insert6=insert5()();var readProp2=readProp(monadIdentity);var writeImplFields=function(dict){return dict.writeImplFields};var writeImpl=function(dict){return dict.writeImpl};var writeJSON=function(dictWriteForeign){var $191=writeImpl(dictWriteForeign);return function($192){return _unsafeStringify($191($192))}};var writeForeignString={writeImpl:unsafeToForeign};var writeForeignInt={writeImpl:unsafeToForeign};var writeForeignBoolean={writeImpl:unsafeToForeign};var writeForeignArray=function(dictWriteForeign){var writeImpl1=writeImpl(dictWriteForeign);return{writeImpl:function(xs){return unsafeToForeign(map11(writeImpl1)(xs))}}};var $$undefined=_undefined;var writeForeignMaybe=function(dictWriteForeign){return{writeImpl:maybe($$undefined)(writeImpl(dictWriteForeign))}};var recordWriteForeign=function(){return function(dictWriteForeignFields){var writeImplFields1=writeImplFields(dictWriteForeignFields);return{writeImpl:function(rec){var steps=writeImplFields1($$Proxy.value)(rec);return unsafeToForeign(build(steps)({}))}}}};var readString2={readImpl:readString(monadIdentity)};var readInt2={readImpl:readInt(monadIdentity)};var readImpl=function(dict){return dict.readImpl};var readMaybe=function(dictReadForeign){return{readImpl:function(){var readNullOrUndefined=function(v){return function(v1){if(isNull2(v1)||isUndefined(v1)){return pure7(Nothing.value)}return map12(Just.create)(v(v1))}};return readNullOrUndefined(readImpl(dictReadForeign))}()}};var readFieldsNil={getFields:function(v){return function(v1){return pure7(identity6)}}};var readBoolean2={readImpl:readBoolean(monadIdentity)};var readArray2=function(dictReadForeign){var readImpl2=readImpl(dictReadForeign);return{readImpl:function(){var readAtIdx=function(i3){return function(f){return withExcept(map22(ErrorAtIndex.create(i3)))(readImpl2(f))}};return composeKleisliFlipped2(traverseWithIndex2(readAtIdx))(readArray1)}()}};var parseJSON=function(){var $205=lmap(bifunctorEither)(function(){var $208=pure(applicativeNonEmptyList);return function($209){return $208(ForeignError.create(message($209)))}}());var $206=runEffectFn1(_parseJSON);return function($207){return ExceptT(Identity($205(unsafePerformEffect($$try($206($207))))))}}();var readJSON=function(dictReadForeign){var $210=composeKleisliFlipped2(readImpl(dictReadForeign))(parseJSON);return function($211){return runExcept($210($211))}};var nilWriteForeignFields={writeImplFields:function(v){return function(v1){return identity6}}};var getFields=function(dict){return dict.getFields};var readRecord=function(){return function(dictReadForeignFields){var getFields1=getFields(dictReadForeignFields);return{readImpl:function(o){return map12(flip(build)({}))(getFields1($$Proxy.value)(o))}}}};var consWriteForeignFields=function(dictIsSymbol){var get2=get(dictIsSymbol)();var insert1=insert6(dictIsSymbol);return function(dictWriteForeign){var writeImpl1=writeImpl(dictWriteForeign);return function(dictWriteForeignFields){var writeImplFields1=writeImplFields(dictWriteForeignFields);return function(){return function(){return function(){return{writeImplFields:function(v){return function(rec){var rest=writeImplFields1($$Proxy.value)(rec);var value13=writeImpl1(get2($$Proxy.value)(rec));var result=compose1(insert1($$Proxy.value)(value13))(rest);return result}}}}}}}}};var applyEither2=function(dictSemigroup){var append12=append(dictSemigroup);return function(v){return function(v1){if(v instanceof Left&&v1 instanceof Right){return new Left(v.value0)}if(v instanceof Left&&v1 instanceof Left){return new Left(append12(v.value0)(v1.value0))}if(v instanceof Right&&v1 instanceof Left){return new Left(v1.value0)}if(v instanceof Right&&v1 instanceof Right){return new Right(v.value0(v1.value0))}throw new Error("Failed pattern match at Simple.JSON (line 241, column 1 - line 241, column 90): "+[v.constructor.name,v1.constructor.name])}}};var exceptTApply=function(dictSemigroup){var applyEither1=applyEither2(dictSemigroup);return function(dictApplicative){var Apply0=dictApplicative.Apply0();var apply3=apply(Apply0);var map42=map(Apply0.Functor0());return function(fun){return function(a3){return apply3(map42(applyEither1)(runExceptT(fun)))(runExceptT(a3))}}}};var exceptTApply1=exceptTApply(semigroupNonEmptyList)(applicativeIdentity);var readFieldsCons=function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);var insert1=insert6(dictIsSymbol);return function(dictReadForeign){var readImpl2=readImpl(dictReadForeign);return function(dictReadForeignFields){var getFields1=getFields(dictReadForeignFields);return function(){return function(){return{getFields:function(v){return function(obj){var rest=getFields1($$Proxy.value)(obj);var name15=reflectSymbol2($$Proxy.value);var withExcept$prime=withExcept(map22(ErrorAtProperty.create(name15)));var first=bind2(withExcept$prime(bindFlipped3(readImpl2)(readProp2(name15)(obj))))((function(value13){return pure7(insert1($$Proxy.value)(value13))}));return exceptTApply1(map12(compose1)(first))(rest)}}}}}}}};var windowImpl=function(){return window};function localStorage(window2){return function(){return window2.localStorage}}function _getItem(key){return function(storage){return function(){return storage.getItem(key)}}}function setItem(key){return function(value13){return function(storage){return function(){storage.setItem(key,value13)}}}}function removeItem(key){return function(storage){return function(){storage.removeItem(key)}}}var map13=map(functorEffect);var getItem=function(s){var $5=map13(toMaybe);var $6=_getItem(s);return function($7){return $5($6($7))}};var recordWriteForeign2=recordWriteForeign();var attackRollsIsSymbol={reflectSymbol:function(){return"attackRolls"}};var advantageIsSymbol={reflectSymbol:function(){return"advantage"}};var consWriteForeignFields2=consWriteForeignFields(advantageIsSymbol)(writeForeignBoolean);var attackBonusIsSymbol={reflectSymbol:function(){return"attackBonus"}};var attackRollIsSymbol={reflectSymbol:function(){return"attackRoll"}};var writeForeignArray2=writeForeignArray(writeForeignInt);var damageDiceIsSymbol={reflectSymbol:function(){return"damageDice"}};var damageBonusIsSymbol={reflectSymbol:function(){return"damageBonus"}};var damageRollIsSymbol={reflectSymbol:function(){return"damageRoll"}};var damageTypeIsSymbol={reflectSymbol:function(){return"damageType"}};var diceCountIsSymbol={reflectSymbol:function(){return"diceCount"}};var diceTypeIsSymbol={reflectSymbol:function(){return"diceType"}};var descriptionIsSymbol={reflectSymbol:function(){return"description"}};var consWriteForeignFields1=consWriteForeignFields(descriptionIsSymbol)(writeForeignString);var disadvantageIsSymbol={reflectSymbol:function(){return"disadvantage"}};var consWriteForeignFields22=consWriteForeignFields(disadvantageIsSymbol)(writeForeignBoolean);var targetACIsSymbol={reflectSymbol:function(){return"targetAC"}};var currentTabIsSymbol={reflectSymbol:function(){return"currentTab"}};var profileIsSymbol={reflectSymbol:function(){return"profile"}};var profilesIsSymbol={reflectSymbol:function(){return"profiles"}};var savingThrowsIsSymbol={reflectSymbol:function(){return"savingThrows"}};var saveBonusIsSymbol={reflectSymbol:function(){return"saveBonus"}};var saveRollIsSymbol={reflectSymbol:function(){return"saveRoll"}};var targetDCIsSymbol={reflectSymbol:function(){return"targetDC"}};var writeJSON2=writeJSON(recordWriteForeign2(consWriteForeignFields(attackRollsIsSymbol)(writeForeignArray(recordWriteForeign2(consWriteForeignFields2(consWriteForeignFields(attackBonusIsSymbol)(writeForeignInt)(consWriteForeignFields(attackRollIsSymbol)(writeForeignArray2)(consWriteForeignFields(damageDiceIsSymbol)(writeForeignArray(recordWriteForeign2(consWriteForeignFields(damageBonusIsSymbol)(writeForeignInt)(consWriteForeignFields(damageRollIsSymbol)(writeForeignArray2)(consWriteForeignFields(damageTypeIsSymbol)(writeForeignString)(consWriteForeignFields(diceCountIsSymbol)(writeForeignInt)(consWriteForeignFields(diceTypeIsSymbol)(writeForeignInt)(nilWriteForeignFields)()()())()()())()()())()()())()()())))(consWriteForeignFields1(consWriteForeignFields22(consWriteForeignFields(targetACIsSymbol)(writeForeignInt)(nilWriteForeignFields)()()())()()())()()())()()())()()())()()())()()())))(consWriteForeignFields(currentTabIsSymbol)(writeForeignString)(consWriteForeignFields(profileIsSymbol)(writeForeignString)(consWriteForeignFields(profilesIsSymbol)(writeForeignArray(writeForeignString))(consWriteForeignFields(savingThrowsIsSymbol)(writeForeignArray(recordWriteForeign2(consWriteForeignFields2(consWriteForeignFields1(consWriteForeignFields22(consWriteForeignFields(saveBonusIsSymbol)(writeForeignInt)(consWriteForeignFields(saveRollIsSymbol)(writeForeignArray2)(consWriteForeignFields(targetDCIsSymbol)(writeForeignMaybe(writeForeignInt))(nilWriteForeignFields)()()())()()())()()())()()())()()())()()())))(nilWriteForeignFields)()()())()()())()()())()()())()()()));var readRecord2=readRecord();var readFieldsCons2=readFieldsCons(advantageIsSymbol)(readBoolean2);var readArray3=readArray2(readInt2);var readFieldsCons1=readFieldsCons(descriptionIsSymbol)(readString2);var readFieldsCons22=readFieldsCons(disadvantageIsSymbol)(readBoolean2);var readJSON2=readJSON(readRecord2(readFieldsCons(attackRollsIsSymbol)(readArray2(readRecord2(readFieldsCons2(readFieldsCons(attackBonusIsSymbol)(readInt2)(readFieldsCons(attackRollIsSymbol)(readArray3)(readFieldsCons(damageDiceIsSymbol)(readArray2(readRecord2(readFieldsCons(damageBonusIsSymbol)(readInt2)(readFieldsCons(damageRollIsSymbol)(readArray3)(readFieldsCons(damageTypeIsSymbol)(readString2)(readFieldsCons(diceCountIsSymbol)(readInt2)(readFieldsCons(diceTypeIsSymbol)(readInt2)(readFieldsNil)()())()())()())()())()())))(readFieldsCons1(readFieldsCons22(readFieldsCons(targetACIsSymbol)(readInt2)(readFieldsNil)()())()())()())()())()())()())()())))(readFieldsCons(currentTabIsSymbol)(readString2)(readFieldsCons(profileIsSymbol)(readString2)(readFieldsCons(profilesIsSymbol)(readArray2(readString2))(readFieldsCons(savingThrowsIsSymbol)(readArray2(readRecord2(readFieldsCons2(readFieldsCons1(readFieldsCons22(readFieldsCons(saveBonusIsSymbol)(readInt2)(readFieldsCons(saveRollIsSymbol)(readArray3)(readFieldsCons(targetDCIsSymbol)(readMaybe(readInt2))(readFieldsNil)()())()())()())()())()())()())))(readFieldsNil)()())()())()())()())()()));var map14=map(functorAff);var liftEffect5=liftEffect(monadEffectAff);var saveState=function(model){return function __do2(){var w=windowImpl();var s=localStorage(w)();var json=writeJSON2(model);setItem("magiitems-tools-diceroller")(json)(s)();return model}};var loadState=function(model){return function __do2(){var w=windowImpl();var s=localStorage(w)();var item=getItem("magiitems-tools-diceroller")(s)();if(item instanceof Nothing){return model}if(item instanceof Just){var v=readJSON2(item.value0);if(v instanceof Left){return model}if(v instanceof Right){return v.value0}throw new Error("Failed pattern match at StateManagement (line 38, column 18 - line 40, column 35): "+[v.constructor.name])}throw new Error("Failed pattern match at StateManagement (line 36, column 3 - line 40, column 35): "+[item.constructor.name])}};var clearState=function __do(){var w=windowImpl();var s=localStorage(w)();removeItem("magiitems-tools-diceroller")(s)();return initModel};var updateState=function(v){return function(v1){if(v1 instanceof SSave){return new Tuple(v,[map14((function($302){return Just.create(StateSaved.create($302))}))(liftEffect5(saveState(v)))])}if(v1 instanceof SLoad){return new Tuple(v,[map14((function($303){return Just.create(StateLoaded.create($303))}))(liftEffect5(loadState(v)))])}if(v1 instanceof SClear){return new Tuple(v,[map14((function($304){return Just.create(StateLoaded.create($304))}))(liftEffect5(clearState))])}throw new Error("Failed pattern match at StateManagement (line 18, column 1 - line 18, column 82): "+[v.constructor.name,v1.constructor.name])}};var pure8=pure(applicativeAff);var toNodeArray5=toNodeArray(toNodeNodeDataNodeData);var toNodeArray14=toNodeArray(toNodeHtmlHtml);var main2=main(toNodeArray5)(toNodeArray14);var class$prime5=class$prime(toClassListString);var div7=div3(toNodeArray5);var div1=div7(toNodeArray14);var header2=header(toNodeArray5)(toNodeArray14);var nav3=nav(toNodeArray5)(toNodeArray14);var h63=h6(toNodeArray5)(toNodeArray14);var a2=a(toNodeArray5)(toNodeArray14);var div22=div7(toNodeArray(toNodeArray14));var map15=map(functorArray);var update=function(v){return function(v1){if(v1 instanceof Save){return updateSave(v)(v1.value0)}if(v1 instanceof Attack){return updateAttack(v)(v1.value0)}if(v1 instanceof State){return updateState(v)(v1.value0)}if(v1 instanceof StateSaved){return new Tuple(v,[])}if(v1 instanceof ChangeTab){return new Tuple({attackRolls:v.attackRolls,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,currentTab:v1.value0},[pure8(new Just(new State(SSave.value)))])}if(v1 instanceof StateLoaded){return new Tuple(v1.value0,[])}throw new Error("Failed pattern match at ToolsApp (line 25, column 1 - line 25, column 70): "+[v.constructor.name,v1.constructor.name])}};var tabClass=function(model){return function(tab){var $32=model.currentTab===tab;if($32){return"active"}return"inactive"}};var view=function(model){return main2([class$prime5("responsive small")])([div1([class$prime5("grid")])([header2([class$prime5("fill small round bottom-shadow top-shadow s12")])([nav3([class$prime5("small")])([div1([class$prime5("max small")])([h63([class$prime5("max white-text left-align small")])([text("Clear saved state")])]),mkButton(new State(SClear.value))("delete")("Clear saved state")])]),div1([class$prime5("s12")])([div1([class$prime5("tabs")])([a2([class$prime5(tabClass(model)("Attack")),onClick(new ChangeTab("Attack"))])([text("Attack Rolls")]),a2([class$prime5(tabClass(model)("Save")),onClick(new ChangeTab("Save"))])([text("Saving Throws")])]),div1([class$prime5("page padding "+tabClass(model)("Attack"))])([div1([class$prime5("small s6")])([header2([class$prime5("fill small round bottom-shadow top-shadow")])([nav3([class$prime5("small")])([div1([class$prime5("max small")])([h63([class$prime5("max white-text left-align small")])([text("Attack Rolls")])]),mkButton(new Attack(AAdd.value))("add")("Add Attack Roll")])]),div22([class$prime5("small")])([map15(viewAttackRoll)(model.attackRolls)])])]),div1([class$prime5("page padding "+tabClass(model)("Save"))])([div1([class$prime5("small s6")])([header2([class$prime5("fill small round bottom-shadow top-shadow")])([nav3([class$prime5("small")])([div1([class$prime5("max small")])([h63([class$prime5("max white-text left-align small")])([text("Saving Throws")])]),mkButton(new Save(Add.value))("add")("Add Saving Throw")])]),div22([class$prime5("small")])([map15(viewSavingThrow)(model.savingThrows)])])])])])])};var init3=function(){return new Tuple(initModel,[pure8(new Just(new State(SLoad.value)))])}();var main3=mount_("body")({init:init3,subscribe:[],update:update,view:view});main3()})();
