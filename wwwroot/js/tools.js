(()=>{var arrayApply=function(fs){return function(xs){var l=fs.length;var k=xs.length;var result=new Array(l*k);var n=0;for(var i3=0;i3<l;i3++){var f=fs[i3];for(var j=0;j<k;j++){result[n++]=f(xs[j])}}return result}};var semigroupoidFn={compose:function(f){return function(g){return function(x){return f(g(x))}}}};var compose=function(dict){return dict.compose};var identity=function(dict){return dict.identity};var categoryFn={identity:function(x){return x},Semigroupoid0:function(){return semigroupoidFn}};var otherwise=true;var flip=function(f){return function(b){return function(a3){return f(a3)(b)}}};var $$const=function(a3){return function(v){return a3}};var arrayMap=function(f){return function(arr){var l=arr.length;var result=new Array(l);for(var i3=0;i3<l;i3++){result[i3]=f(arr[i3])}return result}};var unit=void 0;var $$Proxy=function(){function $$Proxy2(){}$$Proxy2.value=new $$Proxy2;return $$Proxy2}();var map=function(dict){return dict.map};var mapFlipped=function(dictFunctor){var map110=map(dictFunctor);return function(fa){return function(f){return map110(f)(fa)}}};var $$void=function(dictFunctor){return map(dictFunctor)($$const(unit))};var voidLeft=function(dictFunctor){var map110=map(dictFunctor);return function(f){return function(x){return map110($$const(x))(f)}}};var functorArray={map:arrayMap};var identity2=identity(categoryFn);var applyArray={apply:arrayApply,Functor0:function(){return functorArray}};var apply=function(dict){return dict.apply};var applyFirst=function(dictApply){var apply1=apply(dictApply);var map21=map(dictApply.Functor0());return function(a3){return function(b){return apply1(map21($$const)(a3))(b)}}};var applySecond=function(dictApply){var apply1=apply(dictApply);var map21=map(dictApply.Functor0());return function(a3){return function(b){return apply1(map21($$const(identity2))(a3))(b)}}};var pure=function(dict){return dict.pure};var when=function(dictApplicative){var pure13=pure(dictApplicative);return function(v){return function(v1){if(v){return v1}if(!v){return pure13(unit)}throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[v.constructor.name,v1.constructor.name])}}};var liftA1=function(dictApplicative){var apply3=apply(dictApplicative.Apply0());var pure13=pure(dictApplicative);return function(f){return function(a3){return apply3(pure13(f))(a3)}}};var concatString=function(s1){return function(s2){return s1+s2}};var concatArray=function(xs){return function(ys){if(xs.length===0)return ys;if(ys.length===0)return xs;return xs.concat(ys)}};var reflectSymbol=function(dict){return dict.reflectSymbol};var unsafeGet=function(label6){return function(rec){return rec[label6]}};var semigroupString={append:concatString};var semigroupArray={append:concatArray};var append=function(dict){return dict.append};var alt=function(dict){return dict.alt};var topInt=2147483647;var bottomInt=-2147483648;var topChar=String.fromCharCode(65535);var bottomChar=String.fromCharCode(0);var topNumber=Number.POSITIVE_INFINITY;var bottomNumber=Number.NEGATIVE_INFINITY;var unsafeCompareImpl=function(lt){return function(eq3){return function(gt){return function(x){return function(y){return x<y?lt:x===y?eq3:gt}}}}};var ordIntImpl=unsafeCompareImpl;var ordCharImpl=unsafeCompareImpl;var refEq=function(r1){return function(r2){return r1===r2}};var eqBooleanImpl=refEq;var eqIntImpl=refEq;var eqCharImpl=refEq;var eqStringImpl=refEq;var eqArrayImpl=function(f){return function(xs){return function(ys){if(xs.length!==ys.length)return false;for(var i3=0;i3<xs.length;i3++){if(!f(xs[i3])(ys[i3]))return false}return true}}};var eqString={eq:eqStringImpl};var eqRowNil={eqRecord:function(v){return function(v1){return function(v2){return true}}}};var eqRecord=function(dict){return dict.eqRecord};var eqRec=function(){return function(dictEqRecord){return{eq:eqRecord(dictEqRecord)($$Proxy.value)}}};var eqInt={eq:eqIntImpl};var eqChar={eq:eqCharImpl};var eqBoolean={eq:eqBooleanImpl};var eq=function(dict){return dict.eq};var eqArray=function(dictEq){return{eq:eqArrayImpl(eq(dictEq))}};var eqRowCons=function(dictEqRecord){var eqRecord1=eqRecord(dictEqRecord);return function(){return function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(dictEq){var eq3=eq(dictEq);return{eqRecord:function(v){return function(ra){return function(rb){var tail2=eqRecord1($$Proxy.value)(ra)(rb);var key2=reflectSymbol2($$Proxy.value);var get3=unsafeGet(key2);return eq3(get3(ra))(get3(rb))&&tail2}}}}}}}};var LT=function(){function LT2(){}LT2.value=new LT2;return LT2}();var GT=function(){function GT2(){}GT2.value=new GT2;return GT2}();var EQ=function(){function EQ2(){}EQ2.value=new EQ2;return EQ2}();var intSub=function(x){return function(y){return x-y|0}};var intAdd=function(x){return function(y){return x+y|0}};var intMul=function(x){return function(y){return x*y|0}};var zero=function(dict){return dict.zero};var semiringInt={add:intAdd,zero:0,mul:intMul,one:1};var add=function(dict){return dict.add};var sub=function(dict){return dict.sub};var ringInt={sub:intSub,Semiring0:function(){return semiringInt}};var negate=function(dictRing){var sub1=sub(dictRing);var zero2=zero(dictRing.Semiring0());return function(a3){return sub1(zero2)(a3)}};var ordInt=function(){return{compare:ordIntImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqInt}}}();var ordChar=function(){return{compare:ordCharImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqChar}}}();var compare=function(dict){return dict.compare};var greaterThanOrEq=function(dictOrd){var compare3=compare(dictOrd);return function(a1){return function(a22){var v=compare3(a1)(a22);if(v instanceof LT){return false}return true}}};var max=function(dictOrd){var compare3=compare(dictOrd);return function(x){return function(y){var v=compare3(x)(y);if(v instanceof LT){return y}if(v instanceof EQ){return x}if(v instanceof GT){return x}throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[v.constructor.name])}}};var min=function(dictOrd){var compare3=compare(dictOrd);return function(x){return function(y){var v=compare3(x)(y);if(v instanceof LT){return x}if(v instanceof EQ){return x}if(v instanceof GT){return y}throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[v.constructor.name])}}};var abs=function(dictOrd){var greaterThanOrEq1=greaterThanOrEq(dictOrd);return function(dictRing){var zero2=zero(dictRing.Semiring0());var negate1=negate(dictRing);return function(x){var $99=greaterThanOrEq1(x)(zero2);if($99){return x}return negate1(x)}}};var top=function(dict){return dict.top};var boundedInt={top:topInt,bottom:bottomInt,Ord0:function(){return ordInt}};var boundedChar={top:topChar,bottom:bottomChar,Ord0:function(){return ordChar}};var bottom=function(dict){return dict.bottom};var showIntImpl=function(n){return n.toString()};var showCharImpl=function(c){var code=c.charCodeAt(0);if(code<32||code===127){switch(c){case"":return"'\\a'";case"\b":return"'\\b'";case"\f":return"'\\f'";case"\n":return"'\\n'";case"\r":return"'\\r'";case"\t":return"'\\t'";case"\v":return"'\\v'"}return"'\\"+code.toString(10)+"'"}return c==="'"||c==="\\"?"'\\"+c+"'":"'"+c+"'"};var showStringImpl=function(s){var l=s.length;return'"'+s.replace(/[\0-\x1F\x7F"\\]/g,(function(c,i3){switch(c){case'"':case"\\":return"\\"+c;case"":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v"}var k=i3+1;var empty5=k<l&&s[k]>="0"&&s[k]<="9"?"\\&":"";return"\\"+c.charCodeAt(0).toString(10)+empty5}))+'"'};var showArrayImpl=function(f){return function(xs){var ss=[];for(var i3=0,l=xs.length;i3<l;i3++){ss[i3]=f(xs[i3])}return"["+ss.join(",")+"]"}};var showUnit={show:function(v){return"unit"}};var showString={show:showStringImpl};var showInt={show:showIntImpl};var showChar={show:showCharImpl};var show=function(dict){return dict.show};var showArray=function(dictShow){return{show:showArrayImpl(show(dictShow))}};var identity3=identity(categoryFn);var Nothing=function(){function Nothing2(){}Nothing2.value=new Nothing2;return Nothing2}();var Just=function(){function Just2(value0){this.value0=value0}Just2.create=function(value0){return new Just2(value0)};return Just2}();var maybe=function(v){return function(v1){return function(v2){if(v2 instanceof Nothing){return v}if(v2 instanceof Just){return v1(v2.value0)}throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}};var isNothing=maybe(true)($$const(false));var functorMaybe={map:function(v){return function(v1){if(v1 instanceof Just){return new Just(v(v1.value0))}return Nothing.value}}};var fromMaybe=function(a3){return maybe(a3)(identity3)};var fromJust=function(){return function(v){if(v instanceof Just){return v.value0}throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[v.constructor.name])}};var eqMaybe=function(dictEq){var eq3=eq(dictEq);return{eq:function(x){return function(y){if(x instanceof Nothing&&y instanceof Nothing){return true}if(x instanceof Just&&y instanceof Just){return eq3(x.value0)(y.value0)}return false}}}};var Left=function(){function Left2(value0){this.value0=value0}Left2.create=function(value0){return new Left2(value0)};return Left2}();var Right=function(){function Right2(value0){this.value0=value0}Right2.create=function(value0){return new Right2(value0)};return Right2}();var functorEither={map:function(f){return function(m){if(m instanceof Left){return new Left(m.value0)}if(m instanceof Right){return new Right(f(m.value0))}throw new Error("Failed pattern match at Data.Either (line 0, column 0 - line 0, column 0): "+[m.constructor.name])}}};var map2=map(functorEither);var either=function(v){return function(v1){return function(v2){if(v2 instanceof Left){return v(v2.value0)}if(v2 instanceof Right){return v1(v2.value0)}throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}};var applyEither={apply:function(v){return function(v1){if(v instanceof Left){return new Left(v.value0)}if(v instanceof Right){return map2(v.value0)(v1)}throw new Error("Failed pattern match at Data.Either (line 70, column 1 - line 72, column 30): "+[v.constructor.name,v1.constructor.name])}},Functor0:function(){return functorEither}};var applicativeEither=function(){return{pure:Right.create,Apply0:function(){return applyEither}}}();var foldrArray=function(f){return function(init4){return function(xs){var acc=init4;var len=xs.length;for(var i3=len-1;i3>=0;i3--){acc=f(xs[i3])(acc)}return acc}}};var foldlArray=function(f){return function(init4){return function(xs){var acc=init4;var len=xs.length;for(var i3=0;i3<len;i3++){acc=f(acc)(xs[i3])}return acc}}};var arrayBind=typeof Array.prototype.flatMap==="function"?function(arr){return function(f){return arr.flatMap(f)}}:function(arr){return function(f){var result=[];var l=arr.length;for(var i3=0;i3<l;i3++){var xs=f(arr[i3]);var k=xs.length;for(var j=0;j<k;j++){result.push(xs[j])}}return result}};var bindArray={bind:arrayBind,Apply0:function(){return applyArray}};var bind=function(dict){return dict.bind};var bindFlipped=function(dictBind){return flip(bind(dictBind))};var composeKleisliFlipped=function(dictBind){var bindFlipped1=bindFlipped(dictBind);return function(f){return function(g){return function(a3){return bindFlipped1(f)(g(a3))}}}};var empty=function(dict){return dict.empty};var defer=function(dict){return dict.defer};var boolConj=function(b1){return function(b2){return b1&&b2}};var boolDisj=function(b1){return function(b2){return b1||b2}};var boolNot=function(b){return!b};var not=function(dict){return dict.not};var disj=function(dict){return dict.disj};var heytingAlgebraBoolean={ff:false,tt:true,implies:function(a3){return function(b){return disj(heytingAlgebraBoolean)(not(heytingAlgebraBoolean)(a3))(b)}},conj:boolConj,disj:boolDisj,not:boolNot};var intDegree=function(x){return Math.min(Math.abs(x),2147483647)};var intDiv=function(x){return function(y){if(y===0)return 0;return y>0?Math.floor(x/y):-Math.floor(x/-y)}};var intMod=function(x){return function(y){if(y===0)return 0;var yy=Math.abs(y);return(x%yy+yy)%yy}};var commutativeRingInt={Ring0:function(){return ringInt}};var mod=function(dict){return dict.mod};var euclideanRingInt={degree:intDegree,div:intDiv,mod:intMod,CommutativeRing0:function(){return commutativeRingInt}};var div=function(dict){return dict.div};var monoidString={mempty:"",Semigroup0:function(){return semigroupString}};var mempty=function(dict){return dict.mempty};var Tuple=function(){function Tuple2(value0,value1){this.value0=value0;this.value1=value1}Tuple2.create=function(value0){return function(value1){return new Tuple2(value0,value1)}};return Tuple2}();var snd=function(v){return v.value1};var fst=function(v){return v.value0};var identity4=identity(categoryFn);var bimap=function(dict){return dict.bimap};var lmap=function(dictBifunctor){var bimap1=bimap(dictBifunctor);return function(f){return bimap1(f)(identity4)}};var bifunctorEither={bimap:function(v){return function(v1){return function(v2){if(v2 instanceof Left){return new Left(v(v2.value0))}if(v2 instanceof Right){return new Right(v1(v2.value0))}throw new Error("Failed pattern match at Data.Bifunctor (line 32, column 1 - line 34, column 36): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}}};var unsafeCoerce2=function(x){return x};var coerce=function(){return unsafeCoerce2};var coerce2=coerce();var unwrap=function(){return coerce2};var foldr=function(dict){return dict.foldr};var traverse_=function(dictApplicative){var applySecond2=applySecond(dictApplicative.Apply0());var pure10=pure(dictApplicative);return function(dictFoldable){var foldr22=foldr(dictFoldable);return function(f){return foldr22((function($454){return applySecond2(f($454))}))(pure10(unit))}}};var for_=function(dictApplicative){var traverse_1=traverse_(dictApplicative);return function(dictFoldable){return flip(traverse_1(dictFoldable))}};var foldl=function(dict){return dict.foldl};var intercalate=function(dictFoldable){var foldl2=foldl(dictFoldable);return function(dictMonoid){var append3=append(dictMonoid.Semigroup0());var mempty2=mempty(dictMonoid);return function(sep){return function(xs){var go2=function(v){return function(v1){if(v.init){return{init:false,acc:v1}}return{init:false,acc:append3(v.acc)(append3(sep)(v1))}}};return foldl2(go2)({init:true,acc:mempty2})(xs).acc}}}};var foldMapDefaultR=function(dictFoldable){var foldr22=foldr(dictFoldable);return function(dictMonoid){var append3=append(dictMonoid.Semigroup0());var mempty2=mempty(dictMonoid);return function(f){return foldr22((function(x){return function(acc){return append3(f(x))(acc)}}))(mempty2)}}};var foldableArray={foldr:foldrArray,foldl:foldlArray,foldMap:function(dictMonoid){return foldMapDefaultR(foldableArray)(dictMonoid)}};var foldMap=function(dict){return dict.foldMap};var pureE=function(a3){return function(){return a3}};var bindE=function(a3){return function(f){return function(){return f(a3())()}}};var ap=function(dictMonad){var bind3=bind(dictMonad.Bind1());var pure10=pure(dictMonad.Applicative0());return function(f){return function(a3){return bind3(f)((function(f$prime){return bind3(a3)((function(a$prime){return pure10(f$prime(a$prime))}))}))}}};var $runtime_lazy=function(name15,moduleName,init4){var state3=0;var val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init4();state3=2;return val}};var monadEffect={Applicative0:function(){return applicativeEffect},Bind1:function(){return bindEffect}};var bindEffect={bind:bindE,Apply0:function(){return $lazy_applyEffect(0)}};var applicativeEffect={pure:pureE,Apply0:function(){return $lazy_applyEffect(0)}};var $lazy_functorEffect=$runtime_lazy("functorEffect","Effect",(function(){return{map:liftA1(applicativeEffect)}}));var $lazy_applyEffect=$runtime_lazy("applyEffect","Effect",(function(){return{apply:ap(monadEffect),Functor0:function(){return $lazy_functorEffect(0)}}}));var functorEffect=$lazy_functorEffect(20);var Aff=function(){var EMPTY={};var PURE="Pure";var THROW="Throw";var CATCH="Catch";var SYNC="Sync";var ASYNC="Async";var BIND="Bind";var BRACKET="Bracket";var FORK="Fork";var SEQ="Sequential";var MAP="Map";var APPLY="Apply";var ALT="Alt";var CONS="Cons";var RESUME="Resume";var RELEASE="Release";var FINALIZER="Finalizer";var FINALIZED="Finalized";var FORKED="Forked";var FIBER="Fiber";var THUNK="Thunk";function Aff2(tag,_1,_2,_3){this.tag=tag;this._1=_1;this._2=_2;this._3=_3}function AffCtr(tag){var fn=function(_1,_2,_3){return new Aff2(tag,_1,_2,_3)};fn.tag=tag;return fn}function nonCanceler(error3){return new Aff2(PURE,void 0)}function runEff(eff){try{eff()}catch(error3){setTimeout((function(){throw error3}),0)}}function runSync(left,right,eff){try{return right(eff())}catch(error3){return left(error3)}}function runAsync(left,eff,k){try{return eff(k)()}catch(error3){k(left(error3))();return nonCanceler}}var Scheduler=function(){var limit=1024;var size5=0;var ix=0;var queue=new Array(limit);var draining=false;function drain(){var thunk;draining=true;while(size5!==0){size5--;thunk=queue[ix];queue[ix]=void 0;ix=(ix+1)%limit;thunk()}draining=false}return{isDraining:function(){return draining},enqueue:function(cb){var i3,tmp;if(size5===limit){tmp=draining;drain();draining=tmp}queue[(ix+size5)%limit]=cb;size5++;if(!draining){drain()}}}}();function Supervisor(util){var fibers={};var fiberId=0;var count=0;return{register:function(fiber){var fid=fiberId++;fiber.onComplete({rethrow:true,handler:function(result){return function(){count--;delete fibers[fid]}}})();fibers[fid]=fiber;count++},isEmpty:function(){return count===0},killAll:function(killError,cb){return function(){if(count===0){return cb()}var killCount=0;var kills={};function kill(fid){kills[fid]=fibers[fid].kill(killError,(function(result){return function(){delete kills[fid];killCount--;if(util.isLeft(result)&&util.fromLeft(result)){setTimeout((function(){throw util.fromLeft(result)}),0)}if(killCount===0){cb()}}}))()}for(var k in fibers){if(fibers.hasOwnProperty(k)){killCount++;kill(k)}}fibers={};fiberId=0;count=0;return function(error3){return new Aff2(SYNC,(function(){for(var k2 in kills){if(kills.hasOwnProperty(k2)){kills[k2]()}}}))}}}}}var SUSPENDED=0;var CONTINUE=1;var STEP_BIND=2;var STEP_RESULT=3;var PENDING=4;var RETURN=5;var COMPLETED=6;function Fiber(util,supervisor,aff){var runTick=0;var status=SUSPENDED;var step3=aff;var fail3=null;var interrupt=null;var bhead=null;var btail=null;var attempts=null;var bracketCount=0;var joinId=0;var joins=null;var rethrow=true;function run4(localRunTick){var tmp,result,attempt;while(true){tmp=null;result=null;attempt=null;switch(status){case STEP_BIND:status=CONTINUE;try{step3=bhead(step3);if(btail===null){bhead=null}else{bhead=btail._1;btail=btail._2}}catch(e){status=RETURN;fail3=util.left(e);step3=null}break;case STEP_RESULT:if(util.isLeft(step3)){status=RETURN;fail3=step3;step3=null}else if(bhead===null){status=RETURN}else{status=STEP_BIND;step3=util.fromRight(step3)}break;case CONTINUE:switch(step3.tag){case BIND:if(bhead){btail=new Aff2(CONS,bhead,btail)}bhead=step3._2;status=CONTINUE;step3=step3._1;break;case PURE:if(bhead===null){status=RETURN;step3=util.right(step3._1)}else{status=STEP_BIND;step3=step3._1}break;case SYNC:status=STEP_RESULT;step3=runSync(util.left,util.right,step3._1);break;case ASYNC:status=PENDING;step3=runAsync(util.left,step3._1,(function(result2){return function(){if(runTick!==localRunTick){return}runTick++;Scheduler.enqueue((function(){if(runTick!==localRunTick+1){return}status=STEP_RESULT;step3=result2;run4(runTick)}))}}));return;case THROW:status=RETURN;fail3=util.left(step3._1);step3=null;break;case CATCH:if(bhead===null){attempts=new Aff2(CONS,step3,attempts,interrupt)}else{attempts=new Aff2(CONS,step3,new Aff2(CONS,new Aff2(RESUME,bhead,btail),attempts,interrupt),interrupt)}bhead=null;btail=null;status=CONTINUE;step3=step3._1;break;case BRACKET:bracketCount++;if(bhead===null){attempts=new Aff2(CONS,step3,attempts,interrupt)}else{attempts=new Aff2(CONS,step3,new Aff2(CONS,new Aff2(RESUME,bhead,btail),attempts,interrupt),interrupt)}bhead=null;btail=null;status=CONTINUE;step3=step3._1;break;case FORK:status=STEP_RESULT;tmp=Fiber(util,supervisor,step3._2);if(supervisor){supervisor.register(tmp)}if(step3._1){tmp.run()}step3=util.right(tmp);break;case SEQ:status=CONTINUE;step3=sequential2(util,supervisor,step3._1);break}break;case RETURN:bhead=null;btail=null;if(attempts===null){status=COMPLETED;step3=interrupt||fail3||step3}else{tmp=attempts._3;attempt=attempts._1;attempts=attempts._2;switch(attempt.tag){case CATCH:if(interrupt&&interrupt!==tmp&&bracketCount===0){status=RETURN}else if(fail3){status=CONTINUE;step3=attempt._2(util.fromLeft(fail3));fail3=null}break;case RESUME:if(interrupt&&interrupt!==tmp&&bracketCount===0||fail3){status=RETURN}else{bhead=attempt._1;btail=attempt._2;status=STEP_BIND;step3=util.fromRight(step3)}break;case BRACKET:bracketCount--;if(fail3===null){result=util.fromRight(step3);attempts=new Aff2(CONS,new Aff2(RELEASE,attempt._2,result),attempts,tmp);if(interrupt===tmp||bracketCount>0){status=CONTINUE;step3=attempt._3(result)}}break;case RELEASE:attempts=new Aff2(CONS,new Aff2(FINALIZED,step3,fail3),attempts,interrupt);status=CONTINUE;if(interrupt&&interrupt!==tmp&&bracketCount===0){step3=attempt._1.killed(util.fromLeft(interrupt))(attempt._2)}else if(fail3){step3=attempt._1.failed(util.fromLeft(fail3))(attempt._2)}else{step3=attempt._1.completed(util.fromRight(step3))(attempt._2)}fail3=null;bracketCount++;break;case FINALIZER:bracketCount++;attempts=new Aff2(CONS,new Aff2(FINALIZED,step3,fail3),attempts,interrupt);status=CONTINUE;step3=attempt._1;break;case FINALIZED:bracketCount--;status=RETURN;step3=attempt._1;fail3=attempt._2;break}}break;case COMPLETED:for(var k in joins){if(joins.hasOwnProperty(k)){rethrow=rethrow&&joins[k].rethrow;runEff(joins[k].handler(step3))}}joins=null;if(interrupt&&fail3){setTimeout((function(){throw util.fromLeft(fail3)}),0)}else if(util.isLeft(step3)&&rethrow){setTimeout((function(){if(rethrow){throw util.fromLeft(step3)}}),0)}return;case SUSPENDED:status=CONTINUE;break;case PENDING:return}}}function onComplete(join3){return function(){if(status===COMPLETED){rethrow=rethrow&&join3.rethrow;join3.handler(step3)();return function(){}}var jid=joinId++;joins=joins||{};joins[jid]=join3;return function(){if(joins!==null){delete joins[jid]}}}}function kill(error3,cb){return function(){if(status===COMPLETED){cb(util.right(void 0))();return function(){}}var canceler=onComplete({rethrow:false,handler:function(){return cb(util.right(void 0))}})();switch(status){case SUSPENDED:interrupt=util.left(error3);status=COMPLETED;step3=interrupt;run4(runTick);break;case PENDING:if(interrupt===null){interrupt=util.left(error3)}if(bracketCount===0){if(status===PENDING){attempts=new Aff2(CONS,new Aff2(FINALIZER,step3(error3)),attempts,interrupt)}status=RETURN;step3=null;fail3=null;run4(++runTick)}break;default:if(interrupt===null){interrupt=util.left(error3)}if(bracketCount===0){status=RETURN;step3=null;fail3=null}}return canceler}}function join2(cb){return function(){var canceler=onComplete({rethrow:false,handler:cb})();if(status===SUSPENDED){run4(runTick)}return canceler}}return{kill:kill,join:join2,onComplete:onComplete,isSuspended:function(){return status===SUSPENDED},run:function(){if(status===SUSPENDED){if(!Scheduler.isDraining()){Scheduler.enqueue((function(){run4(runTick)}))}else{run4(runTick)}}}}}function runPar(util,supervisor,par,cb){var fiberId=0;var fibers={};var killId=0;var kills={};var early=new Error("[ParAff] Early exit");var interrupt=null;var root=EMPTY;function kill(error3,par2,cb2){var step3=par2;var head4=null;var tail2=null;var count=0;var kills2={};var tmp,kid;loop:while(true){tmp=null;switch(step3.tag){case FORKED:if(step3._3===EMPTY){tmp=fibers[step3._1];kills2[count++]=tmp.kill(error3,(function(result){return function(){count--;if(count===0){cb2(result)()}}}))}if(head4===null){break loop}step3=head4._2;if(tail2===null){head4=null}else{head4=tail2._1;tail2=tail2._2}break;case MAP:step3=step3._2;break;case APPLY:case ALT:if(head4){tail2=new Aff2(CONS,head4,tail2)}head4=step3;step3=step3._1;break}}if(count===0){cb2(util.right(void 0))()}else{kid=0;tmp=count;for(;kid<tmp;kid++){kills2[kid]=kills2[kid]()}}return kills2}function join2(result,head4,tail2){var fail3,step3,lhs,rhs,tmp,kid;if(util.isLeft(result)){fail3=result;step3=null}else{step3=result;fail3=null}loop:while(true){lhs=null;rhs=null;tmp=null;kid=null;if(interrupt!==null){return}if(head4===null){cb(fail3||step3)();return}if(head4._3!==EMPTY){return}switch(head4.tag){case MAP:if(fail3===null){head4._3=util.right(head4._1(util.fromRight(step3)));step3=head4._3}else{head4._3=fail3}break;case APPLY:lhs=head4._1._3;rhs=head4._2._3;if(fail3){head4._3=fail3;tmp=true;kid=killId++;kills[kid]=kill(early,fail3===lhs?head4._2:head4._1,(function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail2===null){join2(fail3,null,null)}else{join2(fail3,tail2._1,tail2._2)}}}));if(tmp){tmp=false;return}}else if(lhs===EMPTY||rhs===EMPTY){return}else{step3=util.right(util.fromRight(lhs)(util.fromRight(rhs)));head4._3=step3}break;case ALT:lhs=head4._1._3;rhs=head4._2._3;if(lhs===EMPTY&&util.isLeft(rhs)||rhs===EMPTY&&util.isLeft(lhs)){return}if(lhs!==EMPTY&&util.isLeft(lhs)&&rhs!==EMPTY&&util.isLeft(rhs)){fail3=step3===lhs?rhs:lhs;step3=null;head4._3=fail3}else{head4._3=step3;tmp=true;kid=killId++;kills[kid]=kill(early,step3===lhs?head4._2:head4._1,(function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail2===null){join2(step3,null,null)}else{join2(step3,tail2._1,tail2._2)}}}));if(tmp){tmp=false;return}}break}if(tail2===null){head4=null}else{head4=tail2._1;tail2=tail2._2}}}function resolve(fiber){return function(result){return function(){delete fibers[fiber._1];fiber._3=result;join2(result,fiber._2._1,fiber._2._2)}}}function run4(){var status=CONTINUE;var step3=par;var head4=null;var tail2=null;var tmp,fid;loop:while(true){tmp=null;fid=null;switch(status){case CONTINUE:switch(step3.tag){case MAP:if(head4){tail2=new Aff2(CONS,head4,tail2)}head4=new Aff2(MAP,step3._1,EMPTY,EMPTY);step3=step3._2;break;case APPLY:if(head4){tail2=new Aff2(CONS,head4,tail2)}head4=new Aff2(APPLY,EMPTY,step3._2,EMPTY);step3=step3._1;break;case ALT:if(head4){tail2=new Aff2(CONS,head4,tail2)}head4=new Aff2(ALT,EMPTY,step3._2,EMPTY);step3=step3._1;break;default:fid=fiberId++;status=RETURN;tmp=step3;step3=new Aff2(FORKED,fid,new Aff2(CONS,head4,tail2),EMPTY);tmp=Fiber(util,supervisor,tmp);tmp.onComplete({rethrow:false,handler:resolve(step3)})();fibers[fid]=tmp;if(supervisor){supervisor.register(tmp)}}break;case RETURN:if(head4===null){break loop}if(head4._1===EMPTY){head4._1=step3;status=CONTINUE;step3=head4._2;head4._2=EMPTY}else{head4._2=step3;step3=head4;if(tail2===null){head4=null}else{head4=tail2._1;tail2=tail2._2}}}}root=step3;for(fid=0;fid<fiberId;fid++){fibers[fid].run()}}function cancel(error3,cb2){interrupt=util.left(error3);var innerKills;for(var kid in kills){if(kills.hasOwnProperty(kid)){innerKills=kills[kid];for(kid in innerKills){if(innerKills.hasOwnProperty(kid)){innerKills[kid]()}}}}kills=null;var newKills=kill(error3,root,cb2);return function(killError){return new Aff2(ASYNC,(function(killCb){return function(){for(var kid2 in newKills){if(newKills.hasOwnProperty(kid2)){newKills[kid2]()}}return nonCanceler}}))}}run4();return function(killError){return new Aff2(ASYNC,(function(killCb){return function(){return cancel(killError,killCb)}}))}}function sequential2(util,supervisor,par){return new Aff2(ASYNC,(function(cb){return function(){return runPar(util,supervisor,par,cb)}}))}Aff2.EMPTY=EMPTY;Aff2.Pure=AffCtr(PURE);Aff2.Throw=AffCtr(THROW);Aff2.Catch=AffCtr(CATCH);Aff2.Sync=AffCtr(SYNC);Aff2.Async=AffCtr(ASYNC);Aff2.Bind=AffCtr(BIND);Aff2.Bracket=AffCtr(BRACKET);Aff2.Fork=AffCtr(FORK);Aff2.Seq=AffCtr(SEQ);Aff2.ParMap=AffCtr(MAP);Aff2.ParApply=AffCtr(APPLY);Aff2.ParAlt=AffCtr(ALT);Aff2.Fiber=Fiber;Aff2.Supervisor=Supervisor;Aff2.Scheduler=Scheduler;Aff2.nonCanceler=nonCanceler;return Aff2}();var _pure=Aff.Pure;var _throwError=Aff.Throw;function _catchError(aff){return function(k){return Aff.Catch(aff,k)}}function _map(f){return function(aff){if(aff.tag===Aff.Pure.tag){return Aff.Pure(f(aff._1))}else{return Aff.Bind(aff,(function(value13){return Aff.Pure(f(value13))}))}}}function _bind(aff){return function(k){return Aff.Bind(aff,k)}}var _liftEffect=Aff.Sync;var makeAff=Aff.Async;function _makeFiber(util,aff){return function(){return Aff.Fiber(util,null,aff)}}var _delay=function(){function setDelay(n,k){if(n===0&&typeof setImmediate!=="undefined"){return setImmediate(k)}else{return setTimeout(k,n)}}function clearDelay(n,t){if(n===0&&typeof clearImmediate!=="undefined"){return clearImmediate(t)}else{return clearTimeout(t)}}return function(right,ms){return Aff.Async((function(cb){return function(){var timer=setDelay(ms,cb(right()));return function(){return Aff.Sync((function(){return right(clearDelay(ms,timer))}))}}}))}}();var _sequential=Aff.Seq;function error(msg){return new Error(msg)}function message(e){return e.message}function throwException(e){return function(){throw e}}function catchException(c){return function(t){return function(){try{return t()}catch(e){if(e instanceof Error||Object.prototype.toString.call(e)==="[object Error]"){return c(e)()}else{return c(new Error(e.toString()))()}}}}}var pure2=pure(applicativeEffect);var map3=map(functorEffect);var $$try=function(action2){return catchException((function($3){return pure2(Left.create($3))}))(map3(Right.create)(action2))};var $$throw=function($4){return throwException(error($4))};var throwError=function(dict){return dict.throwError};var catchError=function(dict){return dict.catchError};var $$try2=function(dictMonadError){var catchError1=catchError(dictMonadError);var Monad0=dictMonadError.MonadThrow0().Monad0();var map21=map(Monad0.Bind1().Apply0().Functor0());var pure10=pure(Monad0.Applicative0());return function(a3){return catchError1(map21(Right.create)(a3))((function($52){return pure10(Left.create($52))}))}};var Identity=function(x){return x};var functorIdentity={map:function(f){return function(m){return f(m)}}};var applyIdentity={apply:function(v){return function(v1){return v(v1)}},Functor0:function(){return functorIdentity}};var bindIdentity={bind:function(v){return function(f){return f(v)}},Apply0:function(){return applyIdentity}};var applicativeIdentity={pure:Identity,Apply0:function(){return applyIdentity}};var monadIdentity={Applicative0:function(){return applicativeIdentity},Bind1:function(){return bindIdentity}};var _new=function(val){return function(){return{value:val}}};var read=function(ref){return function(){return ref.value}};var write=function(val){return function(ref){return function(){ref.value=val}}};var $$new=_new;var Loop=function(){function Loop2(value0){this.value0=value0}Loop2.create=function(value0){return new Loop2(value0)};return Loop2}();var Done=function(){function Done2(value0){this.value0=value0}Done2.create=function(value0){return new Done2(value0)};return Done2}();var tailRecM=function(dict){return dict.tailRecM};var tailRec=function(f){var go2=function($copy_v){var $tco_done=false;var $tco_result;function $tco_loop(v){if(v instanceof Loop){$copy_v=f(v.value0);return}if(v instanceof Done){$tco_done=true;return v.value0}throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 103, column 3 - line 103, column 25): "+[v.constructor.name])}while(!$tco_done){$tco_result=$tco_loop($copy_v)}return $tco_result};return function($85){return go2(f($85))}};var monadRecIdentity={tailRecM:function(f){var runIdentity=function(v){return v};var $86=tailRec((function($88){return runIdentity(f($88))}));return function($87){return Identity($86($87))}},Monad0:function(){return monadIdentity}};var liftEffect=function(dict){return dict.liftEffect};var map4=map(functorEither);var ExceptT=function(x){return x};var withExceptT=function(dictFunctor){var map110=map(dictFunctor);return function(f){return function(v){var mapLeft=function(v1){return function(v2){if(v2 instanceof Right){return new Right(v2.value0)}if(v2 instanceof Left){return new Left(v1(v2.value0))}throw new Error("Failed pattern match at Control.Monad.Except.Trans (line 43, column 3 - line 43, column 32): "+[v1.constructor.name,v2.constructor.name])}};return map110(mapLeft(f))(v)}}};var runExceptT=function(v){return v};var mapExceptT=function(f){return function(v){return f(v)}};var functorExceptT=function(dictFunctor){var map110=map(dictFunctor);return{map:function(f){return mapExceptT(map110(map4(f)))}}};var monadExceptT=function(dictMonad){return{Applicative0:function(){return applicativeExceptT(dictMonad)},Bind1:function(){return bindExceptT(dictMonad)}}};var bindExceptT=function(dictMonad){var bind3=bind(dictMonad.Bind1());var pure10=pure(dictMonad.Applicative0());return{bind:function(v){return function(k){return bind3(v)(either((function($193){return pure10(Left.create($193))}))((function(a3){var v1=k(a3);return v1})))}},Apply0:function(){return applyExceptT(dictMonad)}}};var applyExceptT=function(dictMonad){var functorExceptT1=functorExceptT(dictMonad.Bind1().Apply0().Functor0());return{apply:ap(monadExceptT(dictMonad)),Functor0:function(){return functorExceptT1}}};var applicativeExceptT=function(dictMonad){return{pure:function(){var $194=pure(dictMonad.Applicative0());return function($195){return ExceptT($194(Right.create($195)))}}(),Apply0:function(){return applyExceptT(dictMonad)}}};var monadThrowExceptT=function(dictMonad){var monadExceptT1=monadExceptT(dictMonad);return{throwError:function(){var $204=pure(dictMonad.Applicative0());return function($205){return ExceptT($204(Left.create($205)))}}(),Monad0:function(){return monadExceptT1}}};var traverseArrayImpl=function(){function array1(a3){return[a3]}function array2(a3){return function(b){return[a3,b]}}function array3(a3){return function(b){return function(c){return[a3,b,c]}}}function concat2(xs){return function(ys){return xs.concat(ys)}}return function(apply3){return function(map21){return function(pure10){return function(f){return function(array){function go2(bot,top3){switch(top3-bot){case 0:return pure10([]);case 1:return map21(array1)(f(array[bot]));case 2:return apply3(map21(array2)(f(array[bot])))(f(array[bot+1]));case 3:return apply3(apply3(map21(array3)(f(array[bot])))(f(array[bot+1])))(f(array[bot+2]));default:var pivot=bot+Math.floor((top3-bot)/4)*2;return apply3(map21(concat2)(go2(bot,pivot)))(go2(pivot,top3))}}return go2(0,array.length)}}}}}}();var identity5=identity(categoryFn);var traverse=function(dict){return dict.traverse};var sequenceDefault=function(dictTraversable){var traverse2=traverse(dictTraversable);return function(dictApplicative){return traverse2(dictApplicative)(identity5)}};var traversableArray={traverse:function(dictApplicative){var Apply0=dictApplicative.Apply0();return traverseArrayImpl(apply(Apply0))(map(Apply0.Functor0()))(pure(dictApplicative))},sequence:function(dictApplicative){return sequenceDefault(traversableArray)(dictApplicative)},Functor0:function(){return functorArray},Foldable1:function(){return foldableArray}};var sequence=function(dict){return dict.sequence};var unsafePerformEffect=function(f){return f()};var _unsafePartial=function(f){return f()};var _crashWith=function(msg){throw new Error(msg)};var crashWith=function(){return _crashWith};var crashWith2=crashWith();var unsafePartial=_unsafePartial;var unsafeCrashWith=function(msg){return unsafePartial((function(){return crashWith2(msg)}))};var $runtime_lazy2=function(name15,moduleName,init4){var state3=0;var val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init4();state3=2;return val}};var $$void2=$$void(functorEffect);var functorAff={map:_map};var ffiUtil=function(){var unsafeFromRight=function(v){if(v instanceof Right){return v.value0}if(v instanceof Left){return unsafeCrashWith("unsafeFromRight: Left")}throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[v.constructor.name])};var unsafeFromLeft=function(v){if(v instanceof Left){return v.value0}if(v instanceof Right){return unsafeCrashWith("unsafeFromLeft: Right")}throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[v.constructor.name])};var isLeft=function(v){if(v instanceof Left){return true}if(v instanceof Right){return false}throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[v.constructor.name])};return{isLeft:isLeft,fromLeft:unsafeFromLeft,fromRight:unsafeFromRight,left:Left.create,right:Right.create}}();var makeFiber=function(aff){return _makeFiber(ffiUtil,aff)};var launchAff=function(aff){return function __do(){var fiber=makeFiber(aff)();fiber.run();return fiber}};var monadAff={Applicative0:function(){return applicativeAff},Bind1:function(){return bindAff}};var bindAff={bind:_bind,Apply0:function(){return $lazy_applyAff(0)}};var applicativeAff={pure:_pure,Apply0:function(){return $lazy_applyAff(0)}};var $lazy_applyAff=$runtime_lazy2("applyAff","Effect.Aff",(function(){return{apply:ap(monadAff),Functor0:function(){return functorAff}}}));var bindFlipped2=bindFlipped(bindAff);var monadEffectAff={liftEffect:_liftEffect,Monad0:function(){return monadAff}};var liftEffect2=liftEffect(monadEffectAff);var monadThrowAff={throwError:_throwError,Monad0:function(){return monadAff}};var monadErrorAff={catchError:_catchError,MonadThrow0:function(){return monadThrowAff}};var $$try3=$$try2(monadErrorAff);var runAff=function(k){return function(aff){return launchAff(bindFlipped2((function($83){return liftEffect2(k($83))}))($$try3(aff)))}};var runAff_=function(k){return function(aff){return $$void2(runAff(k)(aff))}};var log=function(s){return function(){console.log(s)}};function querySelector_(selector){return document.querySelector(selector)}function createWindowListener_(eventName,updater){window.addEventListener(eventName,(function(event){updater(event)()}))}function createDocumentListener_(eventName,updater){document.addEventListener(eventName,(function(event){updater(event)()}))}function createCustomListener_(eventName,updater){document.addEventListener(eventName,(function(event){updater(event.detail)()}))}function nullable(a3,r,f){return a3==null?r:f(a3)}var toMaybe=function(n){return nullable(n,Nothing.value,Just.create)};var runEffectFn1=function runEffectFn12(fn){return function(a3){return function(){return fn(a3)}}};var runEffectFn2=function runEffectFn22(fn){return function(a3){return function(b){return function(){return fn(a3,b)}}}};var runEffectFn4=function runEffectFn42(fn){return function(a3){return function(b){return function(c){return function(d){return function(){return fn(a3,b,c,d)}}}}}};var querySelector=function(selector){return function __do(){var selected2=querySelector_(selector);return toMaybe(selected2)}};var createWindowListener=runEffectFn2(createWindowListener_);var createDocumentListener=runEffectFn2(createDocumentListener_);var createCustomListener=runEffectFn2(createCustomListener_);var regexImpl=function(left){return function(right){return function(s1){return function(s2){try{return right(new RegExp(s1,s2))}catch(e){return left(e.message)}}}}};var _replaceBy=function(just){return function(nothing){return function(r){return function(f){return function(s){return s.replace(r,(function(match2){var groups=[];var group4,i3=1;while(typeof(group4=arguments[i3++])!=="number"){groups.push(group4==null?nothing:just(group4))}return f(match2)(groups)}))}}}}};var fromCharArray=function(a3){return a3.join("")};var toCharArray=function(s){return s.split("")};var singleton=function(c){return c};var length=function(s){return s.length};var drop=function(n){return function(s){return s.substring(n)}};var splitAt=function(i3){return function(s){return{before:s.substring(0,i3),after:s.substring(i3)}}};var charAt=function(i3){return function(s){if(i3>=0&&i3<s.length)return s.charAt(i3);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var stripPrefix=function(v){return function(str){var v1=splitAt(length(v))(str);var $20=v1.before===v;if($20){return new Just(v1.after)}return Nothing.value}};var split=function(sep){return function(s){return s.split(sep)}};var toLower=function(s){return s.toLowerCase()};var toUpper=function(s){return s.toUpperCase()};var $$null=function(s){return s===""};var global={global:true,ignoreCase:false,multiline:false,dotAll:false,sticky:false,unicode:false};var replace$prime=function(){return _replaceBy(Just.create)(Nothing.value)}();var renderFlags=function(v){return function(){if(v.global){return"g"}return""}()+(function(){if(v.ignoreCase){return"i"}return""}()+(function(){if(v.multiline){return"m"}return""}()+(function(){if(v.dotAll){return"s"}return""}()+(function(){if(v.sticky){return"y"}return""}()+function(){if(v.unicode){return"u"}return""}()))))};var regex=function(s){return function(f){return regexImpl(Left.create)(Right.create)(s)(renderFlags(f))}};var classData=2;var propertyData=3;var attributeData=4;function createProperty(name15){return function(value13){return[propertyData,name15,value13]}}function createAttribute(name15){return function(value13){return[attributeData,name15,value13]}}function createClass(array){return[classData,array]}var rangeImpl=function(start3,end){var step3=start3>end?-1:1;var result=new Array(step3*(end-start3)+1);var i3=start3,n=0;while(i3!==end){result[n++]=i3;i3+=step3}result[n]=i3;return result};var replicateFill=function(count,value13){if(count<1){return[]}var result=new Array(count);return result.fill(value13)};var replicatePolyfill=function(count,value13){var result=[];var n=0;for(var i3=0;i3<count;i3++){result[n++]=value13}return result};var replicateImpl=typeof Array.prototype.fill==="function"?replicateFill:replicatePolyfill;var fromFoldableImpl=function(){function Cons3(head4,tail2){this.head=head4;this.tail=tail2}var emptyList={};function curryCons(head4){return function(tail2){return new Cons3(head4,tail2)}}function listToArray(list){var result=[];var count=0;var xs=list;while(xs!==emptyList){result[count++]=xs.head;xs=xs.tail}return result}return function(foldr4,xs){return listToArray(foldr4(curryCons)(emptyList)(xs))}}();var length2=function(xs){return xs.length};var unconsImpl=function(empty5,next,xs){return xs.length===0?empty5({}):next(xs[0])(xs.slice(1))};var findIndexImpl=function(just,nothing,f,xs){for(var i3=0,l=xs.length;i3<l;i3++){if(f(xs[i3]))return just(i3)}return nothing};var _deleteAt=function(just,nothing,i3,l){if(i3<0||i3>=l.length)return nothing;var l1=l.slice();l1.splice(i3,1);return just(l1)};var _updateAt=function(just,nothing,i3,a3,l){if(i3<0||i3>=l.length)return nothing;var l1=l.slice();l1[i3]=a3;return just(l1)};var filterImpl=function(f,xs){return xs.filter(f)};var sortByImpl=function(){function mergeFromTo(compare3,fromOrdering,xs1,xs2,from3,to3){var mid;var i3;var j;var k;var x;var y;var c;mid=from3+(to3-from3>>1);if(mid-from3>1)mergeFromTo(compare3,fromOrdering,xs2,xs1,from3,mid);if(to3-mid>1)mergeFromTo(compare3,fromOrdering,xs2,xs1,mid,to3);i3=from3;j=mid;k=from3;while(i3<mid&&j<to3){x=xs2[i3];y=xs2[j];c=fromOrdering(compare3(x)(y));if(c>0){xs1[k++]=y;++j}else{xs1[k++]=x;++i3}}while(i3<mid){xs1[k++]=xs2[i3++]}while(j<to3){xs1[k++]=xs2[j++]}}return function(compare3,fromOrdering,xs){var out;if(xs.length<2)return xs;out=xs.slice(0);mergeFromTo(compare3,fromOrdering,out,xs.slice(0),0,xs.length);return out}}();function unsafeFreezeThawImpl(xs){return xs}var unsafeFreezeImpl=unsafeFreezeThawImpl;function copyImpl(xs){return xs.slice()}var thawImpl=copyImpl;var sortByImpl2=function(){function mergeFromTo(compare3,fromOrdering,xs1,xs2,from3,to3){var mid;var i3;var j;var k;var x;var y;var c;mid=from3+(to3-from3>>1);if(mid-from3>1)mergeFromTo(compare3,fromOrdering,xs2,xs1,from3,mid);if(to3-mid>1)mergeFromTo(compare3,fromOrdering,xs2,xs1,mid,to3);i3=from3;j=mid;k=from3;while(i3<mid&&j<to3){x=xs2[i3];y=xs2[j];c=fromOrdering(compare3(x)(y));if(c>0){xs1[k++]=y;++j}else{xs1[k++]=x;++i3}}while(i3<mid){xs1[k++]=xs2[i3++]}while(j<to3){xs1[k++]=xs2[j++]}}return function(compare3,fromOrdering,xs){if(xs.length<2)return xs;mergeFromTo(compare3,fromOrdering,xs,xs.slice(0),0,xs.length);return xs}}();var pushImpl=function(a3,xs){return xs.push(a3)};var runSTFn1=function runSTFn12(fn){return function(a3){return function(){return fn(a3)}}};var runSTFn2=function runSTFn22(fn){return function(a3){return function(b){return function(){return fn(a3,b)}}}};var unsafeFreeze=runSTFn1(unsafeFreezeImpl);var thaw=runSTFn1(thawImpl);var withArray=function(f){return function(xs){return function __do(){var result=thaw(xs)();f(result)();return unsafeFreeze(result)()}}};var push=runSTFn2(pushImpl);var mkFn5=function(fn){return function(a3,b,c,d,e){return fn(a3)(b)(c)(d)(e)}};var runFn2=function(fn){return function(a3){return function(b){return fn(a3,b)}}};var runFn3=function(fn){return function(a3){return function(b){return function(c){return fn(a3,b,c)}}}};var runFn4=function(fn){return function(a3){return function(b){return function(c){return function(d){return fn(a3,b,c,d)}}}}};var runFn5=function(fn){return function(a3){return function(b){return function(c){return function(d){return function(e){return fn(a3,b,c,d,e)}}}}}};var mapWithIndexArray=function(f){return function(xs){var l=xs.length;var result=Array(l);for(var i3=0;i3<l;i3++){result[i3]=f(i3)(xs[i3])}return result}};var mapWithIndex=function(dict){return dict.mapWithIndex};var functorWithIndexArray={mapWithIndex:mapWithIndexArray,Functor0:function(){return functorArray}};var unfoldrArrayImpl=function(isNothing2){return function(fromJust9){return function(fst2){return function(snd2){return function(f){return function(b){var result=[];var value13=b;while(true){var maybe2=f(value13);if(isNothing2(maybe2))return result;var tuple=fromJust9(maybe2);result.push(fst2(tuple));value13=snd2(tuple)}}}}}}};var unfoldr1ArrayImpl=function(isNothing2){return function(fromJust9){return function(fst2){return function(snd2){return function(f){return function(b){var result=[];var value13=b;while(true){var tuple=f(value13);result.push(fst2(tuple));var maybe2=snd2(tuple);if(isNothing2(maybe2))return result;value13=fromJust9(maybe2)}}}}}}};var fromJust2=fromJust();var unfoldable1Array={unfoldr1:unfoldr1ArrayImpl(isNothing)(fromJust2)(fst)(snd)};var fromJust3=fromJust();var unfoldr=function(dict){return dict.unfoldr};var unfoldableArray={unfoldr:unfoldrArrayImpl(isNothing)(fromJust3)(fst)(snd),Unfoldable10:function(){return unfoldable1Array}};var fromJust4=fromJust();var append2=append(semigroupArray);var updateAt=function(){return runFn5(_updateAt)(Just.create)(Nothing.value)}();var uncons=function(){return runFn3(unconsImpl)($$const(Nothing.value))((function(x){return function(xs){return new Just({head:x,tail:xs})}}))}();var snoc=function(xs){return function(x){return withArray(push(x))(xs)()}};var singleton3=function(a3){return[a3]};var range2=runFn2(rangeImpl);var foldr2=foldr(foldableArray);var findIndex=function(){return runFn4(findIndexImpl)(Just.create)(Nothing.value)}();var filter=runFn2(filterImpl);var elemIndex=function(dictEq){var eq22=eq(dictEq);return function(x){return findIndex((function(v){return eq22(v)(x)}))}};var notElem2=function(dictEq){var elemIndex1=elemIndex(dictEq);return function(a3){return function(arr){return isNothing(elemIndex1(a3)(arr))}}};var deleteAt=function(){return runFn4(_deleteAt)(Just.create)(Nothing.value)}();var deleteBy=function(v){return function(v1){return function(v2){if(v2.length===0){return[]}return maybe(v2)((function(i3){return fromJust4(deleteAt(i3)(v2))}))(findIndex(v(v1))(v2))}}};var $$delete=function(dictEq){return deleteBy(eq(dictEq))};var cons=function(x){return function(xs){return append2([x])(xs)}};var some=function(dictAlternative){var apply1=apply(dictAlternative.Applicative0().Apply0());var map32=map(dictAlternative.Plus1().Alt0().Functor0());return function(dictLazy){var defer5=defer(dictLazy);return function(v){return apply1(map32(cons)(v))(defer5((function(v1){return many(dictAlternative)(dictLazy)(v)})))}}};var many=function(dictAlternative){var alt6=alt(dictAlternative.Plus1().Alt0());var pure13=pure(dictAlternative.Applicative0());return function(dictLazy){return function(v){return alt6(some(dictAlternative)(dictLazy)(v))(pure13([]))}}};var concatMap=flip(bind(bindArray));var hasArrayFrom=typeof Array.from==="function";var hasStringIterator=typeof Symbol!=="undefined"&&Symbol!=null&&typeof Symbol.iterator!=="undefined"&&typeof String.prototype[Symbol.iterator]==="function";var hasFromCodePoint=typeof String.prototype.fromCodePoint==="function";var hasCodePointAt=typeof String.prototype.codePointAt==="function";var _unsafeCodePointAt0=function(fallback){return hasCodePointAt?function(str){return str.codePointAt(0)}:fallback};var _codePointAt=function(fallback){return function(Just2){return function(Nothing2){return function(unsafeCodePointAt02){return function(index4){return function(str){var length8=str.length;if(index4<0||index4>=length8)return Nothing2;if(hasStringIterator){var iter=str[Symbol.iterator]();for(var i3=index4;;--i3){var o=iter.next();if(o.done)return Nothing2;if(i3===0)return Just2(unsafeCodePointAt02(o.value))}}return fallback(index4)(str)}}}}}};var _singleton=function(fallback){return hasFromCodePoint?String.fromCodePoint:fallback};var _take=function(fallback){return function(n){if(hasStringIterator){return function(str){var accum="";var iter=str[Symbol.iterator]();for(var i3=0;i3<n;++i3){var o=iter.next();if(o.done)return accum;accum+=o.value}return accum}}return fallback(n)}};var _toCodePointArray=function(fallback){return function(unsafeCodePointAt02){if(hasArrayFrom){return function(str){return Array.from(str,unsafeCodePointAt02)}}return fallback}};function toCharCode(c){return c.charCodeAt(0)}function fromCharCode(c){return String.fromCharCode(c)}var bottom1=bottom(boundedChar);var top1=top(boundedChar);var toEnum=function(dict){return dict.toEnum};var fromEnum=function(dict){return dict.fromEnum};var toEnumWithDefaults=function(dictBoundedEnum){var toEnum1=toEnum(dictBoundedEnum);var fromEnum12=fromEnum(dictBoundedEnum);var bottom22=bottom(dictBoundedEnum.Bounded0());return function(low2){return function(high2){return function(x){var v=toEnum1(x);if(v instanceof Just){return v.value0}if(v instanceof Nothing){var $140=x<fromEnum12(bottom22);if($140){return low2}return high2}throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[v.constructor.name])}}}};var defaultSucc=function(toEnum$prime){return function(fromEnum$prime){return function(a3){return toEnum$prime(fromEnum$prime(a3)+1|0)}}};var defaultPred=function(toEnum$prime){return function(fromEnum$prime){return function(a3){return toEnum$prime(fromEnum$prime(a3)-1|0)}}};var charToEnum=function(v){if(v>=toCharCode(bottom1)&&v<=toCharCode(top1)){return new Just(fromCharCode(v))}return Nothing.value};var enumChar={succ:defaultSucc(charToEnum)(toCharCode),pred:defaultPred(charToEnum)(toCharCode),Ord0:function(){return ordChar}};var boundedEnumChar=function(){return{cardinality:toCharCode(top1)-toCharCode(bottom1)|0,toEnum:charToEnum,fromEnum:toCharCode,Bounded0:function(){return boundedChar},Enum1:function(){return enumChar}}}();var fromNumberImpl=function(just){return function(nothing){return function(n){return(n|0)===n?just(n):nothing}}};var toNumber=function(n){return n};var fromStringAsImpl=function(just){return function(nothing){return function(radix){var digits;if(radix<11){digits="[0-"+(radix-1).toString()+"]"}else if(radix===11){digits="[0-9a]"}else{digits="[0-9a-"+String.fromCharCode(86+radix)+"]"}var pattern2=new RegExp("^[\\+\\-]?"+digits+"+$","i");return function(s){if(pattern2.test(s)){var i3=parseInt(s,radix);return(i3|0)===i3?just(i3):nothing}else{return nothing}}}}};var isFiniteImpl=isFinite;var floor=Math.floor;var top2=top(boundedInt);var bottom2=bottom(boundedInt);var fromStringAs=function(){return fromStringAsImpl(Just.create)(Nothing.value)}();var fromString=fromStringAs(10);var fromNumber=function(){return fromNumberImpl(Just.create)(Nothing.value)}();var unsafeClamp=function(x){if(!isFiniteImpl(x)){return 0}if(x>=toNumber(top2)){return top2}if(x<=toNumber(bottom2)){return bottom2}if(otherwise){return fromMaybe(0)(fromNumber(x))}throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[x.constructor.name])};var floor2=function($39){return unsafeClamp(floor($39))};var $runtime_lazy3=function(name15,moduleName,init4){var state3=0;var val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init4();state3=2;return val}};var fromEnum2=fromEnum(boundedEnumChar);var map5=map(functorMaybe);var unfoldr2=unfoldr(unfoldableArray);var div2=div(euclideanRingInt);var mod2=mod(euclideanRingInt);var compare2=compare(ordInt);var unsurrogate=function(lead){return function(trail){return(((lead-55296|0)*1024|0)+(trail-56320|0)|0)+65536|0}};var isTrail=function(cu){return 56320<=cu&&cu<=57343};var isLead=function(cu){return 55296<=cu&&cu<=56319};var uncons2=function(s){var v=length(s);if(v===0){return Nothing.value}if(v===1){return new Just({head:fromEnum2(charAt(0)(s)),tail:""})}var cu1=fromEnum2(charAt(1)(s));var cu0=fromEnum2(charAt(0)(s));var $43=isLead(cu0)&&isTrail(cu1);if($43){return new Just({head:unsurrogate(cu0)(cu1),tail:drop(2)(s)})}return new Just({head:cu0,tail:drop(1)(s)})};var unconsButWithTuple=function(s){return map5((function(v){return new Tuple(v.head,v.tail)}))(uncons2(s))};var toCodePointArrayFallback=function(s){return unfoldr2(unconsButWithTuple)(s)};var unsafeCodePointAt0Fallback=function(s){var cu0=fromEnum2(charAt(0)(s));var $47=isLead(cu0)&&length(s)>1;if($47){var cu1=fromEnum2(charAt(1)(s));var $48=isTrail(cu1);if($48){return unsurrogate(cu0)(cu1)}return cu0}return cu0};var unsafeCodePointAt0=_unsafeCodePointAt0(unsafeCodePointAt0Fallback);var toCodePointArray=_toCodePointArray(toCodePointArrayFallback)(unsafeCodePointAt0);var length3=function($74){return length2(toCodePointArray($74))};var fromCharCode2=function(){var $75=toEnumWithDefaults(boundedEnumChar)(bottom(boundedChar))(top(boundedChar));return function($76){return singleton($75($76))}}();var singletonFallback=function(v){if(v<=65535){return fromCharCode2(v)}var lead=div2(v-65536|0)(1024)+55296|0;var trail=mod2(v-65536|0)(1024)+56320|0;return fromCharCode2(lead)+fromCharCode2(trail)};var singleton4=_singleton(singletonFallback);var takeFallback=function(v){return function(v1){if(v<1){return""}var v2=uncons2(v1);if(v2 instanceof Just){return singleton4(v2.value0.head)+takeFallback(v-1|0)(v2.value0.tail)}return v1}};var take2=_take(takeFallback);var eqCodePoint={eq:function(x){return function(y){return x===y}}};var ordCodePoint={compare:function(x){return function(y){return compare2(x)(y)}},Eq0:function(){return eqCodePoint}};var drop2=function(n){return function(s){return drop(length(take2(n)(s)))(s)}};var codePointAtFallback=function($copy_n){return function($copy_s){var $tco_var_n=$copy_n;var $tco_done=false;var $tco_result;function $tco_loop(n,s){var v=uncons2(s);if(v instanceof Just){var $66=n===0;if($66){$tco_done=true;return new Just(v.value0.head)}$tco_var_n=n-1|0;$copy_s=v.value0.tail;return}$tco_done=true;return Nothing.value}while(!$tco_done){$tco_result=$tco_loop($tco_var_n,$copy_s)}return $tco_result}};var codePointAt=function(v){return function(v1){if(v<0){return Nothing.value}if(v===0&&v1===""){return Nothing.value}if(v===0){return new Just(unsafeCodePointAt0(v1))}return _codePointAt(codePointAtFallback)(Just.create)(Nothing.value)(unsafeCodePointAt0)(v)(v1)}};var boundedCodePoint={bottom:0,top:1114111,Ord0:function(){return ordCodePoint}};var boundedEnumCodePoint=function(){return{cardinality:1114111+1|0,fromEnum:function(v){return v},toEnum:function(n){if(n>=0&&n<=1114111){return new Just(n)}if(otherwise){return Nothing.value}throw new Error("Failed pattern match at Data.String.CodePoints (line 63, column 1 - line 68, column 26): "+[n.constructor.name])},Bounded0:function(){return boundedCodePoint},Enum1:function(){return $lazy_enumCodePoint(0)}}}();var $lazy_enumCodePoint=$runtime_lazy3("enumCodePoint","Data.String.CodePoints",(function(){return{succ:defaultSucc(toEnum(boundedEnumCodePoint))(fromEnum(boundedEnumCodePoint)),pred:defaultPred(toEnum(boundedEnumCodePoint))(fromEnum(boundedEnumCodePoint)),Ord0:function(){return ordCodePoint}}}));function toArrayWithKey(f){return function(m){var r=[];for(var k in m){if(hasOwnProperty.call(m,k)){r.push(f(k)(m[k]))}}return r}}var keys=Object.keys||toArrayWithKey((function(k){return function(){return k}}));var foldr8=foldr(foldableArray);var mapWithIndex2=mapWithIndex(functorWithIndexArray);var foldl8=foldl(foldableArray);var foldrWithIndex=function(dict){return dict.foldrWithIndex};var foldMapWithIndexDefaultR=function(dictFoldableWithIndex){var foldrWithIndex1=foldrWithIndex(dictFoldableWithIndex);return function(dictMonoid){var append3=append(dictMonoid.Semigroup0());var mempty2=mempty(dictMonoid);return function(f){return foldrWithIndex1((function(i3){return function(x){return function(acc){return append3(f(i3)(x))(acc)}}}))(mempty2)}}};var foldableWithIndexArray={foldrWithIndex:function(f){return function(z){var $291=foldr8((function(v){return function(y){return f(v.value0)(v.value1)(y)}}))(z);var $292=mapWithIndex2(Tuple.create);return function($293){return $291($292($293))}}},foldlWithIndex:function(f){return function(z){var $294=foldl8((function(y){return function(v){return f(v.value0)(y)(v.value1)}}))(z);var $295=mapWithIndex2(Tuple.create);return function($296){return $294($295($296))}}},foldMapWithIndex:function(dictMonoid){return foldMapWithIndexDefaultR(foldableWithIndexArray)(dictMonoid)},Foldable0:function(){return foldableArray}};var traverseWithIndexDefault=function(dictTraversableWithIndex){var sequence2=sequence(dictTraversableWithIndex.Traversable2());var mapWithIndex4=mapWithIndex(dictTraversableWithIndex.FunctorWithIndex0());return function(dictApplicative){var sequence12=sequence2(dictApplicative);return function(f){var $174=mapWithIndex4(f);return function($175){return sequence12($174($175))}}}};var traverseWithIndex=function(dict){return dict.traverseWithIndex};var traversableWithIndexArray={traverseWithIndex:function(dictApplicative){return traverseWithIndexDefault(traversableWithIndexArray)(dictApplicative)},FunctorWithIndex0:function(){return functorWithIndexArray},FoldableWithIndex1:function(){return foldableWithIndexArray},Traversable2:function(){return traversableArray}};var fromJust5=fromJust();var crashWith3=crashWith();var show2=show(showString);var map6=map(functorArray);var toClassListString={to:function(){var $46=filter(function(){var $49=not(heytingAlgebraBoolean);return function($50){return $49($$null($50))}}());var $47=split(" ");return function($48){return $46($47($48))}}()};var value=createProperty("value");var type$prime=createProperty("type");var to=function(dict){return dict.to};var styleAttr=createAttribute("style");var caseify=function(name$prime){if(name$prime===toUpper(name$prime)){return toLower(name$prime)}if(otherwise){var v=fromJust5(uncons2(name$prime));var replacer=function($133){return $$const(function(v1){return"-"+v1}(toLower($133)))};var regex3=function(){var v1=regex("[A-Z]")(global);if(v1 instanceof Right){return v1.value0}if(v1 instanceof Left){return crashWith3(show2(v1.value0))}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 90, column 40 - line 92, column 57): "+[v1.constructor.name])}();var hyphenated=replace$prime(regex3)(replacer)(v.tail);return toLower(singleton4(v.head))+hyphenated}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 83, column 1 - line 83, column 26): "+[name$prime.constructor.name])};var class$prime=function(dictToClassList){var $134=map6(caseify);var $135=to(dictToClassList);return function($136){return createClass($134($135($136)))}};var booleanToFalsyString=function(v){if(v){return"true"}if(!v){return""}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 66, column 7 - line 68, column 23): "+[v.constructor.name])};var checked=function(){var $140=createProperty("checked");return function($141){return $140(booleanToFalsyString($141))}}();var readOnly=function(){var $164=createProperty("readOnly");return function($165){return $164(booleanToFalsyString($165))}}();var textNode=1;var elementNode=2;var styleData=1;var classData2=2;var propertyData2=3;var attributeData2=4;var keyData=7;function createElementNode(tag){return function(nodeData){return function(potentialChildren){let children=potentialChildren,text6=void 0;if(potentialChildren.length===1&&potentialChildren[0].nodeType==textNode){children=void 0;text6=potentialChildren[0].text}return{nodeType:elementNode,node:void 0,tag:tag,nodeData:fromNodeData(nodeData),children:children,text:text6}}}}function createDatalessElementNode(tag){return function(potentialChildren){let children=potentialChildren,text6=void 0;if(potentialChildren.length===1&&potentialChildren[0].nodeType==textNode){children=void 0;text6=potentialChildren[0].text}return{nodeType:elementNode,node:void 0,tag:tag,nodeData:{},children:children,text:text6}}}function createSingleElementNode(tag){return function(nodeData){return{nodeType:elementNode,node:void 0,tag:tag,nodeData:fromNodeData(nodeData)}}}function text(value13){return{nodeType:textNode,node:void 0,text:value13}}function fromNodeData(allData){let nodeData={};if(allData!==void 0)for(let data of allData){let dataOne=data[1];switch(data[0]){case styleData:if(nodeData.styles===void 0)nodeData.styles={};for(let key2 in dataOne)nodeData.styles[key2]=dataOne[key2];break;case classData2:if(nodeData.classes===void 0)nodeData.classes=[];nodeData.classes=nodeData.classes.concat(dataOne);break;case propertyData2:if(nodeData.properties===void 0)nodeData.properties={};nodeData.properties[dataOne]=data[2];break;case attributeData2:if(nodeData.attributes===void 0)nodeData.attributes={};nodeData.attributes[dataOne]=data[2];break;case keyData:nodeData.key=dataOne;break;default:if(nodeData.events===void 0)nodeData.events={};if(nodeData.events[dataOne]===void 0)nodeData.events[dataOne]=[];nodeData.events[dataOne].push(data[2])}}return nodeData}var toNodeNodeDataNodeData={toNode:singleton3};var toNodeHtmlHtml={toNode:singleton3};var toNode=function(dict){return dict.toNode};var toNodeArray=function(dictToNode){return{toNode:concatMap(toNode(dictToNode))}};var createElement_=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(children){return createDatalessElementNode(tag)(toNode1(children))}}};var div_=function(dictToNode){return createElement_("div")(dictToNode)};var createElement$prime=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(nodeData){return createSingleElementNode(tag)(toNode1(nodeData))}}};var input=function(dictToNode){return createElement$prime("input")(dictToNode)};var createElement=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(dictToNode1){var toNode2=toNode(dictToNode1);return function(nodeData){return function(children){return createElementNode(tag)(toNode1(nodeData))(toNode2(children))}}}}};var div3=function(dictToNode){return function(dictToNode1){return createElement("div")(dictToNode)(dictToNode1)}};var h6=function(dictToNode){return function(dictToNode1){return createElement("h6")(dictToNode)(dictToNode1)}};var header=function(dictToNode){return function(dictToNode1){return createElement("header")(dictToNode)(dictToNode1)}};var i=function(dictToNode){return function(dictToNode1){return createElement("i")(dictToNode)(dictToNode1)}};var label=function(dictToNode){return function(dictToNode1){return createElement("label")(dictToNode)(dictToNode1)}};var main=function(dictToNode){return function(dictToNode1){return createElement("main")(dictToNode)(dictToNode1)}};var nav=function(dictToNode){return function(dictToNode1){return createElement("nav")(dictToNode)(dictToNode1)}};var span=function(dictToNode){return function(dictToNode1){return createElement("span")(dictToNode)(dictToNode1)}};var textarea=function(dictToNode){return function(dictToNode1){return createElement("textarea")(dictToNode)(dictToNode1)}};var button=function(dictToNode){return function(dictToNode1){return createElement("button")(dictToNode)(dictToNode1)}};var article_=function(dictToNode){return createElement_("article")(dictToNode)};var a=function(dictToNode){return function(dictToNode1){return createElement("a")(dictToNode)(dictToNode1)}};var reUnescapedHtml=/[&<>"']/g;var reHasUnescapedHtml=RegExp(reUnescapedHtml.source);var traverse1Impl=function(){function Cont(fn){this.fn=fn}var emptyList={};var ConsCell=function(head4,tail2){this.head=head4;this.tail=tail2};function finalCell(head4){return new ConsCell(head4,emptyList)}function consList(x){return function(xs){return new ConsCell(x,xs)}}function listToArray(list){var arr=[];var xs=list;while(xs!==emptyList){arr.push(xs.head);xs=xs.tail}return arr}return function(apply3,map21,f){var buildFrom=function(x,ys){return apply3(map21(consList)(f(x)))(ys)};var go2=function(acc,currentLen,xs){if(currentLen===0){return acc}else{var last3=xs[currentLen-1];return new Cont((function(){var built=go2(buildFrom(last3,acc),currentLen-1,xs);return built}))}};return function(array){var acc=map21(finalCell)(f(array[array.length-1]));var result=go2(acc,array.length-1,array);while(result instanceof Cont){result=result.fn()}return map21(listToArray)(result)}}}();var NonEmpty=function(){function NonEmpty2(value0,value1){this.value0=value0;this.value1=value1}NonEmpty2.create=function(value0){return function(value1){return new NonEmpty2(value0,value1)}};return NonEmpty2}();var singleton6=function(dictPlus){var empty5=empty(dictPlus);return function(a3){return new NonEmpty(a3,empty5)}};var showNonEmpty=function(dictShow){var show11=show(dictShow);return function(dictShow1){var show17=show(dictShow1);return{show:function(v){return"(NonEmpty "+(show11(v.value0)+(" "+(show17(v.value1)+")")))}}}};var functorNonEmpty=function(dictFunctor){var map23=map(dictFunctor);return{map:function(f){return function(m){return new NonEmpty(f(m.value0),map23(f)(m.value1))}}}};var Nil=function(){function Nil3(){}Nil3.value=new Nil3;return Nil3}();var Cons=function(){function Cons3(value0,value1){this.value0=value0;this.value1=value1}Cons3.create=function(value0){return function(value1){return new Cons3(value0,value1)}};return Cons3}();var NonEmptyList=function(x){return x};var toList=function(v){return new Cons(v.value0,v.value1)};var listMap=function(f){var chunkedRevMap=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v;var $tco_done=false;var $tco_result;function $tco_loop(v,v1){if(v1 instanceof Cons&&(v1.value1 instanceof Cons&&v1.value1.value1 instanceof Cons)){$tco_var_v=new Cons(v1,v);$copy_v1=v1.value1.value1.value1;return}var unrolledMap=function(v2){if(v2 instanceof Cons&&(v2.value1 instanceof Cons&&v2.value1.value1 instanceof Nil)){return new Cons(f(v2.value0),new Cons(f(v2.value1.value0),Nil.value))}if(v2 instanceof Cons&&v2.value1 instanceof Nil){return new Cons(f(v2.value0),Nil.value)}return Nil.value};var reverseUnrolledMap=function($copy_v2){return function($copy_v3){var $tco_var_v2=$copy_v2;var $tco_done1=false;var $tco_result2;function $tco_loop2(v2,v3){if(v2 instanceof Cons&&(v2.value0 instanceof Cons&&(v2.value0.value1 instanceof Cons&&v2.value0.value1.value1 instanceof Cons))){$tco_var_v2=v2.value1;$copy_v3=new Cons(f(v2.value0.value0),new Cons(f(v2.value0.value1.value0),new Cons(f(v2.value0.value1.value1.value0),v3)));return}$tco_done1=true;return v3}while(!$tco_done1){$tco_result2=$tco_loop2($tco_var_v2,$copy_v3)}return $tco_result2}};$tco_done=true;return reverseUnrolledMap(v)(unrolledMap(v1))}while(!$tco_done){$tco_result=$tco_loop($tco_var_v,$copy_v1)}return $tco_result}};return chunkedRevMap(Nil.value)};var functorList={map:listMap};var map7=map(functorList);var functorNonEmptyList=functorNonEmpty(functorList);var foldableList={foldr:function(f){return function(b){var rev3=function(){var go2=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v;var $tco_done=false;var $tco_result;function $tco_loop(v,v1){if(v1 instanceof Nil){$tco_done=true;return v}if(v1 instanceof Cons){$tco_var_v=new Cons(v1.value0,v);$copy_v1=v1.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[v.constructor.name,v1.constructor.name])}while(!$tco_done){$tco_result=$tco_loop($tco_var_v,$copy_v1)}return $tco_result}};return go2(Nil.value)}();var $284=foldl(foldableList)(flip(f))(b);return function($285){return $284(rev3($285))}}},foldl:function(f){var go2=function($copy_b){return function($copy_v){var $tco_var_b=$copy_b;var $tco_done1=false;var $tco_result;function $tco_loop(b,v){if(v instanceof Nil){$tco_done1=true;return b}if(v instanceof Cons){$tco_var_b=f(b)(v.value0);$copy_v=v.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[v.constructor.name])}while(!$tco_done1){$tco_result=$tco_loop($tco_var_b,$copy_v)}return $tco_result}};return go2},foldMap:function(dictMonoid){var append22=append(dictMonoid.Semigroup0());var mempty2=mempty(dictMonoid);return function(f){return foldl(foldableList)((function(acc){var $286=append22(acc);return function($287){return $286(f($287))}}))(mempty2)}}};var foldr3=foldr(foldableList);var intercalate3=intercalate(foldableList)(monoidString);var semigroupList={append:function(xs){return function(ys){return foldr3(Cons.create)(ys)(xs)}}};var append1=append(semigroupList);var semigroupNonEmptyList={append:function(v){return function(as$prime){return new NonEmpty(v.value0,append1(v.value1)(toList(as$prime)))}}};var showList=function(dictShow){var show11=show(dictShow);return{show:function(v){if(v instanceof Nil){return"Nil"}return"("+(intercalate3(" : ")(map7(show11)(v))+" : Nil)")}}};var showNonEmptyList=function(dictShow){var show11=show(showNonEmpty(dictShow)(showList(dictShow)));return{show:function(v){return"(NonEmptyList "+(show11(v)+")")}}};var applyList={apply:function(v){return function(v1){if(v instanceof Nil){return Nil.value}if(v instanceof Cons){return append1(map7(v.value0)(v1))(apply(applyList)(v.value1)(v1))}throw new Error("Failed pattern match at Data.List.Types (line 157, column 1 - line 159, column 48): "+[v.constructor.name,v1.constructor.name])}},Functor0:function(){return functorList}};var apply2=apply(applyList);var applyNonEmptyList={apply:function(v){return function(v1){return new NonEmpty(v.value0(v1.value0),append1(apply2(v.value1)(new Cons(v1.value0,Nil.value)))(apply2(new Cons(v.value0,v.value1))(v1.value1)))}},Functor0:function(){return functorNonEmptyList}};var altList={alt:append1,Functor0:function(){return functorList}};var plusList=function(){return{empty:Nil.value,Alt0:function(){return altList}}}();var applicativeNonEmptyList={pure:function(){var $315=singleton6(plusList);return function($316){return NonEmptyList($315($316))}}(),Apply0:function(){return applyNonEmptyList}};var some2=function(dictAlternative){var apply3=apply(dictAlternative.Applicative0().Apply0());var map110=map(dictAlternative.Plus1().Alt0().Functor0());return function(dictLazy){var defer5=defer(dictLazy);return function(v){return apply3(map110(Cons.create)(v))(defer5((function(v1){return many2(dictAlternative)(dictLazy)(v)})))}}};var many2=function(dictAlternative){var alt6=alt(dictAlternative.Plus1().Alt0());var pure10=pure(dictAlternative.Applicative0());return function(dictLazy){return function(v){return alt6(some2(dictAlternative)(dictLazy)(v))(pure10(Nil.value))}}};var singleton7=function(){var $200=singleton6(plusList);return function($201){return NonEmptyList($200($201))}}();var get=function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(){return function(l){return function(r){return unsafeGet(reflectSymbol2(l))(r)}}}};function compareReference(a3){return function(b){return a3===b}}var modelHasChanged=function(old){return function($$new2){return!compareReference(old)($$new2)}};var namespace="http://www.w3.org/2000/svg";var eventPrefix="__flame_";var eventPostfix="updater";var textNode2=1;var elementNode2=2;var svgNode=3;var fragmentNode=4;var lazyNode=5;var managedNode=6;var nonBubblingEvents=["focus","blur","scroll","load","unload"];function start_(eventWrapper,root,updater,html){return new F(eventWrapper,root,updater,html,false)}function startFrom_(eventWrapper,root,updater,html){return new F(eventWrapper,root,updater,html,true)}function resume_(f,html){f.resume(html)}function F(eventWrapper,root,updater,html,isDry){this.eventWrapper=eventWrapper;this.applicationEvents=new Map;this.root=root;this.updater=updater;this.cachedHtml=html.node===void 0?html:shallowCopy(html);if(isDry)this.hydrate(this.root,this.cachedHtml);else this.createAllNodes(this.root,this.cachedHtml)}F.prototype.hydrate=function(parent2,html,referenceNode){switch(html.nodeType){case lazyNode:html.node=parent2;html.rendered=html.render(html.arg);html.render=void 0;this.hydrate(parent2,html.rendered);break;case textNode2:html.node=parent2;break;case managedNode:this.createAllNodes(parent2,html,referenceNode);break;default:if(html.nodeType===fragmentNode)html.node=document.createDocumentFragment();else{html.node=parent2;if(html.nodeData.events!==void 0)this.createAllEvents(parent2,html)}let htmlChildrenLength;if(html.text===void 0&&html.children!==void 0&&(htmlChildrenLength=html.children.length)>0){let childNodes=parent2.childNodes;for(let i3=0,cni=0;i3<htmlChildrenLength;++i3,++cni){let c=html.children[i3]=html.children[i3].node===void 0?html.children[i3]:shallowCopy(html.children[i3]);if(childNodes[cni]===void 0)this.createAllNodes(parent2,c);else{if(c.nodeType===fragmentNode){let fragmentChildrenLength=c.children.length;c.node=document.createDocumentFragment();for(let j=0;j<fragmentChildrenLength;++j){let cf=c.children[j]=c.children[j].node===void 0?c.children[j]:shallowCopy(c.children[j]);this.hydrate(childNodes[cni++],cf)}cni--}else if(c.nodeType===managedNode)this.hydrate(parent2,c,childNodes[cni]);else this.hydrate(childNodes[cni],c)}}}}};function shallowCopy(origin2){switch(origin2.nodeType){case textNode2:return{nodeType:textNode2,node:void 0,text:origin2.text};case fragmentNode:return{nodeType:fragmentNode,node:void 0,children:origin2.children};case lazyNode:return{nodeType:lazyNode,node:void 0,nodeData:origin2.nodeData,render:origin2.render,arg:origin2.arg,rendered:void 0,messageMapper:origin2.messageMapper};case managedNode:return{nodeType:managedNode,node:void 0,nodeData:origin2.nodeData,createNode:origin2.createNode,updateNode:origin2.updateNode,arg:origin2.arg,messageMapper:origin2.messageMapper};default:return{nodeType:origin2.nodeType,node:void 0,tag:origin2.tag,nodeData:origin2.nodeData,children:origin2.children,text:origin2.text,messageMapper:origin2.messageMapper}}}F.prototype.createAllNodes=function(parent2,html,referenceNode){let node=this.createNode(html);if(html.text!==void 0)node.textContent=html.text;else{if(html.children!==void 0)this.createChildrenNodes(node,html.children);else if(html.rendered!==void 0){if(html.messageMapper!==void 0)lazyMessageMap(html.messageMapper,html.rendered);if(html.rendered.text!==void 0){node.textContent=html.rendered.text}else if(html.rendered.children!==void 0)this.createChildrenNodes(node,html.rendered.children)}}parent2.insertBefore(node,referenceNode)};F.prototype.checkCreateAllNodes=function(parent2,html,referenceNode){if(html.node!==void 0)html=shallowCopy(html);this.createAllNodes(parent2,html,referenceNode);return html};F.prototype.createChildrenNodes=function(parent2,children){let childrenLength=children.length;for(let i3=0;i3<childrenLength;++i3){let html=children[i3]=children[i3].node===void 0?children[i3]:shallowCopy(children[i3]);this.checkCreateAllNodes(parent2,html,null)}};F.prototype.createNode=function(html){switch(html.nodeType){case lazyNode:html.rendered=html.render(html.arg);html.render=void 0;return html.node=this.createNode(html.rendered);case textNode2:return html.node=document.createTextNode(html.text);case elementNode2:return html.node=this.createElement(html);case svgNode:return html.node=this.createSvg(html);case fragmentNode:return html.node=document.createDocumentFragment();case managedNode:return html.node=this.createManagedNode(html)}};F.prototype.createElement=function(html){let element=document.createElement(html.tag);this.createNodeData(element,html,false);return element};F.prototype.createSvg=function(html){let svg=document.createElementNS(namespace,html.tag);this.createNodeData(svg,html,true);return svg};F.prototype.createManagedNode=function(html){let node=html.createNode(html.arg)();html.createNode=void 0;this.createNodeData(node,html,node instanceof SVGElement||node.nodeName.toLowerCase()==="svg");return node};F.prototype.createNodeData=function(node,html,isSvg){if(html.nodeData.styles!==void 0)createStyles(node,html.nodeData.styles);if(html.nodeData.classes!==void 0&&html.nodeData.classes.length>0)createClasses(node,html.nodeData.classes,isSvg);if(html.nodeData.attributes!==void 0)createAttributes(node,html.nodeData.attributes);if(html.nodeData.properties!==void 0)for(let key2 in html.nodeData.properties)node[key2]=html.nodeData.properties[key2];if(html.nodeData.events!==void 0)this.createAllEvents(node,html)};function createStyles(node,styles){for(let key2 in styles)node.style.setProperty(key2,styles[key2])}function createClasses(node,classes,isSvg){let joined=classes.join(" ");if(isSvg)node.setAttribute("class",joined);else node.className=joined}function createAttributes(node,attributes){for(let key2 in attributes)node.setAttribute(key2,attributes[key2])}F.prototype.createAllEvents=function(node,html){for(let key2 in html.nodeData.events)this.createEvent(node,key2,html)};F.prototype.createEvent=function(node,name15,html){let handlers=html.nodeData.events[name15],eventKey=eventPrefix+name15;if(nonBubblingEvents.includes(name15)){let runNonBubblingEvent=this.runNonBubblingEvent(handlers,html.messageMapper);node[eventKey]=runNonBubblingEvent;node.addEventListener(name15,runNonBubblingEvent,false)}else{node[eventKey]=handlers;if(html.messageMapper!==void 0)node[eventKey+eventPostfix]=html.messageMapper;let synthetic=this.applicationEvents.get(name15);if(synthetic===void 0){let runEvent=this.runEvent.bind(this);this.root.addEventListener(name15,runEvent,false);this.applicationEvents.set(name15,{count:1,handler:runEvent})}else synthetic.count++}};F.prototype.runNonBubblingEvent=function(handlers,messageMapper2){return function(event){this.runHandlers(handlers,messageMapper2,event)}.bind(this)};F.prototype.runEvent=function(event){let node=event.target,eventKey=eventPrefix+event.type;while(node!==this.root){let handlers=node[eventKey];if(handlers!==void 0){this.runHandlers(handlers,node[eventKey+eventPostfix],event);return}node=node.parentNode}};F.prototype.runHandlers=function(handlers,messageMapper2,event){let handlersLength=handlers.length;for(let i3=0;i3<handlersLength;++i3){let h=handlers[i3],maybeMessage=typeof h==="function"?h(event)():this.eventWrapper(h);this.updater(messageMapper2===void 0?maybeMessage:messageMapper2(maybeMessage))()}event.stopPropagation()};F.prototype.resume=function(updatedHtml){this.cachedHtml=this.updateAllNodes(this.root,this.cachedHtml,updatedHtml)};F.prototype.updateAllNodes=function(parent2,currentHtml2,updatedHtml){if(updatedHtml.node!==void 0)updatedHtml=shallowCopy(updatedHtml);if(currentHtml2.tag!==updatedHtml.tag||currentHtml2.nodeType!==updatedHtml.nodeType){if(currentHtml2.nodeType===fragmentNode){this.createAllNodes(parent2,updatedHtml,firstFragmentChildNode(currentHtml2.children));removeFragmentChildren(parent2,currentHtml2.children)}else{this.createAllNodes(parent2,updatedHtml,currentHtml2.node);parent2.removeChild(currentHtml2.node)}}else{updatedHtml.node=currentHtml2.node;switch(updatedHtml.nodeType){case lazyNode:if(updatedHtml.arg!==currentHtml2.arg){updatedHtml.rendered=updatedHtml.render(updatedHtml.arg);if(updatedHtml.messageMapper!==void 0)lazyMessageMap(updatedHtml.messageMapper,updatedHtml.rendered);this.updateAllNodes(parent2,currentHtml2.rendered,updatedHtml.rendered)}else updatedHtml.rendered=currentHtml2.rendered;updatedHtml.render=void 0;break;case managedNode:let node=updatedHtml.updateNode(currentHtml2.node)(currentHtml2.arg)(updatedHtml.arg)(),isSvg=node instanceof SVGElement||node.nodeName.toLowerCase()==="svg";if(node!==currentHtml2.node||node.nodeType!==currentHtml2.node.nodeType||node.nodeName!==currentHtml2.node.nodeName){this.createNodeData(node,updatedHtml,isSvg);parent2.insertBefore(node,currentHtml2.node);parent2.removeChild(currentHtml2.node)}else this.updateNodeData(node,currentHtml2.nodeData,updatedHtml,isSvg);updatedHtml.node=node;break;case textNode2:if(updatedHtml.text!==currentHtml2.text)updatedHtml.node.textContent=updatedHtml.text;break;case fragmentNode:this.updateChildrenNodes(parent2,currentHtml2,updatedHtml);break;default:this.updateNodeData(currentHtml2.node,currentHtml2.nodeData,updatedHtml,updatedHtml.nodeType==svgNode);if((updatedHtml.text!==void 0||updatedHtml.children===void 0&&currentHtml2.text!=void 0)&&!hasInnerHtml(updatedHtml.nodeData)&&updatedHtml.text!=currentHtml2.node.textContent)currentHtml2.node.textContent=updatedHtml.text;else this.updateChildrenNodes(currentHtml2.node,currentHtml2,updatedHtml)}}return updatedHtml};function firstFragmentChildNode(children){let childrenLength=children.length;for(let i3=0;i3<childrenLength;++i3){if(children[i3].nodeType===fragmentNode)return firstFragmentChildNode(children[i3].children);return children[i3].node}return void 0}function removeFragmentChildren(parent2,children){let childrenLength=children.length;for(let i3=0;i3<childrenLength;++i3)if(children[i3].nodeType===fragmentNode)removeFragmentChildren(children[i3].children);else parent2.removeChild(children[i3].node)}function clearNode(node){node.textContent=""}F.prototype.updateChildrenNodes=function(parent2,currentHtml2,updatedHtml){let currentChildren=currentHtml2.children,updatedChildren=updatedHtml.children;if(currentChildren===void 0||currentChildren.length===0){let updatedChildrenLength;if(updatedChildren!==void 0&&(updatedChildrenLength=updatedChildren.length)>0){if(currentHtml2.text!==void 0||hasInnerHtml(currentHtml2.nodeData))clearNode(parent2);for(let i3=0;i3<updatedChildrenLength;++i3)updatedChildren[i3]=this.checkCreateAllNodes(parent2,updatedChildren[i3])}}else if(updatedChildren===void 0||updatedChildren.length===0){if(currentChildren!==void 0&&(currentChildren.length>0||currentHtml2.text!==void 0)&&!hasInnerHtml(updatedHtml.nodeData))clearNode(parent2)}else if(currentChildren[0].nodeData!==void 0&&currentChildren[0].nodeData.key!==void 0&&updatedChildren[0].nodeData!==void 0&&updatedChildren[0].nodeData.key!==void 0)this.updateKeyedChildrenNodes(parent2,currentChildren,updatedChildren);else this.updateNonKeyedChildrenNodes(parent2,currentChildren,updatedChildren)};function hasInnerHtml(parentNodeData){return parentNodeData!==void 0&&parentNodeData.properties!==void 0&&parentNodeData.properties.innerHTML!==void 0}F.prototype.updateKeyedChildrenNodes=function(parent2,currentChildren,updatedChildren){let currentStart=0,updatedStart=0,currentEnd=currentChildren.length-1,updatedEnd=updatedChildren.length-1;let afterNode,currentStartNode=currentChildren[currentStart].node,updatedStartNode=currentStartNode,currentEndNode=currentChildren[currentEnd].node;let loop2=true;fixes:while(loop2){loop2=false;let currentHtml2=currentChildren[currentStart],updatedHtml=updatedChildren[updatedStart];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){updatedHtml=this.updateAllNodes(parent2,currentHtml2,updatedHtml);updatedStartNode=currentStartNode=currentHtml2.node.nextSibling;currentStart++;updatedStart++;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedStart]}currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedEnd];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){updatedHtml=this.updateAllNodes(parent2,currentHtml2,updatedHtml);afterNode=currentEndNode;currentEndNode=currentEndNode.previousSibling;currentEnd--;updatedEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedEnd]}currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedStart];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){loop2=true;updatedHtml=this.updateAllNodes(parent2,currentHtml2,updatedHtml);currentEndNode=currentHtml2.node.previousSibling;parent2.insertBefore(currentHtml2.node,updatedStartNode);updatedStart++;currentEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedStart]}currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedEnd];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){loop2=true;updatedHtml=this.updateAllNodes(parent2,currentHtml2,updatedHtml);parent2.insertBefore(currentHtml2.node,afterNode);afterNode=currentHtml2.node;currentStart++;updatedEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedEnd]}}if(updatedEnd<updatedStart)while(currentStart<=currentEnd){parent2.removeChild(currentChildren[currentEnd].node);currentEnd--}else if(currentEnd<currentStart)while(updatedStart<=updatedEnd){updatedChildren[updatedStart]=this.checkCreateAllNodes(parent2,updatedChildren[updatedStart],afterNode);updatedStart++}else{let P=new Int32Array(updatedEnd+1-updatedStart);let I=new Map;for(let i3=updatedStart;i3<=updatedEnd;i3++){P[i3]=-1;I.set(updatedChildren[i3].nodeData.key,i3)}let reusingNodes=updatedStart+updatedChildren.length-1-updatedEnd,toRemove=[];for(let i3=currentStart;i3<=currentEnd;i3++)if(I.has(currentChildren[i3].nodeData.key)){P[I.get(currentChildren[i3].nodeData.key)]=i3;reusingNodes++}else toRemove.push(i3);if(reusingNodes===0){parent2.textContent="";for(let i3=updatedStart;i3<=updatedEnd;i3++)updatedChildren[i3]=this.checkCreateAllNodes(parent2,updatedChildren[i3])}else{let toRemoveLength=toRemove.length;for(let i3=0;i3<toRemoveLength;i3++)parent2.removeChild(currentChildren[toRemove[i3]].node);let longestSeq=longestSubsequence(P,updatedStart),seqIndex=longestSeq.length-1;for(let i3=updatedEnd;i3>=updatedStart;i3--){if(longestSeq[seqIndex]===i3){currentHtml=currentChildren[P[longestSeq[seqIndex]]];updatedChildren[i3]=this.updateAllNodes(parent2,currentHtml,updatedChildren[i3]);afterNode=currentHtml.node;seqIndex--}else{if(P[i3]===-1){updatedChildren[i3]=this.checkCreateAllNodes(parent2,updatedChildren[i3],afterNode);afterNode=updatedChildren[i3].node}else{currentHtml=currentChildren[P[i3]];updatedChildren[i3]=this.updateAllNodes(parent2,currentHtml,updatedChildren[i3]);parent2.insertBefore(currentHtml.node,afterNode);afterNode=currentHtml.node}}}}}};function longestSubsequence(ns,updatedStart){let seq=[],is=[],l=-1,i3,len,pre=new Int32Array(ns.length);for(i3=updatedStart,len=ns.length;i3<len;i3++){let n=ns[i3];if(n<0)continue;let j=findGreatestIndex(seq,n);if(j!==-1)pre[i3]=is[j];if(j===l){l++;seq[l]=n;is[l]=i3}else if(n<seq[j+1]){seq[j+1]=n;is[j+1]=i3}}for(i3=is[l];l>=0;i3=pre[i3],l--)seq[l]=i3;return seq}function findGreatestIndex(seq,n){let lo=-1,hi=seq.length;if(hi>0&&seq[hi-1]<=n)return hi-1;while(hi-lo>1){let mid=Math.floor((lo+hi)/2);if(seq[mid]>n)hi=mid;else lo=mid}return lo}F.prototype.updateNonKeyedChildrenNodes=function(parent2,currentChildren,updatedChildren){let currentChildrenLength=currentChildren.length,updatedChildrenLength=updatedChildren.length,commonLength=Math.min(currentChildrenLength,updatedChildrenLength);for(let i3=0;i3<commonLength;++i3)updatedChildren[i3]=this.updateAllNodes(parent2,currentChildren[i3],updatedChildren[i3]);if(currentChildrenLength<updatedChildrenLength)for(let i3=commonLength;i3<updatedChildrenLength;++i3)updatedChildren[i3]=this.checkCreateAllNodes(parent2,updatedChildren[i3]);else if(currentChildrenLength>updatedChildrenLength)for(let i3=commonLength;i3<currentChildrenLength;++i3)parent2.removeChild(currentChildren[i3].node)};F.prototype.updateNodeData=function(node,currentNodeData,updatedHtml,isSvg){updateStyles(node,currentNodeData.styles,updatedHtml.nodeData.styles);updateAttributes(node,currentNodeData.attributes,updatedHtml.nodeData.attributes);updateClasses(node,currentNodeData.classes,updatedHtml.nodeData.classes,isSvg);updateProperties(node,currentNodeData.properties,updatedHtml.nodeData.properties);this.updateEvents(node,currentNodeData.events,updatedHtml)};function updateStyles(node,currentStyles,updatedStyles){if(currentStyles===void 0){if(updatedStyles!==void 0)createStyles(node,updatedStyles)}else if(updatedStyles===void 0){if(currentStyles!==void 0)node.removeAttribute("style")}else{let matchCount=0;for(let key2 in currentStyles){let current=currentStyles[key2],updated=updatedStyles[key2],hasUpdated=updatedStyles[key2]!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node.style.setProperty(key2,updated);else node.style.removeProperty(key2)}let newKeys=Object.keys(updatedStyles),newKeysLength=newKeys.length;for(let i3=0;matchCount<newKeysLength&&i3<newKeysLength;++i3){let key2=newKeys[i3];if(currentStyles[key2]===void 0){let updated=updatedStyles[key2];++matchCount;node.style.setProperty(key2,updated)}}}}function updateClasses(node,currentClasses,updatedClasses,isSvg){let classUpdated=updatedClasses!==void 0&&updatedClasses.length>0;if(currentClasses!==void 0&&currentClasses.length>0&&!classUpdated)createClasses(node,[],isSvg);else if(classUpdated)createClasses(node,updatedClasses,isSvg)}function updateAttributes(node,currentAttributes,updatedAttributes){if(currentAttributes===void 0){if(updatedAttributes!==void 0)createAttributes(node,updatedAttributes)}else if(updatedAttributes===void 0){if(currentAttributes!==void 0)for(let key2 in currentAttributes)node.removeAttribute(key2)}else{let matchCount=0;for(let key2 in currentAttributes){let current=currentAttributes[key2],updated=updatedAttributes[key2],hasUpdated=updated!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node.setAttribute(key2,updated);else node.removeAttribute(key2)}let newKeys=Object.keys(updatedAttributes),newKeysLength=newKeys.length;for(let i3=0;matchCount<newKeysLength&&i3<newKeysLength;++i3){let key2=newKeys[i3];if(currentAttributes[key2]===void 0){let updated=updatedAttributes[key2];++matchCount;node.setAttribute(key2,updated)}}}}function updateProperties(node,currentProperties,updatedProperties){let addAll=currentProperties===void 0,removeAll=updatedProperties===void 0;if(addAll){if(!removeAll)for(let key2 in updatedProperties)node[key2]=updatedProperties[key2]}else if(removeAll){if(!addAll)for(let key2 in currentProperties)node.removeAttribute(key2)}else{let matchCount=0;for(let key2 in currentProperties){let current=currentProperties[key2],updated=updatedProperties[key2],hasUpdated=updated!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node[key2]=updated;else node.removeAttribute(key2)}let newKeys=Object.keys(updatedProperties),newKeysLength=newKeys.length;for(let i3=0;matchCount<newKeysLength&&i3<newKeysLength;++i3){let key2=newKeys[i3];if(currentProperties[key2]===void 0){let updated=updatedProperties[key2];++matchCount;node[key2]=updated}}}}F.prototype.updateEvents=function(node,currentEvents,updatedHtml){let updatedEvents=updatedHtml.nodeData.events;if(currentEvents===void 0){if(updatedEvents!==void 0)this.createAllEvents(node,updatedHtml)}else if(updatedEvents===void 0){if(currentEvents!==void 0)for(let key2 in currentEvents)this.removeEvent(node,key2)}else{let matchCount=0;for(let key2 in currentEvents){let current=currentEvents[key2],updated=updatedEvents[key2],hasUpdated=false;if(updated===void 0)this.removeEvent(node,key2);else{let currentLength=current.length,updatedLength=updated.length;if(currentLength!=updatedLength)hasUpdated=true;else{for(let i3=0;i3<currentLength;++i3)if(current[i3]!=updated[i3]){hasUpdated=true;break}}}if(hasUpdated){matchCount++;this.removeEvent(node,key2);this.createEvent(node,key2,updatedHtml)}}let newKeys=Object.keys(updatedEvents),newKeysLength=newKeys.length;for(let i3=0;matchCount<newKeysLength&&i3<newKeysLength;++i3){let key2=newKeys[i3];if(currentEvents[key2]===void 0){++matchCount;this.createEvent(node,key2,updatedHtml)}}}};F.prototype.removeEvent=function(node,name15){let eventKey=eventPrefix+name15;if(nonBubblingEvents.includes(name15)){let runNonBubblingEvent=node[eventKey];node.removeEventListener(name15,runNonBubblingEvent,false)}else{let count=--this.applicationEvents.get(name15).count;if(count===0){this.root.removeEventListener(name15,this.applicationEvents.get(name15).handler,false);this.applicationEvents.delete(name15)}}node[eventKey+eventPostfix]=void 0;node[eventKey]=void 0};function lazyMessageMap(mapper,html){html.messageMapper=mapper;if(html.children!==void 0&&html.children.length>0)for(let i3=0;i3<html.children.length;++i3)lazyMessageMap(mapper,html.children[i3])}var pure3=pure(applicativeEffect);var resume=runEffectFn2(resume_);var maybeUpdater=function(updater){return function(v){if(v instanceof Just){return updater(v.value0)}return pure3(unit)}};var start=function(parent2){return function(updater){return runEffectFn4(start_)(Just.create)(parent2)(maybeUpdater(updater))}};var startFrom=function(parent2){return function(updater){return runEffectFn4(startFrom_)(Just.create)(parent2)(maybeUpdater(updater))}};var applicationIds=new Set;function checkApplicationId_(id3){if(applicationIds.has(id3))throw`Error mounting application: id ${id3} already registered!`;applicationIds.add(id3)}var Window=function(){function Window2(){}Window2.value=new Window2;return Window2}();var Document=function(){function Document2(){}Document2.value=new Document2;return Document2}();var Custom=function(){function Custom2(){}Custom2.value=new Custom2;return Custom2}();function typeOf(value13){return typeof value13}function tagOf(value13){return Object.prototype.toString.call(value13).slice(8,-1)}function isNull2(value13){return value13===null}function isUndefined(value13){return value13===void 0}var isArray=Array.isArray||function(value13){return Object.prototype.toString.call(value13)==="[object Array]"};var show3=show(showString);var show1=show(showInt);var pure4=pure(applicativeEither);var ForeignError=function(){function ForeignError2(value0){this.value0=value0}ForeignError2.create=function(value0){return new ForeignError2(value0)};return ForeignError2}();var TypeMismatch2=function(){function TypeMismatch3(value0,value1){this.value0=value0;this.value1=value1}TypeMismatch3.create=function(value0){return function(value1){return new TypeMismatch3(value0,value1)}};return TypeMismatch3}();var ErrorAtIndex=function(){function ErrorAtIndex2(value0,value1){this.value0=value0;this.value1=value1}ErrorAtIndex2.create=function(value0){return function(value1){return new ErrorAtIndex2(value0,value1)}};return ErrorAtIndex2}();var ErrorAtProperty=function(){function ErrorAtProperty2(value0,value1){this.value0=value0;this.value1=value1}ErrorAtProperty2.create=function(value0){return function(value1){return new ErrorAtProperty2(value0,value1)}};return ErrorAtProperty2}();var unsafeToForeign=unsafeCoerce2;var unsafeFromForeign=unsafeCoerce2;var showForeignError={show:function(v){if(v instanceof ForeignError){return"(ForeignError "+(show3(v.value0)+")")}if(v instanceof ErrorAtIndex){return"(ErrorAtIndex "+(show1(v.value0)+(" "+(show(showForeignError)(v.value1)+")")))}if(v instanceof ErrorAtProperty){return"(ErrorAtProperty "+(show3(v.value0)+(" "+(show(showForeignError)(v.value1)+")")))}if(v instanceof TypeMismatch2){return"(TypeMismatch "+(show3(v.value0)+(" "+(show3(v.value1)+")")))}throw new Error("Failed pattern match at Foreign (line 69, column 1 - line 73, column 89): "+[v.constructor.name])}};var fail=function(dictMonad){var $153=throwError(monadThrowExceptT(dictMonad));return function($154){return $153(singleton7($154))}};var readArray=function(dictMonad){var pure13=pure(applicativeExceptT(dictMonad));var fail1=fail(dictMonad);return function(value13){if(isArray(value13)){return pure13(unsafeFromForeign(value13))}if(otherwise){return fail1(new TypeMismatch2("array",tagOf(value13)))}throw new Error("Failed pattern match at Foreign (line 164, column 1 - line 164, column 99): "+[value13.constructor.name])}};var unsafeReadTagged=function(dictMonad){var pure13=pure(applicativeExceptT(dictMonad));var fail1=fail(dictMonad);return function(tag){return function(value13){if(tagOf(value13)===tag){return pure13(unsafeFromForeign(value13))}if(otherwise){return fail1(new TypeMismatch2(tag,tagOf(value13)))}throw new Error("Failed pattern match at Foreign (line 123, column 1 - line 123, column 104): "+[tag.constructor.name,value13.constructor.name])}}};var readBoolean=function(dictMonad){return unsafeReadTagged(dictMonad)("Boolean")};var readNumber=function(dictMonad){return unsafeReadTagged(dictMonad)("Number")};var readInt=function(dictMonad){var map21=map(dictMonad.Bind1().Apply0().Functor0());var readNumber1=readNumber(dictMonad);return function(value13){var error3=new Left(singleton7(new TypeMismatch2("Int",tagOf(value13))));var fromNumber2=function(){var $155=maybe(error3)(pure4);return function($156){return $155(fromNumber($156))}}();return mapExceptT(map21(either($$const(error3))(fromNumber2)))(readNumber1(value13))}};var readString=function(dictMonad){return unsafeReadTagged(dictMonad)("String")};var createSubscription=function(updater){return function(v){if(v.value0 instanceof Window){return createWindowListener(v.value1.value0)((function($13){return updater(v.value1.value1.value0($13))}))}if(v.value0 instanceof Document){return createDocumentListener(v.value1.value0)((function($14){return updater(v.value1.value1.value0($14))}))}if(v.value0 instanceof Custom){return createCustomListener(v.value1.value0)((function($15){return updater(v.value1.value1.value0($15))}))}throw new Error("Failed pattern match at Flame.Subscription.Internal.Listener (line 31, column 83 - line 34, column 75): "+[v.value0.constructor.name])}};var checkApplicationId=runEffectFn1(checkApplicationId_);var createMessageListener=function(appId){return function(updater){return function __do(){checkApplicationId(appId)();return createCustomListener(appId)((function($16){return updater(unsafeFromForeign($16))}))()}}};var when2=when(applicativeEffect);var for_2=for_(applicativeEffect)(foldableArray);var pure5=pure(applicativeEffect);var traverse_2=traverse_(applicativeEffect)(foldableArray);var map8=map(functorMaybe);var showId=function(dictShow){var show11=show(dictShow);return function(v){return show11(v)}};var run3=function(parent2){return function(isResumed){return function(appId){return function(v){return function __do(){var modelState=$$new(v.init.value0)();var renderingState=$$new(21)();var render2=function(model){return function __do2(){var rendering2=read(renderingState)();resume(rendering2)(v.view(model))();return write(model)(modelState)()}};var runUpdate=function(message2){return function __do2(){var currentModel=read(modelState)();var v1=v.update(currentModel)(message2);when2(modelHasChanged(currentModel)(v1.value0))(render2(v1.value0))();return runMessages(v1.value1)()}};var runMessages=function(affs){return for_2(affs)(runAff_((function(v1){if(v1 instanceof Left){return log(message(v1.value0))}if(v1 instanceof Right&&v1.value0 instanceof Just){return runUpdate(v1.value0.value0)}return pure5(unit)})))};var rendering=function(){if(isResumed){return startFrom(parent2)(runUpdate)(v.view(v.init.value0))()}return start(parent2)(runUpdate)(v.view(v.init.value0))()}();write(rendering)(renderingState)();runMessages(v.init.value1)();(function(){if(appId instanceof Nothing){return unit}if(appId instanceof Just){return createMessageListener(appId.value0)(runUpdate)()}throw new Error("Failed pattern match at Flame.Application.EffectList (line 142, column 7 - line 144, column 62): "+[appId.constructor.name])})();return traverse_2(createSubscription(runUpdate))(v.subscribe)()}}}}};var noAppId=function(){return Nothing.value}();var mountWith=function(dictShow){var showId1=showId(dictShow);return function(v){return function(appId){return function(application){return function __do(){var maybeElement=querySelector(v)();if(maybeElement instanceof Just){return run3(maybeElement.value0)(false)(map8(showId1)(appId))(application)()}if(maybeElement instanceof Nothing){return $$throw("Error mounting application")()}throw new Error("Failed pattern match at Flame.Application.EffectList (line 101, column 7 - line 103, column 62): "+[maybeElement.constructor.name])}}}}};var mountWith1=mountWith(showUnit);var mount_=function(selector){return mountWith1(selector)(noAppId)};var add2=add(semiringInt);var show4=show(showInt);var max3=max(ordInt);var min3=min(ordInt);var map9=map(functorArray);var show12=show(showArray(showInt));var SSave=function(){function SSave2(){}SSave2.value=new SSave2;return SSave2}();var SLoad=function(){function SLoad2(){}SLoad2.value=new SLoad2;return SLoad2}();var SClear=function(){function SClear2(){}SClear2.value=new SClear2;return SClear2}();var SLoadAll=function(){function SLoadAll2(){}SLoadAll2.value=new SLoadAll2;return SLoadAll2}();var Update=function(){function Update2(value0,value1,value22){this.value0=value0;this.value1=value1;this.value2=value22}Update2.create=function(value0){return function(value1){return function(value22){return new Update2(value0,value1,value22)}}};return Update2}();var Description=function(){function Description2(value0,value1){this.value0=value0;this.value1=value1}Description2.create=function(value0){return function(value1){return new Description2(value0,value1)}};return Description2}();var Bonus=function(){function Bonus2(value0,value1){this.value0=value0;this.value1=value1}Bonus2.create=function(value0){return function(value1){return new Bonus2(value0,value1)}};return Bonus2}();var DC=function(){function DC2(value0,value1){this.value0=value0;this.value1=value1}DC2.create=function(value0){return function(value1){return new DC2(value0,value1)}};return DC2}();var Roll=function(){function Roll2(value0){this.value0=value0}Roll2.create=function(value0){return new Roll2(value0)};return Roll2}();var Remove=function(){function Remove2(value0){this.value0=value0}Remove2.create=function(value0){return new Remove2(value0)};return Remove2}();var Advantage=function(){function Advantage2(value0,value1){this.value0=value0;this.value1=value1}Advantage2.create=function(value0){return function(value1){return new Advantage2(value0,value1)}};return Advantage2}();var Disadvantage=function(){function Disadvantage2(value0,value1){this.value0=value0;this.value1=value1}Disadvantage2.create=function(value0){return function(value1){return new Disadvantage2(value0,value1)}};return Disadvantage2}();var Add=function(){function Add2(){}Add2.value=new Add2;return Add2}();var AAdd=function(){function AAdd2(){}AAdd2.value=new AAdd2;return AAdd2}();var ARemove=function(){function ARemove2(value0){this.value0=value0}ARemove2.create=function(value0){return new ARemove2(value0)};return ARemove2}();var ARoll=function(){function ARoll2(value0){this.value0=value0}ARoll2.create=function(value0){return new ARoll2(value0)};return ARoll2}();var AUpdate=function(){function AUpdate2(value0,value1,value22){this.value0=value0;this.value1=value1;this.value2=value22}AUpdate2.create=function(value0){return function(value1){return function(value22){return new AUpdate2(value0,value1,value22)}}};return AUpdate2}();var Attack=function(){function Attack2(value0){this.value0=value0}Attack2.create=function(value0){return new Attack2(value0)};return Attack2}();var Save=function(){function Save2(value0){this.value0=value0}Save2.create=function(value0){return new Save2(value0)};return Save2}();var State=function(){function State2(value0){this.value0=value0}State2.create=function(value0){return new State2(value0)};return State2}();var StateSaved=function(){function StateSaved2(value0){this.value0=value0}StateSaved2.create=function(value0){return new StateSaved2(value0)};return StateSaved2}();var StateLoaded=function(){function StateLoaded2(value0){this.value0=value0}StateLoaded2.create=function(value0){return new StateLoaded2(value0)};return StateLoaded2}();var ChangeTab=function(){function ChangeTab2(value0){this.value0=value0}ChangeTab2.create=function(value0){return new ChangeTab2(value0)};return ChangeTab2}();var ChangeProfile=function(){function ChangeProfile2(value0){this.value0=value0}ChangeProfile2.create=function(value0){return new ChangeProfile2(value0)};return ChangeProfile2}();var LogMsg=function(){function LogMsg2(value0){this.value0=value0}LogMsg2.create=function(value0){return new LogMsg2(value0)};return LogMsg2}();var ClearLog=function(){function ClearLog2(){}ClearLog2.value=new ClearLog2;return ClearLog2}();var sum2=function(arr){return foldr2(add2)(0)(arr)};var saveString=function(v){return function(v1){if(v1 instanceof Just){var $15=v>=v1.value0;if($15){return"SUCCESS"}return"FAILURE"}if(v1 instanceof Nothing){return"UNKNOWN"}throw new Error("Failed pattern match at DataTypes (line 132, column 1 - line 132, column 41): "+[v.constructor.name,v1.constructor.name])}};var saveDC=function(v){if(v instanceof Nothing){return" vs Unknown DC"}if(v instanceof Just){return" vs DC "+show4(v.value0)}throw new Error("Failed pattern match at DataTypes (line 136, column 1 - line 136, column 30): "+[v.constructor.name])};var resolveAdvantage=function(adv){return function(dis){return function(rolls){if(rolls.length===2){var $20=adv&&dis;if($20){return rolls[0]}if(adv){return max3(rolls[0])(rolls[1])}if(dis){return min3(rolls[0])(rolls[1])}return rolls[0]}return 0}}};var initSave=function(){return{description:"",advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:Nothing.value}}();var initModel=function(){return{profile:"",profiles:[],currentTab:"Attack",attackRolls:[],savingThrows:[{advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:Nothing.value,description:"STR Save"},{advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:Nothing.value,description:"DEX Save"},{advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:Nothing.value,description:"CON Save"},{advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:Nothing.value,description:"INT Save"},{advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:Nothing.value,description:"WIS Save"},{advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:Nothing.value,description:"CHA Save"}],log:""}}();var initDamageDice={diceType:6,diceCount:1,damageBonus:0,damageRoll:[],damageType:"Bludgeoning"};var initAttack={attackBonus:0,advantage:false,disadvantage:false,damageDice:[],description:"",targetAC:0,attackRoll:[]};var diceDamage=function(damage){return sum2(damage.damageRoll)+damage.damageBonus|0};var attackDamage=function(attack){return sum2(map9(diceDamage)(attack.damageDice))};var advString=function(advantage){return function(disadvantage){var $25=advantage&&disadvantage;if($25){return"(Normal)"}if(advantage){return"(ADV)"}if(disadvantage){return"(DIS)"}return"(Normal)"}};var prtAttack=function(attack){var roll=resolveAdvantage(attack.advantage)(attack.disadvantage)(attack.attackRoll)+attack.attackBonus|0;return function(){var $28=roll>=attack.targetAC;if($28){return"HIT."}return"MISS."}()+(" DAMAGE: ["+(show4(attackDamage(attack))+("] "+(attack.description+(" Rolls "+(show12(attack.attackRoll)+(" "+(advString(attack.advantage)(attack.disadvantage)+(" + Bonus ["+(show4(attack.attackBonus)+("]"+(" = ["+(show4(roll)+("]"+(" vs AC ["+(show4(attack.targetAC)+"]"))))))))))))))))};var prtSave=function(save){var roll=resolveAdvantage(save.advantage)(save.disadvantage)(save.saveRoll)+save.saveBonus|0;return saveString(roll)(save.targetDC)+(" ["+(save.description+("]"+(" : Rolls "+(show12(save.saveRoll)+(" + Bonus ["+(show4(save.saveBonus)+("]"+(" = ["+(show4(roll)+("] "+(advString(save.advantage)(save.disadvantage)+saveDC(save.targetDC)))))))))))))};var createDate=function(y,m,d){var date2=new Date(Date.UTC(y,m,d));if(y>=0&&y<100){date2.setUTCFullYear(y)}return date2};function canonicalDateImpl(ctor,y,m,d){var date2=createDate(y,m-1,d);return ctor(date2.getUTCFullYear())(date2.getUTCMonth()+1)(date2.getUTCDate())}function calcWeekday(y,m,d){return createDate(y,m-1,d).getUTCDay()}var $runtime_lazy4=function(name15,moduleName,init4){var state3=0;var val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init4();state3=2;return val}};var Monday=function(){function Monday2(){}Monday2.value=new Monday2;return Monday2}();var Tuesday=function(){function Tuesday2(){}Tuesday2.value=new Tuesday2;return Tuesday2}();var Wednesday=function(){function Wednesday2(){}Wednesday2.value=new Wednesday2;return Wednesday2}();var Thursday=function(){function Thursday2(){}Thursday2.value=new Thursday2;return Thursday2}();var Friday=function(){function Friday2(){}Friday2.value=new Friday2;return Friday2}();var Saturday=function(){function Saturday2(){}Saturday2.value=new Saturday2;return Saturday2}();var Sunday=function(){function Sunday2(){}Sunday2.value=new Sunday2;return Sunday2}();var January=function(){function January2(){}January2.value=new January2;return January2}();var February=function(){function February2(){}February2.value=new February2;return February2}();var March=function(){function March2(){}March2.value=new March2;return March2}();var April=function(){function April2(){}April2.value=new April2;return April2}();var May=function(){function May2(){}May2.value=new May2;return May2}();var June=function(){function June2(){}June2.value=new June2;return June2}();var July=function(){function July2(){}July2.value=new July2;return July2}();var August=function(){function August2(){}August2.value=new August2;return August2}();var September=function(){function September2(){}September2.value=new September2;return September2}();var October=function(){function October2(){}October2.value=new October2;return October2}();var November=function(){function November2(){}November2.value=new November2;return November2}();var December=function(){function December2(){}December2.value=new December2;return December2}();var showWeekday={show:function(v){if(v instanceof Monday){return"Monday"}if(v instanceof Tuesday){return"Tuesday"}if(v instanceof Wednesday){return"Wednesday"}if(v instanceof Thursday){return"Thursday"}if(v instanceof Friday){return"Friday"}if(v instanceof Saturday){return"Saturday"}if(v instanceof Sunday){return"Sunday"}throw new Error("Failed pattern match at Data.Date.Component (line 184, column 1 - line 191, column 25): "+[v.constructor.name])}};var showMonth={show:function(v){if(v instanceof January){return"January"}if(v instanceof February){return"February"}if(v instanceof March){return"March"}if(v instanceof April){return"April"}if(v instanceof May){return"May"}if(v instanceof June){return"June"}if(v instanceof July){return"July"}if(v instanceof August){return"August"}if(v instanceof September){return"September"}if(v instanceof October){return"October"}if(v instanceof November){return"November"}if(v instanceof December){return"December"}throw new Error("Failed pattern match at Data.Date.Component (line 101, column 1 - line 113, column 29): "+[v.constructor.name])}};var ordYear=ordInt;var ordDay=ordInt;var eqWeekday={eq:function(x){return function(y){if(x instanceof Monday&&y instanceof Monday){return true}if(x instanceof Tuesday&&y instanceof Tuesday){return true}if(x instanceof Wednesday&&y instanceof Wednesday){return true}if(x instanceof Thursday&&y instanceof Thursday){return true}if(x instanceof Friday&&y instanceof Friday){return true}if(x instanceof Saturday&&y instanceof Saturday){return true}if(x instanceof Sunday&&y instanceof Sunday){return true}return false}}};var ordWeekday={compare:function(x){return function(y){if(x instanceof Monday&&y instanceof Monday){return EQ.value}if(x instanceof Monday){return LT.value}if(y instanceof Monday){return GT.value}if(x instanceof Tuesday&&y instanceof Tuesday){return EQ.value}if(x instanceof Tuesday){return LT.value}if(y instanceof Tuesday){return GT.value}if(x instanceof Wednesday&&y instanceof Wednesday){return EQ.value}if(x instanceof Wednesday){return LT.value}if(y instanceof Wednesday){return GT.value}if(x instanceof Thursday&&y instanceof Thursday){return EQ.value}if(x instanceof Thursday){return LT.value}if(y instanceof Thursday){return GT.value}if(x instanceof Friday&&y instanceof Friday){return EQ.value}if(x instanceof Friday){return LT.value}if(y instanceof Friday){return GT.value}if(x instanceof Saturday&&y instanceof Saturday){return EQ.value}if(x instanceof Saturday){return LT.value}if(y instanceof Saturday){return GT.value}if(x instanceof Sunday&&y instanceof Sunday){return EQ.value}throw new Error("Failed pattern match at Data.Date.Component (line 0, column 0 - line 0, column 0): "+[x.constructor.name,y.constructor.name])}},Eq0:function(){return eqWeekday}};var eqMonth={eq:function(x){return function(y){if(x instanceof January&&y instanceof January){return true}if(x instanceof February&&y instanceof February){return true}if(x instanceof March&&y instanceof March){return true}if(x instanceof April&&y instanceof April){return true}if(x instanceof May&&y instanceof May){return true}if(x instanceof June&&y instanceof June){return true}if(x instanceof July&&y instanceof July){return true}if(x instanceof August&&y instanceof August){return true}if(x instanceof September&&y instanceof September){return true}if(x instanceof October&&y instanceof October){return true}if(x instanceof November&&y instanceof November){return true}if(x instanceof December&&y instanceof December){return true}return false}}};var ordMonth={compare:function(x){return function(y){if(x instanceof January&&y instanceof January){return EQ.value}if(x instanceof January){return LT.value}if(y instanceof January){return GT.value}if(x instanceof February&&y instanceof February){return EQ.value}if(x instanceof February){return LT.value}if(y instanceof February){return GT.value}if(x instanceof March&&y instanceof March){return EQ.value}if(x instanceof March){return LT.value}if(y instanceof March){return GT.value}if(x instanceof April&&y instanceof April){return EQ.value}if(x instanceof April){return LT.value}if(y instanceof April){return GT.value}if(x instanceof May&&y instanceof May){return EQ.value}if(x instanceof May){return LT.value}if(y instanceof May){return GT.value}if(x instanceof June&&y instanceof June){return EQ.value}if(x instanceof June){return LT.value}if(y instanceof June){return GT.value}if(x instanceof July&&y instanceof July){return EQ.value}if(x instanceof July){return LT.value}if(y instanceof July){return GT.value}if(x instanceof August&&y instanceof August){return EQ.value}if(x instanceof August){return LT.value}if(y instanceof August){return GT.value}if(x instanceof September&&y instanceof September){return EQ.value}if(x instanceof September){return LT.value}if(y instanceof September){return GT.value}if(x instanceof October&&y instanceof October){return EQ.value}if(x instanceof October){return LT.value}if(y instanceof October){return GT.value}if(x instanceof November&&y instanceof November){return EQ.value}if(x instanceof November){return LT.value}if(y instanceof November){return GT.value}if(x instanceof December&&y instanceof December){return EQ.value}throw new Error("Failed pattern match at Data.Date.Component (line 0, column 0 - line 0, column 0): "+[x.constructor.name,y.constructor.name])}},Eq0:function(){return eqMonth}};var boundedYear=function(){return{bottom:-271820|0,top:275759,Ord0:function(){return ordYear}}}();var boundedWeekday=function(){return{bottom:Monday.value,top:Sunday.value,Ord0:function(){return ordWeekday}}}();var boundedMonth=function(){return{bottom:January.value,top:December.value,Ord0:function(){return ordMonth}}}();var boundedEnumYear={cardinality:547580,toEnum:function(n){if(n>=(-271820|0)&&n<=275759){return new Just(n)}if(otherwise){return Nothing.value}throw new Error("Failed pattern match at Data.Date.Component (line 35, column 1 - line 40, column 24): "+[n.constructor.name])},fromEnum:function(v){return v},Bounded0:function(){return boundedYear},Enum1:function(){return $lazy_enumYear(0)}};var $lazy_enumYear=$runtime_lazy4("enumYear","Data.Date.Component",(function(){return{succ:function(){var $55=toEnum(boundedEnumYear);var $56=fromEnum(boundedEnumYear);return function($57){return $55(function(v){return v+1|0}($56($57)))}}(),pred:function(){var $58=toEnum(boundedEnumYear);var $59=fromEnum(boundedEnumYear);return function($60){return $58(function(v){return v-1|0}($59($60)))}}(),Ord0:function(){return ordYear}}}));var boundedEnumWeekday={cardinality:7,toEnum:function(v){if(v===1){return new Just(Monday.value)}if(v===2){return new Just(Tuesday.value)}if(v===3){return new Just(Wednesday.value)}if(v===4){return new Just(Thursday.value)}if(v===5){return new Just(Friday.value)}if(v===6){return new Just(Saturday.value)}if(v===7){return new Just(Sunday.value)}return Nothing.value},fromEnum:function(v){if(v instanceof Monday){return 1}if(v instanceof Tuesday){return 2}if(v instanceof Wednesday){return 3}if(v instanceof Thursday){return 4}if(v instanceof Friday){return 5}if(v instanceof Saturday){return 6}if(v instanceof Sunday){return 7}throw new Error("Failed pattern match at Data.Date.Component (line 175, column 14 - line 182, column 16): "+[v.constructor.name])},Bounded0:function(){return boundedWeekday},Enum1:function(){return $lazy_enumWeekday(0)}};var $lazy_enumWeekday=$runtime_lazy4("enumWeekday","Data.Date.Component",(function(){return{succ:function(){var $61=toEnum(boundedEnumWeekday);var $62=fromEnum(boundedEnumWeekday);return function($63){return $61(function(v){return v+1|0}($62($63)))}}(),pred:function(){var $64=toEnum(boundedEnumWeekday);var $65=fromEnum(boundedEnumWeekday);return function($66){return $64(function(v){return v-1|0}($65($66)))}}(),Ord0:function(){return ordWeekday}}}));var boundedEnumMonth={cardinality:12,toEnum:function(v){if(v===1){return new Just(January.value)}if(v===2){return new Just(February.value)}if(v===3){return new Just(March.value)}if(v===4){return new Just(April.value)}if(v===5){return new Just(May.value)}if(v===6){return new Just(June.value)}if(v===7){return new Just(July.value)}if(v===8){return new Just(August.value)}if(v===9){return new Just(September.value)}if(v===10){return new Just(October.value)}if(v===11){return new Just(November.value)}if(v===12){return new Just(December.value)}return Nothing.value},fromEnum:function(v){if(v instanceof January){return 1}if(v instanceof February){return 2}if(v instanceof March){return 3}if(v instanceof April){return 4}if(v instanceof May){return 5}if(v instanceof June){return 6}if(v instanceof July){return 7}if(v instanceof August){return 8}if(v instanceof September){return 9}if(v instanceof October){return 10}if(v instanceof November){return 11}if(v instanceof December){return 12}throw new Error("Failed pattern match at Data.Date.Component (line 87, column 14 - line 99, column 19): "+[v.constructor.name])},Bounded0:function(){return boundedMonth},Enum1:function(){return $lazy_enumMonth(0)}};var $lazy_enumMonth=$runtime_lazy4("enumMonth","Data.Date.Component",(function(){return{succ:function(){var $67=toEnum(boundedEnumMonth);var $68=fromEnum(boundedEnumMonth);return function($69){return $67(function(v){return v+1|0}($68($69)))}}(),pred:function(){var $70=toEnum(boundedEnumMonth);var $71=fromEnum(boundedEnumMonth);return function($72){return $70(function(v){return v-1|0}($71($72)))}}(),Ord0:function(){return ordMonth}}}));var boundedDay={bottom:1,top:31,Ord0:function(){return ordDay}};var boundedEnumDay={cardinality:31,toEnum:function(n){if(n>=1&&n<=31){return new Just(n)}if(otherwise){return Nothing.value}throw new Error("Failed pattern match at Data.Date.Component (line 133, column 1 - line 138, column 23): "+[n.constructor.name])},fromEnum:function(v){return v},Bounded0:function(){return boundedDay},Enum1:function(){return $lazy_enumDay(0)}};var $lazy_enumDay=$runtime_lazy4("enumDay","Data.Date.Component",(function(){return{succ:function(){var $73=toEnum(boundedEnumDay);var $74=fromEnum(boundedEnumDay);return function($75){return $73(function(v){return v+1|0}($74($75)))}}(),pred:function(){var $76=toEnum(boundedEnumDay);var $77=fromEnum(boundedEnumDay);return function($78){return $76(function(v){return v-1|0}($77($78)))}}(),Ord0:function(){return ordDay}}}));var fromEnum3=fromEnum(boundedEnumMonth);var fromJust6=fromJust();var toEnum2=toEnum(boundedEnumWeekday);var toEnum22=toEnum(boundedEnumMonth);var $$Date=function(){function $$Date2(value0,value1,value22){this.value0=value0;this.value1=value1;this.value2=value22}$$Date2.create=function(value0){return function(value1){return function(value22){return new $$Date2(value0,value1,value22)}}};return $$Date2}();var year=function(v){return v.value0};var weekday=function(v){var n=calcWeekday(v.value0,fromEnum3(v.value1),v.value2);var $86=n===0;if($86){return fromJust6(toEnum2(7))}return fromJust6(toEnum2(n))};var month=function(v){return v.value1};var day=function(v){return v.value2};var canonicalDate=function(y){return function(m){return function(d){var mkDate=function(y$prime){return function(m$prime){return function(d$prime){return new $$Date(y$prime,fromJust6(toEnum22(m$prime)),d$prime)}}};return canonicalDateImpl(mkDate,y,fromEnum3(m),d)}}};var $runtime_lazy5=function(name15,moduleName,init4){var state3=0;var val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init4();state3=2;return val}};var ordSecond=ordInt;var ordMinute=ordInt;var ordMillisecond=ordInt;var ordHour=ordInt;var boundedSecond={bottom:0,top:59,Ord0:function(){return ordSecond}};var boundedMinute={bottom:0,top:59,Ord0:function(){return ordMinute}};var boundedMillisecond={bottom:0,top:999,Ord0:function(){return ordMillisecond}};var boundedHour={bottom:0,top:23,Ord0:function(){return ordHour}};var boundedEnumSecond={cardinality:60,toEnum:function(n){if(n>=0&&n<=59){return new Just(n)}if(otherwise){return Nothing.value}throw new Error("Failed pattern match at Data.Time.Component (line 90, column 1 - line 95, column 26): "+[n.constructor.name])},fromEnum:function(v){return v},Bounded0:function(){return boundedSecond},Enum1:function(){return $lazy_enumSecond(0)}};var $lazy_enumSecond=$runtime_lazy5("enumSecond","Data.Time.Component",(function(){return{succ:function(){var $36=toEnum(boundedEnumSecond);var $37=fromEnum(boundedEnumSecond);return function($38){return $36(function(v){return v+1|0}($37($38)))}}(),pred:function(){var $39=toEnum(boundedEnumSecond);var $40=fromEnum(boundedEnumSecond);return function($41){return $39(function(v){return v-1|0}($40($41)))}}(),Ord0:function(){return ordSecond}}}));var boundedEnumMinute={cardinality:60,toEnum:function(n){if(n>=0&&n<=59){return new Just(n)}if(otherwise){return Nothing.value}throw new Error("Failed pattern match at Data.Time.Component (line 61, column 1 - line 66, column 26): "+[n.constructor.name])},fromEnum:function(v){return v},Bounded0:function(){return boundedMinute},Enum1:function(){return $lazy_enumMinute(0)}};var $lazy_enumMinute=$runtime_lazy5("enumMinute","Data.Time.Component",(function(){return{succ:function(){var $42=toEnum(boundedEnumMinute);var $43=fromEnum(boundedEnumMinute);return function($44){return $42(function(v){return v+1|0}($43($44)))}}(),pred:function(){var $45=toEnum(boundedEnumMinute);var $46=fromEnum(boundedEnumMinute);return function($47){return $45(function(v){return v-1|0}($46($47)))}}(),Ord0:function(){return ordMinute}}}));var boundedEnumMillisecond={cardinality:1e3,toEnum:function(n){if(n>=0&&n<=999){return new Just(n)}if(otherwise){return Nothing.value}throw new Error("Failed pattern match at Data.Time.Component (line 120, column 1 - line 125, column 31): "+[n.constructor.name])},fromEnum:function(v){return v},Bounded0:function(){return boundedMillisecond},Enum1:function(){return $lazy_enumMillisecond(0)}};var $lazy_enumMillisecond=$runtime_lazy5("enumMillisecond","Data.Time.Component",(function(){return{succ:function(){var $48=toEnum(boundedEnumMillisecond);var $49=fromEnum(boundedEnumMillisecond);return function($50){return $48(function(v){return v+1|0}($49($50)))}}(),pred:function(){var $51=toEnum(boundedEnumMillisecond);var $52=fromEnum(boundedEnumMillisecond);return function($53){return $51(function(v){return v-1|0}($52($53)))}}(),Ord0:function(){return ordMillisecond}}}));var boundedEnumHour={cardinality:24,toEnum:function(n){if(n>=0&&n<=23){return new Just(n)}if(otherwise){return Nothing.value}throw new Error("Failed pattern match at Data.Time.Component (line 32, column 1 - line 37, column 24): "+[n.constructor.name])},fromEnum:function(v){return v},Bounded0:function(){return boundedHour},Enum1:function(){return $lazy_enumHour(0)}};var $lazy_enumHour=$runtime_lazy5("enumHour","Data.Time.Component",(function(){return{succ:function(){var $54=toEnum(boundedEnumHour);var $55=fromEnum(boundedEnumHour);return function($56){return $54(function(v){return v+1|0}($55($56)))}}(),pred:function(){var $57=toEnum(boundedEnumHour);var $58=fromEnum(boundedEnumHour);return function($59){return $57(function(v){return v-1|0}($58($59)))}}(),Ord0:function(){return ordHour}}}));var Time=function(){function Time2(value0,value1,value22,value32){this.value0=value0;this.value1=value1;this.value2=value22;this.value3=value32}Time2.create=function(value0){return function(value1){return function(value22){return function(value32){return new Time2(value0,value1,value22,value32)}}}};return Time2}();var second=function(v){return v.value2};var minute=function(v){return v.value1};var millisecond=function(v){return v.value3};var hour=function(v){return v.value0};var DateTime=function(){function DateTime2(value0,value1){this.value0=value0;this.value1=value1}DateTime2.create=function(value0){return function(value1){return new DateTime2(value0,value1)}};return DateTime2}();var createDateTime=function(y,m,d,h,mi,s,ms){var dateTime3=new Date(Date.UTC(y,m,d,h,mi,s,ms));if(y>=0&&y<100){dateTime3.setUTCFullYear(y)}return dateTime3};function fromDateTimeImpl(y,mo,d,h,mi,s,ms){return createDateTime(y,mo-1,d,h,mi,s,ms).getTime()}function toDateTimeImpl(ctor){return function(instant2){var dt=new Date(instant2);return ctor(dt.getUTCFullYear())(dt.getUTCMonth()+1)(dt.getUTCDate())(dt.getUTCHours())(dt.getUTCMinutes())(dt.getUTCSeconds())(dt.getUTCMilliseconds())}}var fromJust7=fromJust();var toEnum3=toEnum(boundedEnumMonth);var fromEnum4=fromEnum(boundedEnumMonth);var unInstant=function(v){return v};var toDateTime=function(){var mkDateTime=function(y){return function(mo){return function(d){return function(h){return function(mi){return function(s){return function(ms){return new DateTime(canonicalDate(y)(fromJust7(toEnum3(mo)))(d),new Time(h,mi,s,ms))}}}}}}};return toDateTimeImpl(mkDateTime)}();var fromDateTime=function(v){return fromDateTimeImpl(year(v.value0),fromEnum4(month(v.value0)),day(v.value0),hour(v.value1),minute(v.value1),second(v.value1),millisecond(v.value1))};var defer2=function(thunk){var v=null;return function(){if(thunk===void 0)return v;v=thunk();thunk=void 0;return v}};var force=function(l){return l()};var unwrap2=unwrap();var ParseState=function(){function ParseState2(value0,value1,value22){this.value0=value0;this.value1=value1;this.value2=value22}ParseState2.create=function(value0){return function(value1){return function(value22){return new ParseState2(value0,value1,value22)}}};return ParseState2}();var ParseError=function(){function ParseError2(value0,value1){this.value0=value0;this.value1=value1}ParseError2.create=function(value0){return function(value1){return new ParseError2(value0,value1)}};return ParseError2}();var More=function(){function More2(value0){this.value0=value0}More2.create=function(value0){return new More2(value0)};return More2}();var Lift=function(){function Lift2(value0){this.value0=value0}Lift2.create=function(value0){return new Lift2(value0)};return Lift2}();var Stop=function(){function Stop2(value0,value1){this.value0=value0;this.value1=value1}Stop2.create=function(value0){return function(value1){return new Stop2(value0,value1)}};return Stop2}();var lazyParserT={defer:function(f){var m=defer2(f);return function(state1,more,lift1,$$throw2,done){var v=force(m);return v(state1,more,lift1,$$throw2,done)}}};var functorParserT={map:function(f){return function(v){return function(state1,more,lift1,$$throw2,done){return more((function(v1){return v(state1,more,lift1,$$throw2,(function(state22,a3){return more((function(v2){return done(state22,f(a3))}))}))}))}}}};var altParserT={alt:function(v){return function(v1){return function(v2,more,lift1,$$throw2,done){return more((function(v3){return v(new ParseState(v2.value0,v2.value1,false),more,lift1,(function(v4,err){return more((function(v5){if(v4.value2){return $$throw2(v4,err)}return v1(v2,more,lift1,$$throw2,done)}))}),done)}))}}},Functor0:function(){return functorParserT}};var stateParserT=function(k){return function(state1,v,v1,v2,done){var v3=k(state1);return done(v3.value1,v3.value0)}};var runParserT$prime=function(dictMonadRec){var Monad0=dictMonadRec.Monad0();var map21=map(Monad0.Bind1().Apply0().Functor0());var pure13=pure(Monad0.Applicative0());var tailRecM3=tailRecM(dictMonadRec);return function(state1){return function(v){var go2=function($copy_step){var $tco_done=false;var $tco_result;function $tco_loop(step3){var v1=step3(unit);if(v1 instanceof More){$copy_step=v1.value0;return}if(v1 instanceof Lift){$tco_done=true;return map21(Loop.create)(v1.value0)}if(v1 instanceof Stop){$tco_done=true;return pure13(new Done(new Tuple(v1.value1,v1.value0)))}throw new Error("Failed pattern match at Parsing (line 160, column 13 - line 166, column 32): "+[v1.constructor.name])}while(!$tco_done){$tco_result=$tco_loop($copy_step)}return $tco_result};return tailRecM3(go2)((function(v1){return v(state1,More.create,Lift.create,(function(state22,err){return new Stop(state22,new Left(err))}),(function(state22,res){return new Stop(state22,new Right(res))}))}))}}};var position=stateParserT((function(v){return new Tuple(v.value1,v)}));var parseErrorPosition=function(v){return v.value1};var parseErrorMessage=function(v){return v.value0};var initialPos={index:0,line:1,column:1};var runParserT=function(dictMonadRec){var map21=map(dictMonadRec.Monad0().Bind1().Apply0().Functor0());var runParserT$prime1=runParserT$prime(dictMonadRec);return function(s){return function(p){var initialState=new ParseState(s,initialPos,false);return map21(fst)(runParserT$prime1(initialState)(p))}}};var runParserT1=runParserT(monadRecIdentity);var runParser=function(s){var $295=runParserT1(s);return function($296){return unwrap2($295($296))}};var appendConsumed=function(v){return function(v1){if(v.value2&&!v1.value2){return new ParseState(v1.value0,v1.value1,true)}return v1}};var applyParserT={apply:function(v){return function(v1){return function(state1,more,lift1,$$throw2,done){return more((function(v2){return v(state1,more,lift1,$$throw2,(function(state22,f){return more((function(v3){var state2$prime=appendConsumed(state1)(state22);return v1(state2$prime,more,lift1,$$throw2,(function(state3,a3){return more((function(v4){return done(appendConsumed(state2$prime)(state3),f(a3))}))}))}))}))}))}}},Functor0:function(){return functorParserT}};var applicativeParserT={pure:function(a3){return function(state1,v,v1,v2,done){return done(state1,a3)}},Apply0:function(){return applyParserT}};var bindParserT={bind:function(v){return function(next){return function(state1,more,lift1,$$throw2,done){return more((function(v1){return v(state1,more,lift1,$$throw2,(function(state22,a3){return more((function(v2){var v3=next(a3);return v3(appendConsumed(state1)(state22),more,lift1,$$throw2,done)}))}))}))}}},Apply0:function(){return applyParserT}};var bindFlipped3=bindFlipped(bindParserT);var monadParserT={Applicative0:function(){return applicativeParserT},Bind1:function(){return bindParserT}};var monadThrowParseErrorParse={throwError:function(err){return function(state1,v,v1,$$throw2,v2){return $$throw2(state1,err)}},Monad0:function(){return monadParserT}};var throwError2=throwError(monadThrowParseErrorParse);var failWithPosition=function(message2){return function(pos){return throwError2(new ParseError(message2,pos))}};var fail2=function(message2){return bindFlipped3(failWithPosition(message2))(position)};var plusParserT={empty:fail2("No alternative"),Alt0:function(){return altParserT}};var alternativeParserT={Applicative0:function(){return applicativeParserT},Plus1:function(){return plusParserT}};var alt2=alt(altParserT);var defer3=defer(lazyParserT);var empty4=empty(plusParserT);var withLazyErrorMessage=function(p){return function(msg){return alt2(p)(defer3((function(v){return fail2("Expected "+msg(unit))})))}};var $$try4=function(v){return function(v1,more,lift3,$$throw2,done){return v(v1,more,lift3,(function(v2,err){return $$throw2(new ParseState(v2.value0,v2.value1,v1.value2),err)}),done)}};var choice=function(dictFoldable){var go2=function(p1){return function(v){if(v instanceof Nothing){return new Just(p1)}if(v instanceof Just){return new Just(alt2(p1)(v.value0))}throw new Error("Failed pattern match at Parsing.Combinators (line 362, column 11 - line 364, column 32): "+[v.constructor.name])}};var $95=fromMaybe(empty4);var $96=foldr(dictFoldable)(go2)(Nothing.value);return function($97){return $95($96($97))}};var fromEnum5=fromEnum(boundedEnumCodePoint);var mod3=mod(euclideanRingInt);var fromJust8=fromJust();var toEnum4=toEnum(boundedEnumChar);var show13=show(showString);var updatePosSingle=function(v){return function(cp){return function(after){var v1=fromEnum5(cp);if(v1===10){return{index:v.index+1|0,line:v.line+1|0,column:1}}if(v1===13){var v2=codePointAt(0)(after);if(v2 instanceof Just&&fromEnum5(v2.value0)===10){return{index:v.index+1|0,line:v.line,column:v.column}}return{index:v.index+1|0,line:v.line+1|0,column:1}}if(v1===9){return{index:v.index+1|0,line:v.line,column:(v.column+8|0)-mod3(v.column-1|0)(8)|0}}return{index:v.index+1|0,line:v.line,column:v.column+1|0}}}};var updatePosString=function($copy_pos){return function($copy_before){return function($copy_after){var $tco_var_pos=$copy_pos;var $tco_var_before=$copy_before;var $tco_done=false;var $tco_result;function $tco_loop(pos,before,after){var v=uncons2(before);if(v instanceof Nothing){$tco_done=true;return pos}if(v instanceof Just){var newPos=function(){if($$null(v.value0.tail)){return updatePosSingle(pos)(v.value0.head)(after)}if(otherwise){return updatePosSingle(pos)(v.value0.head)(v.value0.tail)}throw new Error("Failed pattern match at Parsing.String (line 165, column 7 - line 167, column 52): "+[])}();$tco_var_pos=newPos;$tco_var_before=v.value0.tail;$copy_after=after;return}throw new Error("Failed pattern match at Parsing.String (line 161, column 36 - line 168, column 38): "+[v.constructor.name])}while(!$tco_done){$tco_result=$tco_loop($tco_var_pos,$tco_var_before,$copy_after)}return $tco_result}}};var satisfy=function(f){return mkFn5((function(v){return function(v1){return function(v2){return function($$throw2){return function(done){var v3=uncons2(v.value0);if(v3 instanceof Nothing){return $$throw2(v,new ParseError("Unexpected EOF",v.value1))}if(v3 instanceof Just){var cp=fromEnum5(v3.value0.head);var $85=cp<0||cp>65535;if($85){return $$throw2(v,new ParseError("Expected Char",v.value1))}var ch=fromJust8(toEnum4(cp));var $86=f(ch);if($86){return done(new ParseState(v3.value0.tail,updatePosSingle(v.value1)(v3.value0.head)(v3.value0.tail),true),ch)}return $$throw2(v,new ParseError("Predicate unsatisfied",v.value1))}throw new Error("Failed pattern match at Parsing.String (line 114, column 7 - line 129, column 75): "+[v3.constructor.name])}}}}}))};var eof=mkFn5((function(v){return function(v1){return function(v2){return function($$throw2){return function(done){var $133=$$null(v.value0);if($133){return done(new ParseState(v.value0,v.value1,true),unit)}return $$throw2(v,new ParseError("Expected EOF",v.value1))}}}}}));var consumeWith=function(f){return mkFn5((function(v){return function(v1){return function(v2){return function($$throw2){return function(done){var v3=f(v.value0);if(v3 instanceof Left){return $$throw2(v,new ParseError(v3.value0,v.value1))}if(v3 instanceof Right){return done(new ParseState(v3.value0.remainder,updatePosString(v.value1)(v3.value0.consumed)(v3.value0.remainder),!$$null(v3.value0.consumed)),v3.value0.value)}throw new Error("Failed pattern match at Parsing.String (line 286, column 7 - line 290, column 121): "+[v3.constructor.name])}}}}}))};var string=function(str){return consumeWith((function(input3){var v=stripPrefix(str)(input3);if(v instanceof Just){return new Right({value:str,consumed:str,remainder:v.value0})}return new Left("Expected "+show13(str))}))};var show5=show(showInt);var lmap2=lmap(bifunctorEither);var applyFirst2=applyFirst(applyParserT);var voidLeft2=voidLeft(functorParserT);var printPosition=function(v){return"(line "+(show5(v.line)+(", col "+(show5(v.column)+")")))};var printError=function(err){return parseErrorMessage(err)+(" "+printPosition(parseErrorPosition(err)))};var runP=function(p){return function(s){return lmap2(printError)(runParser(s)(applyFirst2(p)(eof)))}};var oneOfAs=function(dictFunctor){var map21=map(dictFunctor);return function(dictFoldable){var choice2=choice(dictFoldable);return function(dictMonad){return function(p){return function(xs){return choice2(map21((function(v){return voidLeft2(p(v.value0))(v.value1)}))(xs))}}}}};var show14=show(showArray(showChar));var notElem1=notElem2(eqChar);var noneOf=function(ss){return withLazyErrorMessage(satisfy(flip(notElem1)(ss)))((function(v){return"none of "+show14(ss)}))};var show6=show(showInt);var foldMap2=foldMap(foldableList);var foldMap12=foldMap2(monoidString);var mapFlipped2=mapFlipped(functorParserT);var oneOfAs2=oneOfAs(functorArray)(foldableArray);var map10=map(functorParserT);var abs3=abs(ordInt)(ringInt);var some3=some2(alternativeParserT)(lazyParserT);var fromEnum6=fromEnum(boundedEnumYear);var show15=show(showMonth);var fromEnum1=fromEnum(boundedEnumMonth);var fromEnum22=fromEnum(boundedEnumDay);var unwrap3=unwrap();var fromEnum32=fromEnum(boundedEnumWeekday);var show22=show(showWeekday);var fromEnum42=fromEnum(boundedEnumHour);var mod4=mod(euclideanRingInt);var fromEnum52=fromEnum(boundedEnumMinute);var fromEnum62=fromEnum(boundedEnumSecond);var fromEnum7=fromEnum(boundedEnumMillisecond);var div1=div(euclideanRingInt);var mapFlipped1=mapFlipped(functorEither);var YearFull=function(){function YearFull2(){}YearFull2.value=new YearFull2;return YearFull2}();var YearTwoDigits=function(){function YearTwoDigits2(){}YearTwoDigits2.value=new YearTwoDigits2;return YearTwoDigits2}();var YearAbsolute=function(){function YearAbsolute2(){}YearAbsolute2.value=new YearAbsolute2;return YearAbsolute2}();var MonthFull=function(){function MonthFull2(){}MonthFull2.value=new MonthFull2;return MonthFull2}();var MonthShort=function(){function MonthShort2(){}MonthShort2.value=new MonthShort2;return MonthShort2}();var MonthTwoDigits=function(){function MonthTwoDigits2(){}MonthTwoDigits2.value=new MonthTwoDigits2;return MonthTwoDigits2}();var DayOfMonthTwoDigits=function(){function DayOfMonthTwoDigits2(){}DayOfMonthTwoDigits2.value=new DayOfMonthTwoDigits2;return DayOfMonthTwoDigits2}();var DayOfMonth=function(){function DayOfMonth2(){}DayOfMonth2.value=new DayOfMonth2;return DayOfMonth2}();var UnixTimestamp=function(){function UnixTimestamp2(){}UnixTimestamp2.value=new UnixTimestamp2;return UnixTimestamp2}();var DayOfWeek=function(){function DayOfWeek2(){}DayOfWeek2.value=new DayOfWeek2;return DayOfWeek2}();var DayOfWeekName=function(){function DayOfWeekName2(){}DayOfWeekName2.value=new DayOfWeekName2;return DayOfWeekName2}();var DayOfWeekNameShort=function(){function DayOfWeekNameShort2(){}DayOfWeekNameShort2.value=new DayOfWeekNameShort2;return DayOfWeekNameShort2}();var Hours24=function(){function Hours242(){}Hours242.value=new Hours242;return Hours242}();var Hours12=function(){function Hours122(){}Hours122.value=new Hours122;return Hours122}();var Meridiem=function(){function Meridiem2(){}Meridiem2.value=new Meridiem2;return Meridiem2}();var Minutes=function(){function Minutes2(){}Minutes2.value=new Minutes2;return Minutes2}();var MinutesTwoDigits=function(){function MinutesTwoDigits2(){}MinutesTwoDigits2.value=new MinutesTwoDigits2;return MinutesTwoDigits2}();var Seconds=function(){function Seconds2(){}Seconds2.value=new Seconds2;return Seconds2}();var SecondsTwoDigits=function(){function SecondsTwoDigits2(){}SecondsTwoDigits2.value=new SecondsTwoDigits2;return SecondsTwoDigits2}();var Milliseconds2=function(){function Milliseconds3(){}Milliseconds3.value=new Milliseconds3;return Milliseconds3}();var MillisecondsShort=function(){function MillisecondsShort2(){}MillisecondsShort2.value=new MillisecondsShort2;return MillisecondsShort2}();var MillisecondsTwoDigits=function(){function MillisecondsTwoDigits2(){}MillisecondsTwoDigits2.value=new MillisecondsTwoDigits2;return MillisecondsTwoDigits2}();var Placeholder=function(){function Placeholder2(value0){this.value0=value0}Placeholder2.create=function(value0){return new Placeholder2(value0)};return Placeholder2}();var printShortMonth=function(v){if(v instanceof January){return"Jan"}if(v instanceof February){return"Feb"}if(v instanceof March){return"Mar"}if(v instanceof April){return"Apr"}if(v instanceof May){return"May"}if(v instanceof June){return"Jun"}if(v instanceof July){return"Jul"}if(v instanceof August){return"Aug"}if(v instanceof September){return"Sep"}if(v instanceof October){return"Oct"}if(v instanceof November){return"Nov"}if(v instanceof December){return"Dec"}throw new Error("Failed pattern match at Data.Formatter.DateTime (line 489, column 19 - line 501, column 22): "+[v.constructor.name])};var placeholderContent=mapFlipped2(some(alternativeParserT)(lazyParserT)(noneOf(toCharArray("YMDEHhamsS"))))(fromCharArray);var padSingleDigit=function(i3){if(i3<0){return"-"+padSingleDigit(-i3|0)}if(i3<10){return"0"+show6(i3)}if(otherwise){return show6(i3)}throw new Error("Failed pattern match at Data.Formatter.DateTime (line 194, column 1 - line 194, column 32): "+[i3.constructor.name])};var padQuadrupleDigit=function(i3){if(i3<0){return"-"+padQuadrupleDigit(-i3|0)}if(i3<10){return"000"+show6(i3)}if(i3<100){return"00"+show6(i3)}if(i3<1e3){return"0"+show6(i3)}if(otherwise){return show6(i3)}throw new Error("Failed pattern match at Data.Formatter.DateTime (line 207, column 1 - line 207, column 35): "+[i3.constructor.name])};var padDoubleDigit=function(i3){if(i3<0){return"-"+padDoubleDigit(-i3|0)}if(i3<10){return"00"+show6(i3)}if(i3<100){return"0"+show6(i3)}if(otherwise){return show6(i3)}throw new Error("Failed pattern match at Data.Formatter.DateTime (line 200, column 1 - line 200, column 32): "+[i3.constructor.name])};var formatterCommandParser=function(){return alt(altParserT)(oneOfAs2(monadIdentity)((function($664){return $$try4(string($664))}))([new Tuple("YYYY",YearFull.value),new Tuple("YY",YearTwoDigits.value),new Tuple("Y",YearAbsolute.value),new Tuple("MMMM",MonthFull.value),new Tuple("MMM",MonthShort.value),new Tuple("MM",MonthTwoDigits.value),new Tuple("DD",DayOfMonthTwoDigits.value),new Tuple("D",DayOfMonth.value),new Tuple("E",DayOfWeek.value),new Tuple("X",UnixTimestamp.value),new Tuple("dddd",DayOfWeekName.value),new Tuple("ddd",DayOfWeekNameShort.value),new Tuple("HH",Hours24.value),new Tuple("hh",Hours12.value),new Tuple("a",Meridiem.value),new Tuple("mm",MinutesTwoDigits.value),new Tuple("m",Minutes.value),new Tuple("ss",SecondsTwoDigits.value),new Tuple("s",Seconds.value),new Tuple("SSS",Milliseconds2.value),new Tuple("SS",MillisecondsTwoDigits.value),new Tuple("S",MillisecondsShort.value)]))(map10(Placeholder.create)(placeholderContent))}();var formatYearTwoDigits=function(i3){var dateString=show6(abs3(i3));var dateLength=length3(dateString);if(dateLength===1){return"0"+dateString}if(dateLength===2){return dateString}return drop2(dateLength-2|0)(dateString)};var formatParser=some3(formatterCommandParser);var parseFormatString=runP(formatParser);var fix12=function(h){var $618=h===0;if($618){return 12}return h};var formatCommand=function(v){return function(v1){if(v1 instanceof YearFull){return padQuadrupleDigit(fromEnum6(year(v.value0)))}if(v1 instanceof YearTwoDigits){return formatYearTwoDigits(fromEnum6(year(v.value0)))}if(v1 instanceof YearAbsolute){return show6(fromEnum6(year(v.value0)))}if(v1 instanceof MonthFull){return show15(month(v.value0))}if(v1 instanceof MonthShort){return printShortMonth(month(v.value0))}if(v1 instanceof MonthTwoDigits){return padSingleDigit(fromEnum1(month(v.value0)))}if(v1 instanceof DayOfMonthTwoDigits){return padSingleDigit(fromEnum22(day(v.value0)))}if(v1 instanceof DayOfMonth){return show6(fromEnum22(day(v.value0)))}if(v1 instanceof UnixTimestamp){return show6(floor2(function(v2){return v2/1e3}(unwrap3(unInstant(fromDateTime(v))))))}if(v1 instanceof DayOfWeek){return show6(fromEnum32(weekday(v.value0)))}if(v1 instanceof DayOfWeekName){return show22(weekday(v.value0))}if(v1 instanceof DayOfWeekNameShort){return take2(3)(show22(weekday(v.value0)))}if(v1 instanceof Hours24){return padSingleDigit(fromEnum42(hour(v.value1)))}if(v1 instanceof Hours12){return padSingleDigit(fix12(mod4(fromEnum42(hour(v.value1)))(12)))}if(v1 instanceof Meridiem){var $621=fromEnum42(hour(v.value1))>=12;if($621){return"PM"}return"AM"}if(v1 instanceof Minutes){return show6(fromEnum52(minute(v.value1)))}if(v1 instanceof MinutesTwoDigits){return padSingleDigit(fromEnum52(minute(v.value1)))}if(v1 instanceof Seconds){return show6(fromEnum62(second(v.value1)))}if(v1 instanceof SecondsTwoDigits){return padSingleDigit(fromEnum62(second(v.value1)))}if(v1 instanceof Milliseconds2){return padDoubleDigit(fromEnum7(millisecond(v.value1)))}if(v1 instanceof MillisecondsShort){return show6(function(v2){return div1(v2)(100)}(fromEnum7(millisecond(v.value1))))}if(v1 instanceof MillisecondsTwoDigits){return padSingleDigit(function(v2){return div1(v2)(10)}(fromEnum7(millisecond(v.value1))))}if(v1 instanceof Placeholder){return v1.value0}throw new Error("Failed pattern match at Data.Formatter.DateTime (line 169, column 38 - line 192, column 21): "+[v1.constructor.name])}};var format=function(f){return function(d){return foldMap12(formatCommand(d))(f)}};var formatDateTime=function(pattern2){return function(datetime){return mapFlipped1(parseFormatString(pattern2))((function(v){return format(v)(datetime)}))}};function now(){return Date.now()}var map11=map(functorEffect);var nowDateTime=map11(toDateTime)(now);var random=Math.random;var randomInt=function(low2){return function(high2){return function __do(){var n=random();var asNumber=(toNumber(high2)-toNumber(low2)+1)*n+toNumber(low2);return floor2(asNumber)}}};var messageEventData=5;var rawEventData=6;function createEvent_(name15){return function(message2){return[messageEventData,name15,message2]}}function createRawEvent_(name15){return function(handler){return[rawEventData,name15,handler]}}function nodeValue_(event){if(event.target.contentEditable===true||event.target.contentEditable==="true"||event.target.contentEditable==="")return event.target.innerText;return event.target.value}function checkedValue_(event){if(event.target.tagName==="INPUT"&&(event.target.type==="checkbox"||event.target.type==="radio"))return event.target.checked;return false}var map12=map(functorEffect);var nodeValue=runEffectFn1(nodeValue_);var createRawEvent=function(name15){return function(handler){return createRawEvent_(name15)(handler)}};var onInput=function(constructor){var handler=function(event){return map12((function($6){return Just.create(constructor($6))}))(nodeValue(event))};return createRawEvent("input")(handler)};var createEvent=function(name15){return function(message2){return createEvent_(name15)(message2)}};var onClick=createEvent("click");var checkedValue=runEffectFn1(checkedValue_);var onCheck=function(constructor){var handler=function(event){return map12((function($9){return Just.create(constructor($9))}))(checkedValue(event))};return createRawEvent("input")(handler)};var toNodeArray2=toNodeArray(toNodeNodeDataNodeData);var toNodeArray1=toNodeArray(toNodeHtmlHtml);var div4=div3(toNodeArray2)(toNodeArray1);var class$prime2=class$prime(toClassListString);var input2=input(toNodeArray2);var span4=span(toNodeArray2)(toNodeArray1);var button2=button(toNodeArray2)(toNodeArray1);var label2=label(toNodeArray2)(toNodeArray1);var i2=i(toNodeArray2)(toNodeArray1);var pure6=pure(applicativeEffect);var show7=show(showInt);var updateArray=function(dictEq){var eq3=eq(dictEq);return function(arr){return function(item){return function(newItem){var v=findIndex((function(x){return eq3(x)(item)}))(arr);if(v instanceof Nothing){return arr}if(v instanceof Just){var v1=updateAt(v.value0)(newItem)(arr);if(v1 instanceof Nothing){return arr}if(v1 instanceof Just){return v1.value0}throw new Error("Failed pattern match at Utils (line 41, column 17 - line 43, column 28): "+[v1.constructor.name])}throw new Error("Failed pattern match at Utils (line 39, column 3 - line 43, column 28): "+[v.constructor.name])}}}};var rollDice=function(n){return randomInt(1)(n)};var mkText=function(caption){return function(msg){return function(value13){return div4([class$prime2("small field border")])([input2([type$prime("small text"),value(value13),onInput(msg)]),span4([class$prime2("small helper")])([text(caption)])])}}};var mkProfileText=function(msg){return function(value13){return div4([class$prime2("small field border middle-align margin-top")])([input2([type$prime("text"),class$prime2("white"),value(value13),onInput(msg)])])}};var mkProfileButton=function(caption){return function(msg){return button2([class$prime2("small-round"),onClick(msg)])([text(caption)])}};var mkCheckbox=function(caption){return function(icon){return function(dirn){return function(msg){return function(value13){return label2([class$prime2("small switch icon")])([input2([class$prime2("small"),type$prime("checkbox"),checked(value13),onCheck(msg)]),span4([class$prime2("small")])([i2([class$prime2("small")])([text(icon)])]),div4([class$prime2("small tooltip "+dirn)])([text(caption)])])}}}}};var mkButton=function(msg){return function(icon){return function(tooltip){return button2([class$prime2("small square round extra"),onClick(msg)])([i2([class$prime2("small")])([text(icon)]),div4([class$prime2("small tooltip left")])([text(tooltip)])])}}};var mapM=function(f){return function(xs){var v=uncons(xs);if(v instanceof Nothing){return pure6([])}if(v instanceof Just){return function __do(){var z=f(v.value0.head)();var zs=mapM(f)(v.value0.tail)();return cons(z)(zs)}}throw new Error("Failed pattern match at Utils (line 20, column 3 - line 25, column 22): "+[v.constructor.name])}};var fromStr=function(s){var v=fromString(s);if(v instanceof Nothing){return 0}if(v instanceof Just){return v.value0}throw new Error("Failed pattern match at Utils (line 77, column 3 - line 79, column 17): "+[v.constructor.name])};var mkNumber=function(v){return function(v1){return function(v2){if(v2 instanceof Just){return div4([class$prime2("small field border")])([input2([type$prime("small number"),value(show7(v2.value0)),onInput((function(x){return v1(fromStr(x))}))]),span4([class$prime2("small helper")])([text(v)])])}if(v2 instanceof Nothing){return div4([class$prime2("small field border")])([input2([type$prime("small number"),onInput((function(x){return v1(fromStr(x))}))]),span4([class$prime2("small helper")])([text(v)])])}throw new Error("Failed pattern match at Utils (line 63, column 1 - line 63, column 66): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}};var formatLogMsg=function(msg){return function __do(){var dt=nowDateTime();var v=formatDateTime("[DD-MM-YYYY hh:mm:ss] ")(dt);if(v instanceof Left){return"[??-??-???? ??:??:??] "+(msg+"\n")}if(v instanceof Right){return v.value0+(msg+"\n")}throw new Error("Failed pattern match at Utils (line 99, column 3 - line 101, column 39): "+[v.constructor.name])}};var fjust=function(v){return function(v1){if(v instanceof Nothing){return v1}if(v instanceof Just){return cons(v.value0)(v1)}throw new Error("Failed pattern match at Utils (line 30, column 1 - line 30, column 49): "+[v.constructor.name,v1.constructor.name])}};var justs=function(xs){return foldr2(fjust)([])(xs)};var toNodeArray3=toNodeArray(toNodeNodeDataNodeData);var toNodeArray12=toNodeArray(toNodeHtmlHtml);var div5=div3(toNodeArray3)(toNodeArray12);var class$prime3=class$prime(toClassListString);var eqRec2=eqRec();var eqRowCons2=eqRowCons(eqRowNil)();var eqArray2=eqArray(eqInt);var eqRec1=eqRec2(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons2({reflectSymbol:function(){return"diceType"}})(eqInt))()({reflectSymbol:function(){return"diceCount"}})(eqInt))()({reflectSymbol:function(){return"damageType"}})(eqString))()({reflectSymbol:function(){return"damageRoll"}})(eqArray2))()({reflectSymbol:function(){return"damageBonus"}})(eqInt));var updateArray2=updateArray(eqRec1);var show8=show(showArray(showInt));var $$delete3=$$delete(eqRec1);var eq2=eq(eqArray2);var show16=show(showInt);var article_2=article_(toNodeArray12);var h62=h6(toNodeArray3)(toNodeArray12);var map13=map(functorArray);var pure1=pure(applicativeAff);var eqRec22=eqRec2(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons2({reflectSymbol:function(){return"targetAC"}})(eqInt))()({reflectSymbol:function(){return"disadvantage"}})(eqBoolean))()({reflectSymbol:function(){return"description"}})(eqString))()({reflectSymbol:function(){return"damageDice"}})(eqArray(eqRec1)))()({reflectSymbol:function(){return"attackRoll"}})(eqArray2))()({reflectSymbol:function(){return"attackBonus"}})(eqInt))()({reflectSymbol:function(){return"advantage"}})(eqBoolean));var delete1=$$delete(eqRec22);var updateArray1=updateArray(eqRec22);var map1=map(functorAff);var liftEffect3=liftEffect(monadEffectAff);var viewDice=function(attack){return function(damage){return div5([class$prime3("small s12 grid")])([div5([class$prime3("small s2")])([mkNumber("Dice Count")((function(d){return new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:updateArray2(attack.damageDice)(damage)({diceType:damage.diceType,damageBonus:damage.damageBonus,damageRoll:damage.damageRoll,damageType:damage.damageType,diceCount:d})}))}))(new Just(damage.diceCount))]),div5([class$prime3("small s2")])([mkNumber("Dice Type")((function(d){return new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:updateArray2(attack.damageDice)(damage)({diceCount:damage.diceCount,damageBonus:damage.damageBonus,damageRoll:damage.damageRoll,damageType:damage.damageType,diceType:d})}))}))(new Just(damage.diceType))]),div5([class$prime3("small s2")])([mkNumber("Damage Bonus")((function(d){return new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:updateArray2(attack.damageDice)(damage)({diceType:damage.diceType,diceCount:damage.diceCount,damageRoll:damage.damageRoll,damageType:damage.damageType,damageBonus:d})}))}))(new Just(damage.damageBonus))]),div5([class$prime3("small s2")])([mkText("Damage Type")((function(d){return new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:updateArray2(attack.damageDice)(damage)({diceType:damage.diceType,diceCount:damage.diceCount,damageBonus:damage.damageBonus,damageRoll:damage.damageRoll,damageType:d})}))}))(damage.damageType)]),div5([class$prime3("small s3")])([text("Rolls: "+show8(damage.damageRoll))]),div5([class$prime3("small s1")])([mkButton(new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:$$delete3(damage)(attack.damageDice)})))("delete")("Remove Saving Throw")])])}};var viewAttackResult=function(attack){var roll=resolveAdvantage(attack.advantage)(attack.disadvantage)(attack.attackRoll)+attack.attackBonus|0;var $113=eq2(attack.attackRoll)([]);if($113){return div5([class$prime3("grid small s11")])([text("")])}var $114=attack.targetAC===0;if($114){return div5([class$prime3("grid small s11")])([div5([class$prime3("s2")])([text("Rolls: "),text(show8(attack.attackRoll))]),div5([class$prime3("s4")])([text("Attack Roll: "),text(show16(resolveAdvantage(attack.advantage)(attack.disadvantage)(attack.attackRoll)+attack.attackBonus|0))]),div5([class$prime3("s2")])([text("Damage: "),text(show16(attackDamage(attack)))])])}var $115=roll>=attack.targetAC;if($115){return div5([class$prime3("grid small s11")])([div5([class$prime3("s2")])([text("Rolls: "),text(show8(attack.attackRoll))]),div5([class$prime3("s2")])([text("Attack Roll: "),text(show16(resolveAdvantage(attack.advantage)(attack.disadvantage)(attack.attackRoll)+attack.attackBonus|0))]),div5([class$prime3("s2")])([text("Target AC: "),text(show16(attack.targetAC))]),div5([class$prime3("s2")])([text("Damage: "),text(show16(attackDamage(attack)))]),div5([class$prime3("s2 primary center-align")])([text("Hit!")])])}return div5([class$prime3("grid small s11")])([div5([class$prime3("s2")])([text("Rolls: "),text(show8(attack.attackRoll))]),div5([class$prime3("s2")])([text("Attack Roll: "),text(show16(resolveAdvantage(attack.advantage)(attack.disadvantage)(attack.attackRoll)+attack.attackBonus|0))]),div5([class$prime3("s2")])([text("Target AC: "),text(show16(attack.targetAC))]),div5([class$prime3("s2")])([text("Damage: "),text(show16(attackDamage(attack)))]),div5([class$prime3("s2 error center-align")])([text("Miss!")])])};var viewAttackRoll=function(attack){return article_2([div5([class$prime3("small grid")])([div5([class$prime3("small s5")])([mkText("Description")((function(s){return new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,damageDice:attack.damageDice,targetAC:attack.targetAC,attackRoll:attack.attackRoll,description:s}))}))(attack.description)]),div5([class$prime3("small s1")])([mkCheckbox("Advantage")("arrow_upward")("bottom")((function(b){return new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,disadvantage:attack.disadvantage,damageDice:attack.damageDice,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,advantage:b}))}))(attack.advantage)]),div5([class$prime3("small s1")])([mkCheckbox("Disadvantage")("arrow_downward")("bottom")((function(b){return new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,damageDice:attack.damageDice,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,disadvantage:b}))}))(attack.disadvantage)]),div5([class$prime3("small s2")])([mkNumber("Attack Bonus")((function(b){return new Attack(new AUpdate(false,attack,{advantage:attack.advantage,disadvantage:attack.disadvantage,damageDice:attack.damageDice,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,attackBonus:b}))}))(new Just(attack.attackBonus))]),div5([class$prime3("small s2")])([mkNumber("Target AC")((function(b){return new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,damageDice:attack.damageDice,description:attack.description,attackRoll:attack.attackRoll,targetAC:b}))}))(new Just(attack.targetAC))]),div5([class$prime3("small s1")])([mkButton(new Attack(new ARemove(attack)))("delete")("Remove Attack Roll")]),div5([class$prime3("small s11 fill grid middle-align")])([h62([class$prime3("small s11 padding")])([text("Damage Dice")]),div5([class$prime3("small s1")])([mkButton(new Attack(new AUpdate(false,attack,{attackBonus:attack.attackBonus,advantage:attack.advantage,disadvantage:attack.disadvantage,description:attack.description,targetAC:attack.targetAC,attackRoll:attack.attackRoll,damageDice:snoc(attack.damageDice)(initDamageDice)})))("add")("Add Attack Roll")])]),div5([class$prime3("small s1")])([mkButton(new Attack(new ARoll(attack)))("Casino")("Roll The Dice!")]),div5([class$prime3("small s11 grid")])(map13(viewDice(attack))(attack.damageDice)),viewAttackResult(attack)])])};var rollAttackDamage=function(damage){return function __do(){var rolls=mapM((function(v){return rollDice(damage.diceType)}))(range2(1)(damage.diceCount))();return{damageBonus:damage.damageBonus,damageType:damage.damageType,diceCount:damage.diceCount,diceType:damage.diceType,damageRoll:rolls}}};var rollAttack=function(attack){return function __do(){var a3=rollDice(20)();var b=rollDice(20)();var dmg=mapM(rollAttackDamage)(attack.damageDice)();return{advantage:attack.advantage,attackBonus:attack.attackBonus,description:attack.description,disadvantage:attack.disadvantage,targetAC:attack.targetAC,attackRoll:[a3,b],damageDice:dmg}}};var logAttack=function(attack){return formatLogMsg("ATTACK: "+prtAttack(attack))};var updateAttack=function(v){return function(v1){if(v1 instanceof AAdd){return new Tuple({currentTab:v.currentTab,log:v.log,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,attackRolls:snoc(v.attackRolls)(initAttack)},[pure1(new Just(new State(SSave.value)))])}if(v1 instanceof ARemove){return new Tuple({currentTab:v.currentTab,log:v.log,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,attackRolls:delete1(v1.value0)(v.attackRolls)},[pure1(new Just(new State(SSave.value)))])}if(v1 instanceof AUpdate){return new Tuple({currentTab:v.currentTab,log:v.log,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,attackRolls:updateArray1(v.attackRolls)(v1.value1)(v1.value2)},function(){if(v1.value0){return[map1((function($124){return Just.create(LogMsg.create($124))}))(liftEffect3(logAttack(v1.value2))),pure1(new Just(new State(SSave.value)))]}return[pure1(new Just(new State(SSave.value)))]}())}if(v1 instanceof ARoll){return new Tuple(v,[map1((function($125){return Just.create(Attack.create($125))}))(map1(AUpdate.create(true)(v1.value0))(liftEffect3(rollAttack(v1.value0))))])}throw new Error("Failed pattern match at AttackRolls (line 17, column 1 - line 17, column 79): "+[v.constructor.name,v1.constructor.name])}};var max4=max(ordInt);var min4=min(ordInt);var toNodeArray4=toNodeArray(toNodeNodeDataNodeData);var toNodeArray13=toNodeArray(toNodeHtmlHtml);var div6=div3(toNodeArray4)(toNodeArray13);var class$prime4=class$prime(toClassListString);var show9=show(showInt);var div_2=div_(toNodeArray13);var article_3=article_(toNodeArray13);var nav2=nav(toNodeArray4)(toNodeArray13);var eqRec3=eqRec()(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowNil)()({reflectSymbol:function(){return"targetDC"}})(eqMaybe(eqInt)))()({reflectSymbol:function(){return"saveRoll"}})(eqArray(eqInt)))()({reflectSymbol:function(){return"saveBonus"}})(eqInt))()({reflectSymbol:function(){return"disadvantage"}})(eqBoolean))()({reflectSymbol:function(){return"description"}})(eqString))()({reflectSymbol:function(){return"advantage"}})(eqBoolean));var updateArray3=updateArray(eqRec3);var map14=map(functorAff);var liftEffect4=liftEffect(monadEffectAff);var pure12=pure(applicativeAff);var $$delete4=$$delete(eqRec3);var saveRoll=function(save){if(save.saveRoll.length===2){var $71=[save.advantage,save.disadvantage];if($71.length===2&&($71[0]&&!$71[1])){return max4(save["saveRoll"][0])(save["saveRoll"][1])}if($71.length===2&&(!$71[0]&&$71[1])){return min4(save["saveRoll"][0])(save["saveRoll"][1])}return save["saveRoll"][0]}return 0};var saveLine2=function(save){if(save.saveRoll.length===0){return Nothing.value}if(save.targetDC instanceof Nothing){return Nothing.value}if(save.targetDC instanceof Just){var $80=(saveRoll(save)+save.saveBonus|0)>=save.targetDC.value0;if($80){return new Just(div6([class$prime4("small primary")])([text("Target DC: "+(show9(save.targetDC.value0)+", Success!"))]))}return new Just(div6([class$prime4("small error")])([text("Target DC: "+(show9(save.targetDC.value0)+", Failure!"))]))}throw new Error("Failed pattern match at SavingThrows (line 74, column 7 - line 79, column 120): "+[save.targetDC.constructor.name])};var saveLine1=function(save){if(save.saveRoll.length===2){var $83=save.advantage===save.disadvantage;if($83){return"Roll ["+(show9(save["saveRoll"][0])+("] + Bonus ["+(show9(save.saveBonus)+("] = "+show9(saveRoll(save)+save.saveBonus|0)))))}return"Roll ["+(show9(save["saveRoll"][0])+(","+(show9(save["saveRoll"][1])+("] + Bonus ["+(show9(save.saveBonus)+("] = "+show9(saveRoll(save)+save.saveBonus|0)))))))}return"-"};var showSaveResult=function(save){var v=saveLine2(save);if(v instanceof Nothing){return div_2([text(saveLine1(save))])}if(v instanceof Just){return div_2([div_2([text(saveLine1(save))]),v.value0])}throw new Error("Failed pattern match at SavingThrows (line 53, column 3 - line 59, column 8): "+[v.constructor.name])};var viewSavingThrow=function(save){return article_3([nav2([class$prime4("small grid")])([div6([class$prime4("small s2")])([mkText("Description")((function(s){return new Save(new Description(save,s))}))(save.description)]),div6([class$prime4("small s2")])([mkNumber("Save Bonus")((function(b){return new Save(new Bonus(save,b))}))(new Just(save.saveBonus))]),div6([class$prime4("small s1")])([mkCheckbox("Advantage")("arrow_upward")("top")((function(b){return new Save(new Advantage(save,b))}))(save.advantage),mkCheckbox("Disadvantage")("arrow_downward")("bottom")((function(b){return new Save(new Disadvantage(save,b))}))(save.disadvantage)]),div6([class$prime4("small s2")])([mkNumber("Target DC")((function(d){return new Save(new DC(save,d))}))(save.targetDC)]),div6([class$prime4("small s1")])([mkButton(new Save(new Roll(save)))("Casino")("Roll The Dice!")]),div6([class$prime4("small s3")])([showSaveResult(save)]),div6([class$prime4("small s1")])([mkButton(new Save(new Remove(save)))("delete")("Remove Saving Throw")])])])};var rollSave=function(save){return function __do(){var a3=rollDice(20)();var b=rollDice(20)();var roll=[a3,b];return{advantage:save.advantage,description:save.description,disadvantage:save.disadvantage,saveBonus:save.saveBonus,targetDC:save.targetDC,saveRoll:roll}}};var logSave=function(save){return formatLogMsg("SAVE: "+prtSave(save))};var updateSave=function(v){return function(v1){if(v1 instanceof Update){return new Tuple({attackRolls:v.attackRolls,currentTab:v.currentTab,log:v.log,profile:v.profile,profiles:v.profiles,savingThrows:updateArray3(v.savingThrows)(v1.value1)(v1.value2)},function(){if(v1.value0){return[map14((function($106){return Just.create(LogMsg.create($106))}))(liftEffect4(logSave(v1.value2))),pure12(new Just(new State(SSave.value)))]}return[pure12(new Just(new State(SSave.value)))]}())}if(v1 instanceof Description){return new Tuple(v,[pure12(new Just(new Save(new Update(false,v1.value0,{advantage:v1.value0.advantage,disadvantage:v1.value0.disadvantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,description:v1.value1}))))])}if(v1 instanceof Bonus){return new Tuple(v,[pure12(new Just(new Save(new Update(false,v1.value0,{description:v1.value0.description,advantage:v1.value0.advantage,disadvantage:v1.value0.disadvantage,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,saveBonus:v1.value1}))))])}if(v1 instanceof DC){return new Tuple(v,[pure12(new Just(new Save(new Update(false,v1.value0,{description:v1.value0.description,advantage:v1.value0.advantage,disadvantage:v1.value0.disadvantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:new Just(v1.value1)}))))])}if(v1 instanceof Advantage){return new Tuple(v,[pure12(new Just(new Save(new Update(false,v1.value0,{description:v1.value0.description,disadvantage:v1.value0.disadvantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,advantage:v1.value1}))))])}if(v1 instanceof Disadvantage){return new Tuple(v,[pure12(new Just(new Save(new Update(false,v1.value0,{description:v1.value0.description,advantage:v1.value0.advantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,disadvantage:v1.value1}))))])}if(v1 instanceof Roll){return new Tuple(v,[map14((function($107){return Just.create(Save.create($107))}))(map14(Update.create(true)(v1.value0))(liftEffect4(rollSave(v1.value0))))])}if(v1 instanceof Remove){return new Tuple({attackRolls:v.attackRolls,currentTab:v.currentTab,log:v.log,profile:v.profile,profiles:v.profiles,savingThrows:$$delete4(v1.value0)(v.savingThrows)},[pure12(new Just(new State(SSave.value)))])}if(v1 instanceof Add){return new Tuple({attackRolls:v.attackRolls,currentTab:v.currentTab,log:v.log,profile:v.profile,profiles:v.profiles,savingThrows:snoc(v.savingThrows)(initSave)},[pure12(new Just(new State(SSave.value)))])}throw new Error("Failed pattern match at SavingThrows (line 17, column 1 - line 17, column 75): "+[v.constructor.name,v1.constructor.name])}};var _parseJSON=JSON.parse;var _undefined=void 0;var _unsafeStringify=JSON.stringify;var unwrap4=unwrap();var withExcept=withExceptT(functorIdentity);var runExcept=function($3){return unwrap4(runExceptT($3))};function unsafeReadPropImpl(f,s,key2,value13){return value13==null?f:s(value13[key2])}var unsafeReadProp=function(dictMonad){var fail3=fail(dictMonad);var pure10=pure(applicativeExceptT(dictMonad));return function(k){return function(value13){return unsafeReadPropImpl(fail3(new TypeMismatch2("object",typeOf(value13))),pure10,k,value13)}}};var readProp=function(dictMonad){return unsafeReadProp(dictMonad)};function copyRecord(rec){var copy={};for(var key2 in rec){if({}.hasOwnProperty.call(rec,key2)){copy[key2]=rec[key2]}}return copy}function unsafeInsert(l){return function(a3){return function(rec){rec[l]=a3;return rec}}}var semigroupoidBuilder=semigroupoidFn;var insert5=function(){return function(){return function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(l){return function(a3){return function(r1){return unsafeInsert(reflectSymbol2(l))(a3)(r1)}}}}}};var categoryBuilder=categoryFn;var build=function(v){return function(r1){return v(copyRecord(r1))}};var map15=map(functorArray);var applicativeExceptT2=applicativeExceptT(monadIdentity);var pure7=pure(applicativeExceptT2);var map16=map(functorExceptT(functorIdentity));var map22=map(functorNonEmptyList);var bindExceptT2=bindExceptT(monadIdentity);var bindFlipped4=bindFlipped(bindExceptT2);var composeKleisliFlipped2=composeKleisliFlipped(bindExceptT2);var identity6=identity(categoryBuilder);var traverseWithIndex2=traverseWithIndex(traversableWithIndexArray)(applicativeExceptT2);var readArray1=readArray(monadIdentity);var bind2=bind(bindExceptT2);var compose1=compose(semigroupoidBuilder);var insert6=insert5()();var readProp2=readProp(monadIdentity);var writeImplFields=function(dict){return dict.writeImplFields};var writeImpl=function(dict){return dict.writeImpl};var writeJSON=function(dictWriteForeign){var $191=writeImpl(dictWriteForeign);return function($192){return _unsafeStringify($191($192))}};var writeForeignString={writeImpl:unsafeToForeign};var writeForeignInt={writeImpl:unsafeToForeign};var writeForeignBoolean={writeImpl:unsafeToForeign};var writeForeignArray=function(dictWriteForeign){var writeImpl1=writeImpl(dictWriteForeign);return{writeImpl:function(xs){return unsafeToForeign(map15(writeImpl1)(xs))}}};var $$undefined=_undefined;var writeForeignMaybe=function(dictWriteForeign){return{writeImpl:maybe($$undefined)(writeImpl(dictWriteForeign))}};var recordWriteForeign=function(){return function(dictWriteForeignFields){var writeImplFields1=writeImplFields(dictWriteForeignFields);return{writeImpl:function(rec){var steps=writeImplFields1($$Proxy.value)(rec);return unsafeToForeign(build(steps)({}))}}}};var readString2={readImpl:readString(monadIdentity)};var readInt2={readImpl:readInt(monadIdentity)};var readImpl=function(dict){return dict.readImpl};var readMaybe=function(dictReadForeign){return{readImpl:function(){var readNullOrUndefined=function(v){return function(v1){if(isNull2(v1)||isUndefined(v1)){return pure7(Nothing.value)}return map16(Just.create)(v(v1))}};return readNullOrUndefined(readImpl(dictReadForeign))}()}};var readFieldsNil={getFields:function(v){return function(v1){return pure7(identity6)}}};var readBoolean2={readImpl:readBoolean(monadIdentity)};var readArray2=function(dictReadForeign){var readImpl2=readImpl(dictReadForeign);return{readImpl:function(){var readAtIdx=function(i3){return function(f){return withExcept(map22(ErrorAtIndex.create(i3)))(readImpl2(f))}};return composeKleisliFlipped2(traverseWithIndex2(readAtIdx))(readArray1)}()}};var parseJSON=function(){var $205=lmap(bifunctorEither)(function(){var $208=pure(applicativeNonEmptyList);return function($209){return $208(ForeignError.create(message($209)))}}());var $206=runEffectFn1(_parseJSON);return function($207){return ExceptT(Identity($205(unsafePerformEffect($$try($206($207))))))}}();var readJSON=function(dictReadForeign){var $210=composeKleisliFlipped2(readImpl(dictReadForeign))(parseJSON);return function($211){return runExcept($210($211))}};var nilWriteForeignFields={writeImplFields:function(v){return function(v1){return identity6}}};var getFields=function(dict){return dict.getFields};var readRecord=function(){return function(dictReadForeignFields){var getFields1=getFields(dictReadForeignFields);return{readImpl:function(o){return map16(flip(build)({}))(getFields1($$Proxy.value)(o))}}}};var consWriteForeignFields=function(dictIsSymbol){var get3=get(dictIsSymbol)();var insert1=insert6(dictIsSymbol);return function(dictWriteForeign){var writeImpl1=writeImpl(dictWriteForeign);return function(dictWriteForeignFields){var writeImplFields1=writeImplFields(dictWriteForeignFields);return function(){return function(){return function(){return{writeImplFields:function(v){return function(rec){var rest=writeImplFields1($$Proxy.value)(rec);var value13=writeImpl1(get3($$Proxy.value)(rec));var result=compose1(insert1($$Proxy.value)(value13))(rest);return result}}}}}}}}};var applyEither2=function(dictSemigroup){var append12=append(dictSemigroup);return function(v){return function(v1){if(v instanceof Left&&v1 instanceof Right){return new Left(v.value0)}if(v instanceof Left&&v1 instanceof Left){return new Left(append12(v.value0)(v1.value0))}if(v instanceof Right&&v1 instanceof Left){return new Left(v1.value0)}if(v instanceof Right&&v1 instanceof Right){return new Right(v.value0(v1.value0))}throw new Error("Failed pattern match at Simple.JSON (line 241, column 1 - line 241, column 90): "+[v.constructor.name,v1.constructor.name])}}};var exceptTApply=function(dictSemigroup){var applyEither1=applyEither2(dictSemigroup);return function(dictApplicative){var Apply0=dictApplicative.Apply0();var apply3=apply(Apply0);var map42=map(Apply0.Functor0());return function(fun){return function(a3){return apply3(map42(applyEither1)(runExceptT(fun)))(runExceptT(a3))}}}};var exceptTApply1=exceptTApply(semigroupNonEmptyList)(applicativeIdentity);var readFieldsCons=function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);var insert1=insert6(dictIsSymbol);return function(dictReadForeign){var readImpl2=readImpl(dictReadForeign);return function(dictReadForeignFields){var getFields1=getFields(dictReadForeignFields);return function(){return function(){return{getFields:function(v){return function(obj){var rest=getFields1($$Proxy.value)(obj);var name15=reflectSymbol2($$Proxy.value);var withExcept$prime=withExcept(map22(ErrorAtProperty.create(name15)));var first=bind2(withExcept$prime(bindFlipped4(readImpl2)(readProp2(name15)(obj))))((function(value13){return pure7(insert1($$Proxy.value)(value13))}));return exceptTApply1(map16(compose1)(first))(rest)}}}}}}}};var windowImpl=function(){return window};function localStorage(window2){return function(){return window2.localStorage}}function length7(storage){return function(){return storage.length}}function _key(index4){return function(storage){return function(){return storage.key(index4)}}}function _getItem(key2){return function(storage){return function(){return storage.getItem(key2)}}}function setItem(key2){return function(value13){return function(storage){return function(){storage.setItem(key2,value13)}}}}function removeItem(key2){return function(storage){return function(){storage.removeItem(key2)}}}var map17=map(functorEffect);var key=function(i3){var $2=map17(toMaybe);var $3=_key(i3);return function($4){return $2($3($4))}};var getItem=function(s){var $5=map17(toMaybe);var $6=_getItem(s);return function($7){return $5($6($7))}};var recordWriteForeign2=recordWriteForeign();var attackRollsIsSymbol={reflectSymbol:function(){return"attackRolls"}};var advantageIsSymbol={reflectSymbol:function(){return"advantage"}};var consWriteForeignFields2=consWriteForeignFields(advantageIsSymbol)(writeForeignBoolean);var attackBonusIsSymbol={reflectSymbol:function(){return"attackBonus"}};var attackRollIsSymbol={reflectSymbol:function(){return"attackRoll"}};var writeForeignArray2=writeForeignArray(writeForeignInt);var damageDiceIsSymbol={reflectSymbol:function(){return"damageDice"}};var damageBonusIsSymbol={reflectSymbol:function(){return"damageBonus"}};var damageRollIsSymbol={reflectSymbol:function(){return"damageRoll"}};var damageTypeIsSymbol={reflectSymbol:function(){return"damageType"}};var diceCountIsSymbol={reflectSymbol:function(){return"diceCount"}};var diceTypeIsSymbol={reflectSymbol:function(){return"diceType"}};var descriptionIsSymbol={reflectSymbol:function(){return"description"}};var consWriteForeignFields1=consWriteForeignFields(descriptionIsSymbol)(writeForeignString);var disadvantageIsSymbol={reflectSymbol:function(){return"disadvantage"}};var consWriteForeignFields22=consWriteForeignFields(disadvantageIsSymbol)(writeForeignBoolean);var targetACIsSymbol={reflectSymbol:function(){return"targetAC"}};var currentTabIsSymbol={reflectSymbol:function(){return"currentTab"}};var logIsSymbol={reflectSymbol:function(){return"log"}};var profileIsSymbol={reflectSymbol:function(){return"profile"}};var profilesIsSymbol={reflectSymbol:function(){return"profiles"}};var savingThrowsIsSymbol={reflectSymbol:function(){return"savingThrows"}};var saveBonusIsSymbol={reflectSymbol:function(){return"saveBonus"}};var saveRollIsSymbol={reflectSymbol:function(){return"saveRoll"}};var targetDCIsSymbol={reflectSymbol:function(){return"targetDC"}};var writeJSON2=writeJSON(recordWriteForeign2(consWriteForeignFields(attackRollsIsSymbol)(writeForeignArray(recordWriteForeign2(consWriteForeignFields2(consWriteForeignFields(attackBonusIsSymbol)(writeForeignInt)(consWriteForeignFields(attackRollIsSymbol)(writeForeignArray2)(consWriteForeignFields(damageDiceIsSymbol)(writeForeignArray(recordWriteForeign2(consWriteForeignFields(damageBonusIsSymbol)(writeForeignInt)(consWriteForeignFields(damageRollIsSymbol)(writeForeignArray2)(consWriteForeignFields(damageTypeIsSymbol)(writeForeignString)(consWriteForeignFields(diceCountIsSymbol)(writeForeignInt)(consWriteForeignFields(diceTypeIsSymbol)(writeForeignInt)(nilWriteForeignFields)()()())()()())()()())()()())()()())))(consWriteForeignFields1(consWriteForeignFields22(consWriteForeignFields(targetACIsSymbol)(writeForeignInt)(nilWriteForeignFields)()()())()()())()()())()()())()()())()()())()()())))(consWriteForeignFields(currentTabIsSymbol)(writeForeignString)(consWriteForeignFields(logIsSymbol)(writeForeignString)(consWriteForeignFields(profileIsSymbol)(writeForeignString)(consWriteForeignFields(profilesIsSymbol)(writeForeignArray(writeForeignString))(consWriteForeignFields(savingThrowsIsSymbol)(writeForeignArray(recordWriteForeign2(consWriteForeignFields2(consWriteForeignFields1(consWriteForeignFields22(consWriteForeignFields(saveBonusIsSymbol)(writeForeignInt)(consWriteForeignFields(saveRollIsSymbol)(writeForeignArray2)(consWriteForeignFields(targetDCIsSymbol)(writeForeignMaybe(writeForeignInt))(nilWriteForeignFields)()()())()()())()()())()()())()()())()()())))(nilWriteForeignFields)()()())()()())()()())()()())()()())()()()));var pure8=pure(applicativeEffect);var readRecord2=readRecord();var readFieldsCons2=readFieldsCons(advantageIsSymbol)(readBoolean2);var readArray3=readArray2(readInt2);var readFieldsCons1=readFieldsCons(descriptionIsSymbol)(readString2);var readFieldsCons22=readFieldsCons(disadvantageIsSymbol)(readBoolean2);var readJSON2=readJSON(readRecord2(readFieldsCons(attackRollsIsSymbol)(readArray2(readRecord2(readFieldsCons2(readFieldsCons(attackBonusIsSymbol)(readInt2)(readFieldsCons(attackRollIsSymbol)(readArray3)(readFieldsCons(damageDiceIsSymbol)(readArray2(readRecord2(readFieldsCons(damageBonusIsSymbol)(readInt2)(readFieldsCons(damageRollIsSymbol)(readArray3)(readFieldsCons(damageTypeIsSymbol)(readString2)(readFieldsCons(diceCountIsSymbol)(readInt2)(readFieldsCons(diceTypeIsSymbol)(readInt2)(readFieldsNil)()())()())()())()())()())))(readFieldsCons1(readFieldsCons22(readFieldsCons(targetACIsSymbol)(readInt2)(readFieldsNil)()())()())()())()())()())()())()())))(readFieldsCons(currentTabIsSymbol)(readString2)(readFieldsCons(logIsSymbol)(readString2)(readFieldsCons(profileIsSymbol)(readString2)(readFieldsCons(profilesIsSymbol)(readArray2(readString2))(readFieldsCons(savingThrowsIsSymbol)(readArray2(readRecord2(readFieldsCons2(readFieldsCons1(readFieldsCons22(readFieldsCons(saveBonusIsSymbol)(readInt2)(readFieldsCons(saveRollIsSymbol)(readArray3)(readFieldsCons(targetDCIsSymbol)(readMaybe(readInt2))(readFieldsNil)()())()())()())()())()())()())))(readFieldsNil)()())()())()())()())()())()()));var show10=show(showNonEmptyList(showForeignError));var map18=map(functorArray);var map19=map(functorAff);var liftEffect5=liftEffect(monadEffectAff);var unprofileName$prime=function(s){return drop2(28)(s)};var profileName$prime=function(s){return"magicitems-tools-diceroller-"+s};var profileName=function(model){return profileName$prime(model.profile)};var saveState=function(model){var $316=model.profile!=="";if($316){return function __do(){var w=windowImpl();var s=localStorage(w)();var json=writeJSON2(model);setItem(profileName(model))(json)(s)();return model}}return pure8(model)};var loadState=function(model){var $317=model.profile!=="";if($317){return function __do(){log("Loading profile: "+model.profile)();var w=windowImpl();var s=localStorage(w)();var item=getItem(profileName(model))(s)();if(item instanceof Nothing){log("Profile ["+(model.profile+"] not found"))();return model}if(item instanceof Just){var v=readJSON2(item.value0);if(v instanceof Left){log("Profile ["+(model.profile+("] could not be parsed - "+show10(v.value0))))();return model}if(v instanceof Right){log("Profile ["+(model.profile+"] loaded."))();return{attackRolls:v.value0.attackRolls,currentTab:v.value0.currentTab,log:v.value0.log,savingThrows:v.value0.savingThrows,profile:model.profile,profiles:model.profiles}}throw new Error("Failed pattern match at StateManagement (line 65, column 20 - line 72, column 76): "+[v.constructor.name])}throw new Error("Failed pattern match at StateManagement (line 61, column 5 - line 72, column 76): "+[item.constructor.name])}}return function __do(){log("Attempted to load profile - no profile name provided")();return model}};var isProfile=function(s){return take2(28)(s)==="magicitems-tools-diceroller-"};var loadProfiles=function(model){return function __do(){var w=windowImpl();var s=localStorage(w)();var l=length7(s)();var xs=mapM((function(x){return key(x)(s)}))(range2(0)(l-1|0))();var ps=filter(isProfile)(justs(xs));return{attackRolls:model.attackRolls,currentTab:model.currentTab,log:model.log,profile:model.profile,savingThrows:model.savingThrows,profiles:map18(unprofileName$prime)(ps)}}};var clearState=function(model){return function __do(){var w=windowImpl();var s=localStorage(w)();removeItem(profileName(model))(s)();return initModel}};var updateState=function(v){return function(v1){if(v1 instanceof SSave){return new Tuple(v,[map19((function($325){return Just.create(StateSaved.create($325))}))(liftEffect5(saveState(v)))])}if(v1 instanceof SLoad){return new Tuple(v,[map19((function($326){return Just.create(StateLoaded.create($326))}))(liftEffect5(loadState(v)))])}if(v1 instanceof SClear){return new Tuple(v,[map19((function($327){return Just.create(StateLoaded.create($327))}))(liftEffect5(clearState(v)))])}if(v1 instanceof SLoadAll){return new Tuple(v,[map19((function($328){return Just.create(StateLoaded.create($328))}))(liftEffect5(loadProfiles(v)))])}throw new Error("Failed pattern match at StateManagement (line 22, column 1 - line 22, column 82): "+[v.constructor.name,v1.constructor.name])}};var pure9=pure(applicativeAff);var toNodeArray5=toNodeArray(toNodeNodeDataNodeData);var toNodeArray14=toNodeArray(toNodeHtmlHtml);var main2=main(toNodeArray5)(toNodeArray14);var class$prime5=class$prime(toClassListString);var div7=div3(toNodeArray5);var div12=div7(toNodeArray14);var header2=header(toNodeArray5)(toNodeArray14);var nav3=nav(toNodeArray5)(toNodeArray14);var map20=map(functorArray);var a2=a(toNodeArray5)(toNodeArray14);var h63=h6(toNodeArray5)(toNodeArray14);var div22=div7(toNodeArray(toNodeArray14));var textarea2=textarea(toNodeArray5)(toNodeArray14);var update=function(v){return function(v1){if(v1 instanceof Save){return updateSave(v)(v1.value0)}if(v1 instanceof Attack){return updateAttack(v)(v1.value0)}if(v1 instanceof State){return updateState(v)(v1.value0)}if(v1 instanceof StateSaved){return new Tuple(v,[])}if(v1 instanceof ChangeTab){return new Tuple({attackRolls:v.attackRolls,log:v.log,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,currentTab:v1.value0},[pure9(new Just(new State(SSave.value)))])}if(v1 instanceof ChangeProfile){return new Tuple({attackRolls:v.attackRolls,currentTab:v.currentTab,log:v.log,profiles:v.profiles,savingThrows:v.savingThrows,profile:v1.value0},[pure9(new Just(new State(SLoad.value)))])}if(v1 instanceof StateLoaded){return new Tuple(v1.value0,[])}if(v1 instanceof LogMsg){return new Tuple({attackRolls:v.attackRolls,currentTab:v.currentTab,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,log:v.log+v1.value0},[pure9(new Just(new State(SSave.value)))])}if(v1 instanceof ClearLog){return new Tuple({attackRolls:v.attackRolls,currentTab:v.currentTab,profile:v.profile,profiles:v.profiles,savingThrows:v.savingThrows,log:""},[pure9(new Just(new State(SSave.value)))])}throw new Error("Failed pattern match at ToolsApp (line 25, column 1 - line 25, column 70): "+[v.constructor.name,v1.constructor.name])}};var tabClass=function(model){return function(tab){var $39=model.currentTab===tab;if($39){return"active"}return"inactive"}};var view=function(model){return main2([class$prime5("responsive small")])([div12([class$prime5("grid middle-align")])([header2([class$prime5("fill small round bottom-shadow top-shadow s12 middle-align")])([nav3([class$prime5("small middle-align")])([div12([class$prime5("small middle-align")])([mkProfileText(ChangeProfile.create)(model.profile)]),div12([class$prime5("small middle-align")])(map20((function(s){return mkProfileButton(s)(new ChangeProfile(s))}))(model.profiles)),div12([class$prime5("max small middle-align")])([text("")]),mkButton(new State(SClear.value))("delete")("Clear saved state")])]),div12([class$prime5("s12")])([div12([class$prime5("tabs")])([a2([class$prime5(tabClass(model)("Attack")),onClick(new ChangeTab("Attack"))])([text("Attack Rolls")]),a2([class$prime5(tabClass(model)("Save")),onClick(new ChangeTab("Save"))])([text("Saving Throws")]),a2([class$prime5(tabClass(model)("Log")),onClick(new ChangeTab("Log"))])([text("Log")])]),div12([class$prime5("page padding "+tabClass(model)("Attack"))])([div12([class$prime5("small s6")])([header2([class$prime5("fill small round bottom-shadow top-shadow")])([nav3([class$prime5("small")])([div12([class$prime5("max small")])([h63([class$prime5("max white-text left-align small")])([text("Attack Rolls")])]),mkButton(new Attack(AAdd.value))("add")("Add Attack Roll")])]),div22([class$prime5("small")])([map20(viewAttackRoll)(model.attackRolls)])])]),div12([class$prime5("page padding "+tabClass(model)("Save"))])([div12([class$prime5("small s6")])([header2([class$prime5("fill small round bottom-shadow top-shadow")])([nav3([class$prime5("small")])([div12([class$prime5("max small")])([h63([class$prime5("max white-text left-align small")])([text("Saving Throws")])]),mkButton(new Save(Add.value))("add")("Add Saving Throw")])]),div22([class$prime5("small")])([map20(viewSavingThrow)(model.savingThrows)])])]),div12([class$prime5("page padding "+tabClass(model)("Log"))])([div12([class$prime5("small s6")])([header2([class$prime5("fill small round bottom-shadow top-shadow")])([nav3([class$prime5("small")])([div12([class$prime5("max small")])([h63([class$prime5("max white-text left-align small")])([text("Log of Rolls")])]),div12([class$prime5("max small middle-align")])([text("")]),mkButton(ClearLog.value)("delete")("Clear log")])]),div12([class$prime5("field textarea border large-height")])([textarea2([readOnly(true),styleAttr("font-family: 'Lucida Console', 'Courier New', monospace; font-size: 12px;")])([text(model.log)])])])])])])])};var init3=function(){return new Tuple(initModel,[pure9(new Just(new State(SLoadAll.value)))])}();var main3=mount_("body")({init:init3,subscribe:[],update:update,view:view});main3()})();
