(()=>{var arrayApply=function(fs){return function(xs){var l=fs.length;var k=xs.length;var result=new Array(l*k);var n=0;for(var i=0;i<l;i++){var f=fs[i];for(var j=0;j<k;j++){result[n++]=f(xs[j])}}return result}};var semigroupoidFn={compose:function(f){return function(g){return function(x){return f(g(x))}}}};var identity=function(dict){return dict.identity};var categoryFn={identity:function(x){return x},Semigroupoid0:function(){return semigroupoidFn}};var otherwise=true;var flip=function(f){return function(b){return function(a){return f(a)(b)}}};var $$const=function(a){return function(v){return a}};var arrayMap=function(f){return function(arr){var l=arr.length;var result=new Array(l);for(var i=0;i<l;i++){result[i]=f(arr[i])}return result}};var unit=void 0;var $$Proxy=function(){function $$Proxy2(){}$$Proxy2.value=new $$Proxy2;return $$Proxy2}();var map=function(dict){return dict.map};var $$void=function(dictFunctor){return map(dictFunctor)($$const(unit))};var functorArray={map:arrayMap};var identity2=identity(categoryFn);var applyArray={apply:arrayApply,Functor0:function(){return functorArray}};var apply=function(dict){return dict.apply};var applySecond=function(dictApply){var apply1=apply(dictApply);var map6=map(dictApply.Functor0());return function(a){return function(b){return apply1(map6($$const(identity2))(a))(b)}}};var pure=function(dict){return dict.pure};var when=function(dictApplicative){var pure12=pure(dictApplicative);return function(v){return function(v1){if(v){return v1}if(!v){return pure12(unit)}throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[v.constructor.name,v1.constructor.name])}}};var liftA1=function(dictApplicative){var apply2=apply(dictApplicative.Apply0());var pure12=pure(dictApplicative);return function(f){return function(a){return apply2(pure12(f))(a)}}};var reflectSymbol=function(dict){return dict.reflectSymbol};var unsafeGet=function(label3){return function(rec){return rec[label3]}};var append=function(dict){return dict.append};var topInt=2147483647;var bottomInt=-2147483648;var topChar=String.fromCharCode(65535);var bottomChar=String.fromCharCode(0);var topNumber=Number.POSITIVE_INFINITY;var bottomNumber=Number.NEGATIVE_INFINITY;var unsafeCompareImpl=function(lt){return function(eq2){return function(gt){return function(x){return function(y){return x<y?lt:x===y?eq2:gt}}}}};var ordIntImpl=unsafeCompareImpl;var ordCharImpl=unsafeCompareImpl;var refEq=function(r1){return function(r2){return r1===r2}};var eqBooleanImpl=refEq;var eqIntImpl=refEq;var eqCharImpl=refEq;var eqStringImpl=refEq;var eqArrayImpl=function(f){return function(xs){return function(ys){if(xs.length!==ys.length)return false;for(var i=0;i<xs.length;i++){if(!f(xs[i])(ys[i]))return false}return true}}};var eqString={eq:eqStringImpl};var eqRowNil={eqRecord:function(v){return function(v1){return function(v2){return true}}}};var eqRecord=function(dict){return dict.eqRecord};var eqRec=function(){return function(dictEqRecord){return{eq:eqRecord(dictEqRecord)($$Proxy.value)}}};var eqInt={eq:eqIntImpl};var eqChar={eq:eqCharImpl};var eqBoolean={eq:eqBooleanImpl};var eq=function(dict){return dict.eq};var eqArray=function(dictEq){return{eq:eqArrayImpl(eq(dictEq))}};var eqRowCons=function(dictEqRecord){var eqRecord1=eqRecord(dictEqRecord);return function(){return function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(dictEq){var eq3=eq(dictEq);return{eqRecord:function(v){return function(ra){return function(rb){var tail2=eqRecord1($$Proxy.value)(ra)(rb);var key=reflectSymbol2($$Proxy.value);var get2=unsafeGet(key);return eq3(get2(ra))(get2(rb))&&tail2}}}}}}}};var LT=function(){function LT2(){}LT2.value=new LT2;return LT2}();var GT=function(){function GT2(){}GT2.value=new GT2;return GT2}();var EQ=function(){function EQ2(){}EQ2.value=new EQ2;return EQ2}();var intSub=function(x){return function(y){return x-y|0}};var intAdd=function(x){return function(y){return x+y|0}};var intMul=function(x){return function(y){return x*y|0}};var semiringInt={add:intAdd,zero:0,mul:intMul,one:1};var ringInt={sub:intSub,Semiring0:function(){return semiringInt}};var ordInt=function(){return{compare:ordIntImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqInt}}}();var ordChar=function(){return{compare:ordCharImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqChar}}}();var compare=function(dict){return dict.compare};var max=function(dictOrd){var compare3=compare(dictOrd);return function(x){return function(y){var v=compare3(x)(y);if(v instanceof LT){return y}if(v instanceof EQ){return x}if(v instanceof GT){return x}throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[v.constructor.name])}}};var min=function(dictOrd){var compare3=compare(dictOrd);return function(x){return function(y){var v=compare3(x)(y);if(v instanceof LT){return x}if(v instanceof EQ){return x}if(v instanceof GT){return y}throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[v.constructor.name])}}};var top=function(dict){return dict.top};var boundedInt={top:topInt,bottom:bottomInt,Ord0:function(){return ordInt}};var boundedChar={top:topChar,bottom:bottomChar,Ord0:function(){return ordChar}};var bottom=function(dict){return dict.bottom};var showIntImpl=function(n){return n.toString()};var showStringImpl=function(s){var l=s.length;return'"'+s.replace(/[\0-\x1F\x7F"\\]/g,(function(c,i){switch(c){case'"':case"\\":return"\\"+c;case"":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v"}var k=i+1;var empty4=k<l&&s[k]>="0"&&s[k]<="9"?"\\&":"";return"\\"+c.charCodeAt(0).toString(10)+empty4}))+'"'};var showUnit={show:function(v){return"unit"}};var showString={show:showStringImpl};var showInt={show:showIntImpl};var show=function(dict){return dict.show};var identity3=identity(categoryFn);var Nothing=function(){function Nothing2(){}Nothing2.value=new Nothing2;return Nothing2}();var Just=function(){function Just2(value0){this.value0=value0}Just2.create=function(value0){return new Just2(value0)};return Just2}();var maybe=function(v){return function(v1){return function(v2){if(v2 instanceof Nothing){return v}if(v2 instanceof Just){return v1(v2.value0)}throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}};var functorMaybe={map:function(v){return function(v1){if(v1 instanceof Just){return new Just(v(v1.value0))}return Nothing.value}}};var fromMaybe=function(a){return maybe(a)(identity3)};var fromJust=function(){return function(v){if(v instanceof Just){return v.value0}throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[v.constructor.name])}};var Left=function(){function Left2(value0){this.value0=value0}Left2.create=function(value0){return new Left2(value0)};return Left2}();var Right=function(){function Right2(value0){this.value0=value0}Right2.create=function(value0){return new Right2(value0)};return Right2}();var foldrArray=function(f){return function(init4){return function(xs){var acc=init4;var len=xs.length;for(var i=len-1;i>=0;i--){acc=f(xs[i])(acc)}return acc}}};var foldlArray=function(f){return function(init4){return function(xs){var acc=init4;var len=xs.length;for(var i=0;i<len;i++){acc=f(acc)(xs[i])}return acc}}};var arrayBind=typeof Array.prototype.flatMap==="function"?function(arr){return function(f){return arr.flatMap(f)}}:function(arr){return function(f){var result=[];var l=arr.length;for(var i=0;i<l;i++){var xs=f(arr[i]);var k=xs.length;for(var j=0;j<k;j++){result.push(xs[j])}}return result}};var bindArray={bind:arrayBind,Apply0:function(){return applyArray}};var bind=function(dict){return dict.bind};var bindFlipped=function(dictBind){return flip(bind(dictBind))};var boolConj=function(b1){return function(b2){return b1&&b2}};var boolDisj=function(b1){return function(b2){return b1||b2}};var boolNot=function(b){return!b};var not=function(dict){return dict.not};var disj=function(dict){return dict.disj};var heytingAlgebraBoolean={ff:false,tt:true,implies:function(a){return function(b){return disj(heytingAlgebraBoolean)(not(heytingAlgebraBoolean)(a))(b)}},conj:boolConj,disj:boolDisj,not:boolNot};var intDegree=function(x){return Math.min(Math.abs(x),2147483647)};var intDiv=function(x){return function(y){if(y===0)return 0;return y>0?Math.floor(x/y):-Math.floor(x/-y)}};var intMod=function(x){return function(y){if(y===0)return 0;var yy=Math.abs(y);return(x%yy+yy)%yy}};var commutativeRingInt={Ring0:function(){return ringInt}};var mod=function(dict){return dict.mod};var euclideanRingInt={degree:intDegree,div:intDiv,mod:intMod,CommutativeRing0:function(){return commutativeRingInt}};var div=function(dict){return dict.div};var mempty=function(dict){return dict.mempty};var Tuple=function(){function Tuple2(value0,value1){this.value0=value0;this.value1=value1}Tuple2.create=function(value0){return function(value1){return new Tuple2(value0,value1)}};return Tuple2}();var unsafeCoerce2=function(x){return x};var foldr=function(dict){return dict.foldr};var traverse_=function(dictApplicative){var applySecond2=applySecond(dictApplicative.Apply0());var pure4=pure(dictApplicative);return function(dictFoldable){var foldr2=foldr(dictFoldable);return function(f){return foldr2((function($454){return applySecond2(f($454))}))(pure4(unit))}}};var for_=function(dictApplicative){var traverse_1=traverse_(dictApplicative);return function(dictFoldable){return flip(traverse_1(dictFoldable))}};var foldMapDefaultR=function(dictFoldable){var foldr2=foldr(dictFoldable);return function(dictMonoid){var append2=append(dictMonoid.Semigroup0());var mempty2=mempty(dictMonoid);return function(f){return foldr2((function(x){return function(acc){return append2(f(x))(acc)}}))(mempty2)}}};var foldableArray={foldr:foldrArray,foldl:foldlArray,foldMap:function(dictMonoid){return foldMapDefaultR(foldableArray)(dictMonoid)}};var pureE=function(a){return function(){return a}};var bindE=function(a){return function(f){return function(){return f(a())()}}};var ap=function(dictMonad){var bind2=bind(dictMonad.Bind1());var pure4=pure(dictMonad.Applicative0());return function(f){return function(a){return bind2(f)((function(f$prime){return bind2(a)((function(a$prime){return pure4(f$prime(a$prime))}))}))}}};var $runtime_lazy=function(name2,moduleName,init4){var state2=0;var val;return function(lineNumber){if(state2===2)return val;if(state2===1)throw new ReferenceError(name2+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state2=1;val=init4();state2=2;return val}};var monadEffect={Applicative0:function(){return applicativeEffect},Bind1:function(){return bindEffect}};var bindEffect={bind:bindE,Apply0:function(){return $lazy_applyEffect(0)}};var applicativeEffect={pure:pureE,Apply0:function(){return $lazy_applyEffect(0)}};var $lazy_functorEffect=$runtime_lazy("functorEffect","Effect",(function(){return{map:liftA1(applicativeEffect)}}));var $lazy_applyEffect=$runtime_lazy("applyEffect","Effect",(function(){return{apply:ap(monadEffect),Functor0:function(){return $lazy_functorEffect(0)}}}));var functorEffect=$lazy_functorEffect(20);var Aff=function(){var EMPTY={};var PURE="Pure";var THROW="Throw";var CATCH="Catch";var SYNC="Sync";var ASYNC="Async";var BIND="Bind";var BRACKET="Bracket";var FORK="Fork";var SEQ="Sequential";var MAP="Map";var APPLY="Apply";var ALT="Alt";var CONS="Cons";var RESUME="Resume";var RELEASE="Release";var FINALIZER="Finalizer";var FINALIZED="Finalized";var FORKED="Forked";var FIBER="Fiber";var THUNK="Thunk";function Aff2(tag,_1,_2,_3){this.tag=tag;this._1=_1;this._2=_2;this._3=_3}function AffCtr(tag){var fn=function(_1,_2,_3){return new Aff2(tag,_1,_2,_3)};fn.tag=tag;return fn}function nonCanceler(error3){return new Aff2(PURE,void 0)}function runEff(eff){try{eff()}catch(error3){setTimeout((function(){throw error3}),0)}}function runSync(left,right,eff){try{return right(eff())}catch(error3){return left(error3)}}function runAsync(left,eff,k){try{return eff(k)()}catch(error3){k(left(error3))();return nonCanceler}}var Scheduler=function(){var limit=1024;var size3=0;var ix=0;var queue=new Array(limit);var draining=false;function drain(){var thunk;draining=true;while(size3!==0){size3--;thunk=queue[ix];queue[ix]=void 0;ix=(ix+1)%limit;thunk()}draining=false}return{isDraining:function(){return draining},enqueue:function(cb){var i,tmp;if(size3===limit){tmp=draining;drain();draining=tmp}queue[(ix+size3)%limit]=cb;size3++;if(!draining){drain()}}}}();function Supervisor(util){var fibers={};var fiberId=0;var count=0;return{register:function(fiber){var fid=fiberId++;fiber.onComplete({rethrow:true,handler:function(result){return function(){count--;delete fibers[fid]}}})();fibers[fid]=fiber;count++},isEmpty:function(){return count===0},killAll:function(killError,cb){return function(){if(count===0){return cb()}var killCount=0;var kills={};function kill(fid){kills[fid]=fibers[fid].kill(killError,(function(result){return function(){delete kills[fid];killCount--;if(util.isLeft(result)&&util.fromLeft(result)){setTimeout((function(){throw util.fromLeft(result)}),0)}if(killCount===0){cb()}}}))()}for(var k in fibers){if(fibers.hasOwnProperty(k)){killCount++;kill(k)}}fibers={};fiberId=0;count=0;return function(error3){return new Aff2(SYNC,(function(){for(var k2 in kills){if(kills.hasOwnProperty(k2)){kills[k2]()}}}))}}}}}var SUSPENDED=0;var CONTINUE=1;var STEP_BIND=2;var STEP_RESULT=3;var PENDING=4;var RETURN=5;var COMPLETED=6;function Fiber(util,supervisor,aff){var runTick=0;var status=SUSPENDED;var step=aff;var fail=null;var interrupt=null;var bhead=null;var btail=null;var attempts=null;var bracketCount=0;var joinId=0;var joins=null;var rethrow=true;function run4(localRunTick){var tmp,result,attempt;while(true){tmp=null;result=null;attempt=null;switch(status){case STEP_BIND:status=CONTINUE;try{step=bhead(step);if(btail===null){bhead=null}else{bhead=btail._1;btail=btail._2}}catch(e){status=RETURN;fail=util.left(e);step=null}break;case STEP_RESULT:if(util.isLeft(step)){status=RETURN;fail=step;step=null}else if(bhead===null){status=RETURN}else{status=STEP_BIND;step=util.fromRight(step)}break;case CONTINUE:switch(step.tag){case BIND:if(bhead){btail=new Aff2(CONS,bhead,btail)}bhead=step._2;status=CONTINUE;step=step._1;break;case PURE:if(bhead===null){status=RETURN;step=util.right(step._1)}else{status=STEP_BIND;step=step._1}break;case SYNC:status=STEP_RESULT;step=runSync(util.left,util.right,step._1);break;case ASYNC:status=PENDING;step=runAsync(util.left,step._1,(function(result2){return function(){if(runTick!==localRunTick){return}runTick++;Scheduler.enqueue((function(){if(runTick!==localRunTick+1){return}status=STEP_RESULT;step=result2;run4(runTick)}))}}));return;case THROW:status=RETURN;fail=util.left(step._1);step=null;break;case CATCH:if(bhead===null){attempts=new Aff2(CONS,step,attempts,interrupt)}else{attempts=new Aff2(CONS,step,new Aff2(CONS,new Aff2(RESUME,bhead,btail),attempts,interrupt),interrupt)}bhead=null;btail=null;status=CONTINUE;step=step._1;break;case BRACKET:bracketCount++;if(bhead===null){attempts=new Aff2(CONS,step,attempts,interrupt)}else{attempts=new Aff2(CONS,step,new Aff2(CONS,new Aff2(RESUME,bhead,btail),attempts,interrupt),interrupt)}bhead=null;btail=null;status=CONTINUE;step=step._1;break;case FORK:status=STEP_RESULT;tmp=Fiber(util,supervisor,step._2);if(supervisor){supervisor.register(tmp)}if(step._1){tmp.run()}step=util.right(tmp);break;case SEQ:status=CONTINUE;step=sequential2(util,supervisor,step._1);break}break;case RETURN:bhead=null;btail=null;if(attempts===null){status=COMPLETED;step=interrupt||fail||step}else{tmp=attempts._3;attempt=attempts._1;attempts=attempts._2;switch(attempt.tag){case CATCH:if(interrupt&&interrupt!==tmp&&bracketCount===0){status=RETURN}else if(fail){status=CONTINUE;step=attempt._2(util.fromLeft(fail));fail=null}break;case RESUME:if(interrupt&&interrupt!==tmp&&bracketCount===0||fail){status=RETURN}else{bhead=attempt._1;btail=attempt._2;status=STEP_BIND;step=util.fromRight(step)}break;case BRACKET:bracketCount--;if(fail===null){result=util.fromRight(step);attempts=new Aff2(CONS,new Aff2(RELEASE,attempt._2,result),attempts,tmp);if(interrupt===tmp||bracketCount>0){status=CONTINUE;step=attempt._3(result)}}break;case RELEASE:attempts=new Aff2(CONS,new Aff2(FINALIZED,step,fail),attempts,interrupt);status=CONTINUE;if(interrupt&&interrupt!==tmp&&bracketCount===0){step=attempt._1.killed(util.fromLeft(interrupt))(attempt._2)}else if(fail){step=attempt._1.failed(util.fromLeft(fail))(attempt._2)}else{step=attempt._1.completed(util.fromRight(step))(attempt._2)}fail=null;bracketCount++;break;case FINALIZER:bracketCount++;attempts=new Aff2(CONS,new Aff2(FINALIZED,step,fail),attempts,interrupt);status=CONTINUE;step=attempt._1;break;case FINALIZED:bracketCount--;status=RETURN;step=attempt._1;fail=attempt._2;break}}break;case COMPLETED:for(var k in joins){if(joins.hasOwnProperty(k)){rethrow=rethrow&&joins[k].rethrow;runEff(joins[k].handler(step))}}joins=null;if(interrupt&&fail){setTimeout((function(){throw util.fromLeft(fail)}),0)}else if(util.isLeft(step)&&rethrow){setTimeout((function(){if(rethrow){throw util.fromLeft(step)}}),0)}return;case SUSPENDED:status=CONTINUE;break;case PENDING:return}}}function onComplete(join3){return function(){if(status===COMPLETED){rethrow=rethrow&&join3.rethrow;join3.handler(step)();return function(){}}var jid=joinId++;joins=joins||{};joins[jid]=join3;return function(){if(joins!==null){delete joins[jid]}}}}function kill(error3,cb){return function(){if(status===COMPLETED){cb(util.right(void 0))();return function(){}}var canceler=onComplete({rethrow:false,handler:function(){return cb(util.right(void 0))}})();switch(status){case SUSPENDED:interrupt=util.left(error3);status=COMPLETED;step=interrupt;run4(runTick);break;case PENDING:if(interrupt===null){interrupt=util.left(error3)}if(bracketCount===0){if(status===PENDING){attempts=new Aff2(CONS,new Aff2(FINALIZER,step(error3)),attempts,interrupt)}status=RETURN;step=null;fail=null;run4(++runTick)}break;default:if(interrupt===null){interrupt=util.left(error3)}if(bracketCount===0){status=RETURN;step=null;fail=null}}return canceler}}function join2(cb){return function(){var canceler=onComplete({rethrow:false,handler:cb})();if(status===SUSPENDED){run4(runTick)}return canceler}}return{kill:kill,join:join2,onComplete:onComplete,isSuspended:function(){return status===SUSPENDED},run:function(){if(status===SUSPENDED){if(!Scheduler.isDraining()){Scheduler.enqueue((function(){run4(runTick)}))}else{run4(runTick)}}}}}function runPar(util,supervisor,par,cb){var fiberId=0;var fibers={};var killId=0;var kills={};var early=new Error("[ParAff] Early exit");var interrupt=null;var root=EMPTY;function kill(error3,par2,cb2){var step=par2;var head2=null;var tail2=null;var count=0;var kills2={};var tmp,kid;loop:while(true){tmp=null;switch(step.tag){case FORKED:if(step._3===EMPTY){tmp=fibers[step._1];kills2[count++]=tmp.kill(error3,(function(result){return function(){count--;if(count===0){cb2(result)()}}}))}if(head2===null){break loop}step=head2._2;if(tail2===null){head2=null}else{head2=tail2._1;tail2=tail2._2}break;case MAP:step=step._2;break;case APPLY:case ALT:if(head2){tail2=new Aff2(CONS,head2,tail2)}head2=step;step=step._1;break}}if(count===0){cb2(util.right(void 0))()}else{kid=0;tmp=count;for(;kid<tmp;kid++){kills2[kid]=kills2[kid]()}}return kills2}function join2(result,head2,tail2){var fail,step,lhs,rhs,tmp,kid;if(util.isLeft(result)){fail=result;step=null}else{step=result;fail=null}loop:while(true){lhs=null;rhs=null;tmp=null;kid=null;if(interrupt!==null){return}if(head2===null){cb(fail||step)();return}if(head2._3!==EMPTY){return}switch(head2.tag){case MAP:if(fail===null){head2._3=util.right(head2._1(util.fromRight(step)));step=head2._3}else{head2._3=fail}break;case APPLY:lhs=head2._1._3;rhs=head2._2._3;if(fail){head2._3=fail;tmp=true;kid=killId++;kills[kid]=kill(early,fail===lhs?head2._2:head2._1,(function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail2===null){join2(fail,null,null)}else{join2(fail,tail2._1,tail2._2)}}}));if(tmp){tmp=false;return}}else if(lhs===EMPTY||rhs===EMPTY){return}else{step=util.right(util.fromRight(lhs)(util.fromRight(rhs)));head2._3=step}break;case ALT:lhs=head2._1._3;rhs=head2._2._3;if(lhs===EMPTY&&util.isLeft(rhs)||rhs===EMPTY&&util.isLeft(lhs)){return}if(lhs!==EMPTY&&util.isLeft(lhs)&&rhs!==EMPTY&&util.isLeft(rhs)){fail=step===lhs?rhs:lhs;step=null;head2._3=fail}else{head2._3=step;tmp=true;kid=killId++;kills[kid]=kill(early,step===lhs?head2._2:head2._1,(function(){return function(){delete kills[kid];if(tmp){tmp=false}else if(tail2===null){join2(step,null,null)}else{join2(step,tail2._1,tail2._2)}}}));if(tmp){tmp=false;return}}break}if(tail2===null){head2=null}else{head2=tail2._1;tail2=tail2._2}}}function resolve(fiber){return function(result){return function(){delete fibers[fiber._1];fiber._3=result;join2(result,fiber._2._1,fiber._2._2)}}}function run4(){var status=CONTINUE;var step=par;var head2=null;var tail2=null;var tmp,fid;loop:while(true){tmp=null;fid=null;switch(status){case CONTINUE:switch(step.tag){case MAP:if(head2){tail2=new Aff2(CONS,head2,tail2)}head2=new Aff2(MAP,step._1,EMPTY,EMPTY);step=step._2;break;case APPLY:if(head2){tail2=new Aff2(CONS,head2,tail2)}head2=new Aff2(APPLY,EMPTY,step._2,EMPTY);step=step._1;break;case ALT:if(head2){tail2=new Aff2(CONS,head2,tail2)}head2=new Aff2(ALT,EMPTY,step._2,EMPTY);step=step._1;break;default:fid=fiberId++;status=RETURN;tmp=step;step=new Aff2(FORKED,fid,new Aff2(CONS,head2,tail2),EMPTY);tmp=Fiber(util,supervisor,tmp);tmp.onComplete({rethrow:false,handler:resolve(step)})();fibers[fid]=tmp;if(supervisor){supervisor.register(tmp)}}break;case RETURN:if(head2===null){break loop}if(head2._1===EMPTY){head2._1=step;status=CONTINUE;step=head2._2;head2._2=EMPTY}else{head2._2=step;step=head2;if(tail2===null){head2=null}else{head2=tail2._1;tail2=tail2._2}}}}root=step;for(fid=0;fid<fiberId;fid++){fibers[fid].run()}}function cancel(error3,cb2){interrupt=util.left(error3);var innerKills;for(var kid in kills){if(kills.hasOwnProperty(kid)){innerKills=kills[kid];for(kid in innerKills){if(innerKills.hasOwnProperty(kid)){innerKills[kid]()}}}}kills=null;var newKills=kill(error3,root,cb2);return function(killError){return new Aff2(ASYNC,(function(killCb){return function(){for(var kid2 in newKills){if(newKills.hasOwnProperty(kid2)){newKills[kid2]()}}return nonCanceler}}))}}run4();return function(killError){return new Aff2(ASYNC,(function(killCb){return function(){return cancel(killError,killCb)}}))}}function sequential2(util,supervisor,par){return new Aff2(ASYNC,(function(cb){return function(){return runPar(util,supervisor,par,cb)}}))}Aff2.EMPTY=EMPTY;Aff2.Pure=AffCtr(PURE);Aff2.Throw=AffCtr(THROW);Aff2.Catch=AffCtr(CATCH);Aff2.Sync=AffCtr(SYNC);Aff2.Async=AffCtr(ASYNC);Aff2.Bind=AffCtr(BIND);Aff2.Bracket=AffCtr(BRACKET);Aff2.Fork=AffCtr(FORK);Aff2.Seq=AffCtr(SEQ);Aff2.ParMap=AffCtr(MAP);Aff2.ParApply=AffCtr(APPLY);Aff2.ParAlt=AffCtr(ALT);Aff2.Fiber=Fiber;Aff2.Supervisor=Supervisor;Aff2.Scheduler=Scheduler;Aff2.nonCanceler=nonCanceler;return Aff2}();var _pure=Aff.Pure;var _throwError=Aff.Throw;function _catchError(aff){return function(k){return Aff.Catch(aff,k)}}function _map(f){return function(aff){if(aff.tag===Aff.Pure.tag){return Aff.Pure(f(aff._1))}else{return Aff.Bind(aff,(function(value2){return Aff.Pure(f(value2))}))}}}function _bind(aff){return function(k){return Aff.Bind(aff,k)}}var _liftEffect=Aff.Sync;var makeAff=Aff.Async;function _makeFiber(util,aff){return function(){return Aff.Fiber(util,null,aff)}}var _delay=function(){function setDelay(n,k){if(n===0&&typeof setImmediate!=="undefined"){return setImmediate(k)}else{return setTimeout(k,n)}}function clearDelay(n,t){if(n===0&&typeof clearImmediate!=="undefined"){return clearImmediate(t)}else{return clearTimeout(t)}}return function(right,ms){return Aff.Async((function(cb){return function(){var timer=setDelay(ms,cb(right()));return function(){return Aff.Sync((function(){return right(clearDelay(ms,timer))}))}}}))}}();var _sequential=Aff.Seq;function error(msg){return new Error(msg)}function message(e){return e.message}function throwException(e){return function(){throw e}}var $$throw=function($4){return throwException(error($4))};var catchError=function(dict){return dict.catchError};var $$try=function(dictMonadError){var catchError1=catchError(dictMonadError);var Monad0=dictMonadError.MonadThrow0().Monad0();var map6=map(Monad0.Bind1().Apply0().Functor0());var pure4=pure(Monad0.Applicative0());return function(a){return catchError1(map6(Right.create)(a))((function($52){return pure4(Left.create($52))}))}};var _new=function(val){return function(){return{value:val}}};var read=function(ref){return function(){return ref.value}};var write=function(val){return function(ref){return function(){ref.value=val}}};var $$new=_new;var liftEffect=function(dict){return dict.liftEffect};var traverseArrayImpl=function(){function array1(a){return[a]}function array2(a){return function(b){return[a,b]}}function array3(a){return function(b){return function(c){return[a,b,c]}}}function concat2(xs){return function(ys){return xs.concat(ys)}}return function(apply2){return function(map6){return function(pure4){return function(f){return function(array){function go(bot,top3){switch(top3-bot){case 0:return pure4([]);case 1:return map6(array1)(f(array[bot]));case 2:return apply2(map6(array2)(f(array[bot])))(f(array[bot+1]));case 3:return apply2(apply2(map6(array3)(f(array[bot])))(f(array[bot+1])))(f(array[bot+2]));default:var pivot=bot+Math.floor((top3-bot)/4)*2;return apply2(map6(concat2)(go(bot,pivot)))(go(pivot,top3))}}return go(0,array.length)}}}}}}();var _unsafePartial=function(f){return f()};var _crashWith=function(msg){throw new Error(msg)};var crashWith=function(){return _crashWith};var crashWith2=crashWith();var unsafePartial=_unsafePartial;var unsafeCrashWith=function(msg){return unsafePartial((function(){return crashWith2(msg)}))};var $runtime_lazy2=function(name2,moduleName,init4){var state2=0;var val;return function(lineNumber){if(state2===2)return val;if(state2===1)throw new ReferenceError(name2+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state2=1;val=init4();state2=2;return val}};var $$void2=$$void(functorEffect);var functorAff={map:_map};var ffiUtil=function(){var unsafeFromRight=function(v){if(v instanceof Right){return v.value0}if(v instanceof Left){return unsafeCrashWith("unsafeFromRight: Left")}throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[v.constructor.name])};var unsafeFromLeft=function(v){if(v instanceof Left){return v.value0}if(v instanceof Right){return unsafeCrashWith("unsafeFromLeft: Right")}throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[v.constructor.name])};var isLeft=function(v){if(v instanceof Left){return true}if(v instanceof Right){return false}throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[v.constructor.name])};return{isLeft:isLeft,fromLeft:unsafeFromLeft,fromRight:unsafeFromRight,left:Left.create,right:Right.create}}();var makeFiber=function(aff){return _makeFiber(ffiUtil,aff)};var launchAff=function(aff){return function __do(){var fiber=makeFiber(aff)();fiber.run();return fiber}};var monadAff={Applicative0:function(){return applicativeAff},Bind1:function(){return bindAff}};var bindAff={bind:_bind,Apply0:function(){return $lazy_applyAff(0)}};var applicativeAff={pure:_pure,Apply0:function(){return $lazy_applyAff(0)}};var $lazy_applyAff=$runtime_lazy2("applyAff","Effect.Aff",(function(){return{apply:ap(monadAff),Functor0:function(){return functorAff}}}));var bindFlipped2=bindFlipped(bindAff);var monadEffectAff={liftEffect:_liftEffect,Monad0:function(){return monadAff}};var liftEffect2=liftEffect(monadEffectAff);var monadThrowAff={throwError:_throwError,Monad0:function(){return monadAff}};var monadErrorAff={catchError:_catchError,MonadThrow0:function(){return monadThrowAff}};var $$try2=$$try(monadErrorAff);var runAff=function(k){return function(aff){return launchAff(bindFlipped2((function($83){return liftEffect2(k($83))}))($$try2(aff)))}};var runAff_=function(k){return function(aff){return $$void2(runAff(k)(aff))}};var log=function(s){return function(){console.log(s)}};function querySelector_(selector){return document.querySelector(selector)}function createWindowListener_(eventName,updater){window.addEventListener(eventName,(function(event){updater(event)()}))}function createDocumentListener_(eventName,updater){document.addEventListener(eventName,(function(event){updater(event)()}))}function createCustomListener_(eventName,updater){document.addEventListener(eventName,(function(event){updater(event.detail)()}))}function nullable(a,r,f){return a==null?r:f(a)}var toMaybe=function(n){return nullable(n,Nothing.value,Just.create)};var runEffectFn1=function runEffectFn12(fn){return function(a){return function(){return fn(a)}}};var runEffectFn2=function runEffectFn22(fn){return function(a){return function(b){return function(){return fn(a,b)}}}};var runEffectFn4=function runEffectFn42(fn){return function(a){return function(b){return function(c){return function(d){return function(){return fn(a,b,c,d)}}}}}};var querySelector=function(selector){return function __do(){var selected=querySelector_(selector);return toMaybe(selected)}};var createWindowListener=runEffectFn2(createWindowListener_);var createDocumentListener=runEffectFn2(createDocumentListener_);var createCustomListener=runEffectFn2(createCustomListener_);var regexImpl=function(left){return function(right){return function(s1){return function(s2){try{return right(new RegExp(s1,s2))}catch(e){return left(e.message)}}}}};var _replaceBy=function(just){return function(nothing){return function(r){return function(f){return function(s){return s.replace(r,(function(match){var groups=[];var group4,i=1;while(typeof(group4=arguments[i++])!=="number"){groups.push(group4==null?nothing:just(group4))}return f(match)(groups)}))}}}}};var singleton=function(c){return c};var length=function(s){return s.length};var drop=function(n){return function(s){return s.substring(n)}};var charAt=function(i){return function(s){if(i>=0&&i<s.length)return s.charAt(i);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var split=function(sep){return function(s){return s.split(sep)}};var toLower=function(s){return s.toLowerCase()};var toUpper=function(s){return s.toUpperCase()};var $$null=function(s){return s===""};var global={global:true,ignoreCase:false,multiline:false,dotAll:false,sticky:false,unicode:false};var replace$prime=function(){return _replaceBy(Just.create)(Nothing.value)}();var renderFlags=function(v){return function(){if(v.global){return"g"}return""}()+(function(){if(v.ignoreCase){return"i"}return""}()+(function(){if(v.multiline){return"m"}return""}()+(function(){if(v.dotAll){return"s"}return""}()+(function(){if(v.sticky){return"y"}return""}()+function(){if(v.unicode){return"u"}return""}()))))};var regex=function(s){return function(f){return regexImpl(Left.create)(Right.create)(s)(renderFlags(f))}};var classData=2;var propertyData=3;function createProperty(name2){return function(value2){return[propertyData,name2,value2]}}function createClass(array){return[classData,array]}var replicateFill=function(count,value2){if(count<1){return[]}var result=new Array(count);return result.fill(value2)};var replicatePolyfill=function(count,value2){var result=[];var n=0;for(var i=0;i<count;i++){result[n++]=value2}return result};var replicateImpl=typeof Array.prototype.fill==="function"?replicateFill:replicatePolyfill;var fromFoldableImpl=function(){function Cons2(head2,tail2){this.head=head2;this.tail=tail2}var emptyList={};function curryCons(head2){return function(tail2){return new Cons2(head2,tail2)}}function listToArray(list){var result=[];var count=0;var xs=list;while(xs!==emptyList){result[count++]=xs.head;xs=xs.tail}return result}return function(foldr2,xs){return listToArray(foldr2(curryCons)(emptyList)(xs))}}();var findIndexImpl=function(just,nothing,f,xs){for(var i=0,l=xs.length;i<l;i++){if(f(xs[i]))return just(i)}return nothing};var _deleteAt=function(just,nothing,i,l){if(i<0||i>=l.length)return nothing;var l1=l.slice();l1.splice(i,1);return just(l1)};var _updateAt=function(just,nothing,i,a,l){if(i<0||i>=l.length)return nothing;var l1=l.slice();l1[i]=a;return just(l1)};var filterImpl=function(f,xs){return xs.filter(f)};var sortByImpl=function(){function mergeFromTo(compare2,fromOrdering,xs1,xs2,from3,to3){var mid;var i;var j;var k;var x;var y;var c;mid=from3+(to3-from3>>1);if(mid-from3>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,from3,mid);if(to3-mid>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,mid,to3);i=from3;j=mid;k=from3;while(i<mid&&j<to3){x=xs2[i];y=xs2[j];c=fromOrdering(compare2(x)(y));if(c>0){xs1[k++]=y;++j}else{xs1[k++]=x;++i}}while(i<mid){xs1[k++]=xs2[i++]}while(j<to3){xs1[k++]=xs2[j++]}}return function(compare2,fromOrdering,xs){var out;if(xs.length<2)return xs;out=xs.slice(0);mergeFromTo(compare2,fromOrdering,out,xs.slice(0),0,xs.length);return out}}();function unsafeFreezeThawImpl(xs){return xs}var unsafeFreezeImpl=unsafeFreezeThawImpl;function copyImpl(xs){return xs.slice()}var thawImpl=copyImpl;var sortByImpl2=function(){function mergeFromTo(compare2,fromOrdering,xs1,xs2,from3,to3){var mid;var i;var j;var k;var x;var y;var c;mid=from3+(to3-from3>>1);if(mid-from3>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,from3,mid);if(to3-mid>1)mergeFromTo(compare2,fromOrdering,xs2,xs1,mid,to3);i=from3;j=mid;k=from3;while(i<mid&&j<to3){x=xs2[i];y=xs2[j];c=fromOrdering(compare2(x)(y));if(c>0){xs1[k++]=y;++j}else{xs1[k++]=x;++i}}while(i<mid){xs1[k++]=xs2[i++]}while(j<to3){xs1[k++]=xs2[j++]}}return function(compare2,fromOrdering,xs){if(xs.length<2)return xs;mergeFromTo(compare2,fromOrdering,xs,xs.slice(0),0,xs.length);return xs}}();var pushImpl=function(a,xs){return xs.push(a)};var runSTFn1=function runSTFn12(fn){return function(a){return function(){return fn(a)}}};var runSTFn2=function runSTFn22(fn){return function(a){return function(b){return function(){return fn(a,b)}}}};var unsafeFreeze=runSTFn1(unsafeFreezeImpl);var thaw=runSTFn1(thawImpl);var withArray=function(f){return function(xs){return function __do(){var result=thaw(xs)();f(result)();return unsafeFreeze(result)()}}};var push=runSTFn2(pushImpl);var runFn2=function(fn){return function(a){return function(b){return fn(a,b)}}};var runFn4=function(fn){return function(a){return function(b){return function(c){return function(d){return fn(a,b,c,d)}}}}};var runFn5=function(fn){return function(a){return function(b){return function(c){return function(d){return function(e){return fn(a,b,c,d,e)}}}}}};var fromJust2=fromJust();var updateAt=function(){return runFn5(_updateAt)(Just.create)(Nothing.value)}();var snoc=function(xs){return function(x){return withArray(push(x))(xs)()}};var singleton3=function(a){return[a]};var findIndex=function(){return runFn4(findIndexImpl)(Just.create)(Nothing.value)}();var filter=runFn2(filterImpl);var deleteAt=function(){return runFn4(_deleteAt)(Just.create)(Nothing.value)}();var deleteBy=function(v){return function(v1){return function(v2){if(v2.length===0){return[]}return maybe(v2)((function(i){return fromJust2(deleteAt(i)(v2))}))(findIndex(v(v1))(v2))}}};var $$delete=function(dictEq){return deleteBy(eq(dictEq))};var concatMap=flip(bind(bindArray));var hasArrayFrom=typeof Array.from==="function";var hasStringIterator=typeof Symbol!=="undefined"&&Symbol!=null&&typeof Symbol.iterator!=="undefined"&&typeof String.prototype[Symbol.iterator]==="function";var hasFromCodePoint=typeof String.prototype.fromCodePoint==="function";var hasCodePointAt=typeof String.prototype.codePointAt==="function";var _singleton=function(fallback){return hasFromCodePoint?String.fromCodePoint:fallback};function toCharCode(c){return c.charCodeAt(0)}function fromCharCode(c){return String.fromCharCode(c)}var bottom1=bottom(boundedChar);var top1=top(boundedChar);var toEnum=function(dict){return dict.toEnum};var fromEnum=function(dict){return dict.fromEnum};var toEnumWithDefaults=function(dictBoundedEnum){var toEnum1=toEnum(dictBoundedEnum);var fromEnum1=fromEnum(dictBoundedEnum);var bottom22=bottom(dictBoundedEnum.Bounded0());return function(low){return function(high){return function(x){var v=toEnum1(x);if(v instanceof Just){return v.value0}if(v instanceof Nothing){var $140=x<fromEnum1(bottom22);if($140){return low}return high}throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[v.constructor.name])}}}};var defaultSucc=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)+1|0)}}};var defaultPred=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)-1|0)}}};var charToEnum=function(v){if(v>=toCharCode(bottom1)&&v<=toCharCode(top1)){return new Just(fromCharCode(v))}return Nothing.value};var enumChar={succ:defaultSucc(charToEnum)(toCharCode),pred:defaultPred(charToEnum)(toCharCode),Ord0:function(){return ordChar}};var boundedEnumChar=function(){return{cardinality:toCharCode(top1)-toCharCode(bottom1)|0,toEnum:charToEnum,fromEnum:toCharCode,Bounded0:function(){return boundedChar},Enum1:function(){return enumChar}}}();var fromNumberImpl=function(just){return function(nothing){return function(n){return(n|0)===n?just(n):nothing}}};var toNumber=function(n){return n};var fromStringAsImpl=function(just){return function(nothing){return function(radix){var digits;if(radix<11){digits="[0-"+(radix-1).toString()+"]"}else if(radix===11){digits="[0-9a]"}else{digits="[0-9a-"+String.fromCharCode(86+radix)+"]"}var pattern=new RegExp("^[\\+\\-]?"+digits+"+$","i");return function(s){if(pattern.test(s)){var i=parseInt(s,radix);return(i|0)===i?just(i):nothing}else{return nothing}}}}};var isFiniteImpl=isFinite;var floor=Math.floor;var top2=top(boundedInt);var bottom2=bottom(boundedInt);var fromStringAs=function(){return fromStringAsImpl(Just.create)(Nothing.value)}();var fromString=fromStringAs(10);var fromNumber=function(){return fromNumberImpl(Just.create)(Nothing.value)}();var unsafeClamp=function(x){if(!isFiniteImpl(x)){return 0}if(x>=toNumber(top2)){return top2}if(x<=toNumber(bottom2)){return bottom2}if(otherwise){return fromMaybe(0)(fromNumber(x))}throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[x.constructor.name])};var floor2=function($39){return unsafeClamp(floor($39))};var fromEnum2=fromEnum(boundedEnumChar);var div2=div(euclideanRingInt);var mod2=mod(euclideanRingInt);var unsurrogate=function(lead){return function(trail){return(((lead-55296|0)*1024|0)+(trail-56320|0)|0)+65536|0}};var isTrail=function(cu){return 56320<=cu&&cu<=57343};var isLead=function(cu){return 55296<=cu&&cu<=56319};var uncons=function(s){var v=length(s);if(v===0){return Nothing.value}if(v===1){return new Just({head:fromEnum2(charAt(0)(s)),tail:""})}var cu1=fromEnum2(charAt(1)(s));var cu0=fromEnum2(charAt(0)(s));var $43=isLead(cu0)&&isTrail(cu1);if($43){return new Just({head:unsurrogate(cu0)(cu1),tail:drop(2)(s)})}return new Just({head:cu0,tail:drop(1)(s)})};var fromCharCode2=function(){var $75=toEnumWithDefaults(boundedEnumChar)(bottom(boundedChar))(top(boundedChar));return function($76){return singleton($75($76))}}();var singletonFallback=function(v){if(v<=65535){return fromCharCode2(v)}var lead=div2(v-65536|0)(1024)+55296|0;var trail=mod2(v-65536|0)(1024)+56320|0;return fromCharCode2(lead)+fromCharCode2(trail)};var singleton4=_singleton(singletonFallback);function toArrayWithKey(f){return function(m){var r=[];for(var k in m){if(hasOwnProperty.call(m,k)){r.push(f(k)(m[k]))}}return r}}var keys=Object.keys||toArrayWithKey((function(k){return function(){return k}}));var fromJust3=fromJust();var crashWith3=crashWith();var show2=show(showString);var map2=map(functorArray);var toClassListString={to:function(){var $46=filter(function(){var $49=not(heytingAlgebraBoolean);return function($50){return $49($$null($50))}}());var $47=split(" ");return function($48){return $46($47($48))}}()};var value=createProperty("value");var type$prime=createProperty("type");var to=function(dict){return dict.to};var caseify=function(name$prime){if(name$prime===toUpper(name$prime)){return toLower(name$prime)}if(otherwise){var v=fromJust3(uncons(name$prime));var replacer=function($133){return $$const(function(v1){return"-"+v1}(toLower($133)))};var regex2=function(){var v1=regex("[A-Z]")(global);if(v1 instanceof Right){return v1.value0}if(v1 instanceof Left){return crashWith3(show2(v1.value0))}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 90, column 40 - line 92, column 57): "+[v1.constructor.name])}();var hyphenated=replace$prime(regex2)(replacer)(v.tail);return toLower(singleton4(v.head))+hyphenated}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 83, column 1 - line 83, column 26): "+[name$prime.constructor.name])};var class$prime=function(dictToClassList){var $134=map2(caseify);var $135=to(dictToClassList);return function($136){return createClass($134($135($136)))}};var booleanToFalsyString=function(v){if(v){return"true"}if(!v){return""}throw new Error("Failed pattern match at Flame.Html.Attribute.Internal (line 66, column 7 - line 68, column 23): "+[v.constructor.name])};var checked=function(){var $140=createProperty("checked");return function($141){return $140(booleanToFalsyString($141))}}();var textNode=1;var elementNode=2;var svgNode=3;var styleData=1;var classData2=2;var propertyData2=3;var attributeData=4;var keyData=7;function createElementNode(tag){return function(nodeData){return function(potentialChildren){let children=potentialChildren,text2=void 0;if(potentialChildren.length===1&&potentialChildren[0].nodeType==textNode){children=void 0;text2=potentialChildren[0].text}return{nodeType:elementNode,node:void 0,tag:tag,nodeData:fromNodeData(nodeData),children:children,text:text2}}}}function createDatalessElementNode(tag){return function(potentialChildren){let children=potentialChildren,text2=void 0;if(potentialChildren.length===1&&potentialChildren[0].nodeType==textNode){children=void 0;text2=potentialChildren[0].text}return{nodeType:elementNode,node:void 0,tag:tag,nodeData:{},children:children,text:text2}}}function createSingleElementNode(tag){return function(nodeData){return{nodeType:elementNode,node:void 0,tag:tag,nodeData:fromNodeData(nodeData)}}}function createEmptyElement(tag){return{nodeType:tag.trim().toLowerCase()==="svg"?svgNode:elementNode,node:void 0,tag:tag,nodeData:{}}}function text(value2){return{nodeType:textNode,node:void 0,text:value2}}function fromNodeData(allData){let nodeData={};if(allData!==void 0)for(let data of allData){let dataOne=data[1];switch(data[0]){case styleData:if(nodeData.styles===void 0)nodeData.styles={};for(let key in dataOne)nodeData.styles[key]=dataOne[key];break;case classData2:if(nodeData.classes===void 0)nodeData.classes=[];nodeData.classes=nodeData.classes.concat(dataOne);break;case propertyData2:if(nodeData.properties===void 0)nodeData.properties={};nodeData.properties[dataOne]=data[2];break;case attributeData:if(nodeData.attributes===void 0)nodeData.attributes={};nodeData.attributes[dataOne]=data[2];break;case keyData:nodeData.key=dataOne;break;default:if(nodeData.events===void 0)nodeData.events={};if(nodeData.events[dataOne]===void 0)nodeData.events[dataOne]=[];nodeData.events[dataOne].push(data[2])}}return nodeData}var toNodeNodeDataNodeData={toNode:singleton3};var toNodeHtmlHtml={toNode:singleton3};var toNode=function(dict){return dict.toNode};var toNodeArray=function(dictToNode){return{toNode:concatMap(toNode(dictToNode))}};var createElement_=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(children){return createDatalessElementNode(tag)(toNode1(children))}}};var div_=function(dictToNode){return createElement_("div")(dictToNode)};var i_=function(dictToNode){return createElement_("i")(dictToNode)};var nav_=function(dictToNode){return createElement_("nav")(dictToNode)};var span_=function(dictToNode){return createElement_("span")(dictToNode)};var createElement$prime=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(nodeData){return createSingleElementNode(tag)(toNode1(nodeData))}}};var input=function(dictToNode){return createElement$prime("input")(dictToNode)};var createElement=function(tag){return function(dictToNode){var toNode1=toNode(dictToNode);return function(dictToNode1){var toNode2=toNode(dictToNode1);return function(nodeData){return function(children){return createElementNode(tag)(toNode1(nodeData))(toNode2(children))}}}}};var div3=function(dictToNode){return function(dictToNode1){return createElement("div")(dictToNode)(dictToNode1)}};var h6=function(dictToNode){return function(dictToNode1){return createElement("h6")(dictToNode)(dictToNode1)}};var header=function(dictToNode){return function(dictToNode1){return createElement("header")(dictToNode)(dictToNode1)}};var label=function(dictToNode){return function(dictToNode1){return createElement("label")(dictToNode)(dictToNode1)}};var main=function(dictToNode){return function(dictToNode1){return createElement("main")(dictToNode)(dictToNode1)}};var nav=function(dictToNode){return function(dictToNode1){return createElement("nav")(dictToNode)(dictToNode1)}};var span=function(dictToNode){return function(dictToNode1){return createElement("span")(dictToNode)(dictToNode1)}};var button=function(dictToNode){return function(dictToNode1){return createElement("button")(dictToNode)(dictToNode1)}};var br=createEmptyElement("br");var article_=function(dictToNode){return createElement_("article")(dictToNode)};var reUnescapedHtml=/[&<>"']/g;var reHasUnescapedHtml=RegExp(reUnescapedHtml.source);var traverse1Impl=function(){function Cont(fn){this.fn=fn}var emptyList={};var ConsCell=function(head2,tail2){this.head=head2;this.tail=tail2};function finalCell(head2){return new ConsCell(head2,emptyList)}function consList(x){return function(xs){return new ConsCell(x,xs)}}function listToArray(list){var arr=[];var xs=list;while(xs!==emptyList){arr.push(xs.head);xs=xs.tail}return arr}return function(apply2,map6,f){var buildFrom=function(x,ys){return apply2(map6(consList)(f(x)))(ys)};var go=function(acc,currentLen,xs){if(currentLen===0){return acc}else{var last3=xs[currentLen-1];return new Cont((function(){var built=go(buildFrom(last3,acc),currentLen-1,xs);return built}))}};return function(array){var acc=map6(finalCell)(f(array[array.length-1]));var result=go(acc,array.length-1,array);while(result instanceof Cont){result=result.fn()}return map6(listToArray)(result)}}}();function compareReference(a){return function(b){return a===b}}var modelHasChanged=function(old){return function($$new2){return!compareReference(old)($$new2)}};var namespace="http://www.w3.org/2000/svg";var eventPrefix="__flame_";var eventPostfix="updater";var textNode2=1;var elementNode2=2;var svgNode2=3;var fragmentNode=4;var lazyNode=5;var managedNode=6;var nonBubblingEvents=["focus","blur","scroll","load","unload"];function start_(eventWrapper,root,updater,html){return new F(eventWrapper,root,updater,html,false)}function startFrom_(eventWrapper,root,updater,html){return new F(eventWrapper,root,updater,html,true)}function resume_(f,html){f.resume(html)}function F(eventWrapper,root,updater,html,isDry){this.eventWrapper=eventWrapper;this.applicationEvents=new Map;this.root=root;this.updater=updater;this.cachedHtml=html.node===void 0?html:shallowCopy(html);if(isDry)this.hydrate(this.root,this.cachedHtml);else this.createAllNodes(this.root,this.cachedHtml)}F.prototype.hydrate=function(parent,html,referenceNode){switch(html.nodeType){case lazyNode:html.node=parent;html.rendered=html.render(html.arg);html.render=void 0;this.hydrate(parent,html.rendered);break;case textNode2:html.node=parent;break;case managedNode:this.createAllNodes(parent,html,referenceNode);break;default:if(html.nodeType===fragmentNode)html.node=document.createDocumentFragment();else{html.node=parent;if(html.nodeData.events!==void 0)this.createAllEvents(parent,html)}let htmlChildrenLength;if(html.text===void 0&&html.children!==void 0&&(htmlChildrenLength=html.children.length)>0){let childNodes=parent.childNodes;for(let i=0,cni=0;i<htmlChildrenLength;++i,++cni){let c=html.children[i]=html.children[i].node===void 0?html.children[i]:shallowCopy(html.children[i]);if(childNodes[cni]===void 0)this.createAllNodes(parent,c);else{if(c.nodeType===fragmentNode){let fragmentChildrenLength=c.children.length;c.node=document.createDocumentFragment();for(let j=0;j<fragmentChildrenLength;++j){let cf=c.children[j]=c.children[j].node===void 0?c.children[j]:shallowCopy(c.children[j]);this.hydrate(childNodes[cni++],cf)}cni--}else if(c.nodeType===managedNode)this.hydrate(parent,c,childNodes[cni]);else this.hydrate(childNodes[cni],c)}}}}};function shallowCopy(origin){switch(origin.nodeType){case textNode2:return{nodeType:textNode2,node:void 0,text:origin.text};case fragmentNode:return{nodeType:fragmentNode,node:void 0,children:origin.children};case lazyNode:return{nodeType:lazyNode,node:void 0,nodeData:origin.nodeData,render:origin.render,arg:origin.arg,rendered:void 0,messageMapper:origin.messageMapper};case managedNode:return{nodeType:managedNode,node:void 0,nodeData:origin.nodeData,createNode:origin.createNode,updateNode:origin.updateNode,arg:origin.arg,messageMapper:origin.messageMapper};default:return{nodeType:origin.nodeType,node:void 0,tag:origin.tag,nodeData:origin.nodeData,children:origin.children,text:origin.text,messageMapper:origin.messageMapper}}}F.prototype.createAllNodes=function(parent,html,referenceNode){let node=this.createNode(html);if(html.text!==void 0)node.textContent=html.text;else{if(html.children!==void 0)this.createChildrenNodes(node,html.children);else if(html.rendered!==void 0){if(html.messageMapper!==void 0)lazyMessageMap(html.messageMapper,html.rendered);if(html.rendered.text!==void 0){node.textContent=html.rendered.text}else if(html.rendered.children!==void 0)this.createChildrenNodes(node,html.rendered.children)}}parent.insertBefore(node,referenceNode)};F.prototype.checkCreateAllNodes=function(parent,html,referenceNode){if(html.node!==void 0)html=shallowCopy(html);this.createAllNodes(parent,html,referenceNode);return html};F.prototype.createChildrenNodes=function(parent,children){let childrenLength=children.length;for(let i=0;i<childrenLength;++i){let html=children[i]=children[i].node===void 0?children[i]:shallowCopy(children[i]);this.checkCreateAllNodes(parent,html,null)}};F.prototype.createNode=function(html){switch(html.nodeType){case lazyNode:html.rendered=html.render(html.arg);html.render=void 0;return html.node=this.createNode(html.rendered);case textNode2:return html.node=document.createTextNode(html.text);case elementNode2:return html.node=this.createElement(html);case svgNode2:return html.node=this.createSvg(html);case fragmentNode:return html.node=document.createDocumentFragment();case managedNode:return html.node=this.createManagedNode(html)}};F.prototype.createElement=function(html){let element=document.createElement(html.tag);this.createNodeData(element,html,false);return element};F.prototype.createSvg=function(html){let svg=document.createElementNS(namespace,html.tag);this.createNodeData(svg,html,true);return svg};F.prototype.createManagedNode=function(html){let node=html.createNode(html.arg)();html.createNode=void 0;this.createNodeData(node,html,node instanceof SVGElement||node.nodeName.toLowerCase()==="svg");return node};F.prototype.createNodeData=function(node,html,isSvg){if(html.nodeData.styles!==void 0)createStyles(node,html.nodeData.styles);if(html.nodeData.classes!==void 0&&html.nodeData.classes.length>0)createClasses(node,html.nodeData.classes,isSvg);if(html.nodeData.attributes!==void 0)createAttributes(node,html.nodeData.attributes);if(html.nodeData.properties!==void 0)for(let key in html.nodeData.properties)node[key]=html.nodeData.properties[key];if(html.nodeData.events!==void 0)this.createAllEvents(node,html)};function createStyles(node,styles){for(let key in styles)node.style.setProperty(key,styles[key])}function createClasses(node,classes,isSvg){let joined=classes.join(" ");if(isSvg)node.setAttribute("class",joined);else node.className=joined}function createAttributes(node,attributes){for(let key in attributes)node.setAttribute(key,attributes[key])}F.prototype.createAllEvents=function(node,html){for(let key in html.nodeData.events)this.createEvent(node,key,html)};F.prototype.createEvent=function(node,name2,html){let handlers=html.nodeData.events[name2],eventKey=eventPrefix+name2;if(nonBubblingEvents.includes(name2)){let runNonBubblingEvent=this.runNonBubblingEvent(handlers,html.messageMapper);node[eventKey]=runNonBubblingEvent;node.addEventListener(name2,runNonBubblingEvent,false)}else{node[eventKey]=handlers;if(html.messageMapper!==void 0)node[eventKey+eventPostfix]=html.messageMapper;let synthetic=this.applicationEvents.get(name2);if(synthetic===void 0){let runEvent=this.runEvent.bind(this);this.root.addEventListener(name2,runEvent,false);this.applicationEvents.set(name2,{count:1,handler:runEvent})}else synthetic.count++}};F.prototype.runNonBubblingEvent=function(handlers,messageMapper2){return function(event){this.runHandlers(handlers,messageMapper2,event)}.bind(this)};F.prototype.runEvent=function(event){let node=event.target,eventKey=eventPrefix+event.type;while(node!==this.root){let handlers=node[eventKey];if(handlers!==void 0){this.runHandlers(handlers,node[eventKey+eventPostfix],event);return}node=node.parentNode}};F.prototype.runHandlers=function(handlers,messageMapper2,event){let handlersLength=handlers.length;for(let i=0;i<handlersLength;++i){let h=handlers[i],maybeMessage=typeof h==="function"?h(event)():this.eventWrapper(h);this.updater(messageMapper2===void 0?maybeMessage:messageMapper2(maybeMessage))()}event.stopPropagation()};F.prototype.resume=function(updatedHtml){this.cachedHtml=this.updateAllNodes(this.root,this.cachedHtml,updatedHtml)};F.prototype.updateAllNodes=function(parent,currentHtml2,updatedHtml){if(updatedHtml.node!==void 0)updatedHtml=shallowCopy(updatedHtml);if(currentHtml2.tag!==updatedHtml.tag||currentHtml2.nodeType!==updatedHtml.nodeType){if(currentHtml2.nodeType===fragmentNode){this.createAllNodes(parent,updatedHtml,firstFragmentChildNode(currentHtml2.children));removeFragmentChildren(parent,currentHtml2.children)}else{this.createAllNodes(parent,updatedHtml,currentHtml2.node);parent.removeChild(currentHtml2.node)}}else{updatedHtml.node=currentHtml2.node;switch(updatedHtml.nodeType){case lazyNode:if(updatedHtml.arg!==currentHtml2.arg){updatedHtml.rendered=updatedHtml.render(updatedHtml.arg);if(updatedHtml.messageMapper!==void 0)lazyMessageMap(updatedHtml.messageMapper,updatedHtml.rendered);this.updateAllNodes(parent,currentHtml2.rendered,updatedHtml.rendered)}else updatedHtml.rendered=currentHtml2.rendered;updatedHtml.render=void 0;break;case managedNode:let node=updatedHtml.updateNode(currentHtml2.node)(currentHtml2.arg)(updatedHtml.arg)(),isSvg=node instanceof SVGElement||node.nodeName.toLowerCase()==="svg";if(node!==currentHtml2.node||node.nodeType!==currentHtml2.node.nodeType||node.nodeName!==currentHtml2.node.nodeName){this.createNodeData(node,updatedHtml,isSvg);parent.insertBefore(node,currentHtml2.node);parent.removeChild(currentHtml2.node)}else this.updateNodeData(node,currentHtml2.nodeData,updatedHtml,isSvg);updatedHtml.node=node;break;case textNode2:if(updatedHtml.text!==currentHtml2.text)updatedHtml.node.textContent=updatedHtml.text;break;case fragmentNode:this.updateChildrenNodes(parent,currentHtml2,updatedHtml);break;default:this.updateNodeData(currentHtml2.node,currentHtml2.nodeData,updatedHtml,updatedHtml.nodeType==svgNode2);if((updatedHtml.text!==void 0||updatedHtml.children===void 0&&currentHtml2.text!=void 0)&&!hasInnerHtml(updatedHtml.nodeData)&&updatedHtml.text!=currentHtml2.node.textContent)currentHtml2.node.textContent=updatedHtml.text;else this.updateChildrenNodes(currentHtml2.node,currentHtml2,updatedHtml)}}return updatedHtml};function firstFragmentChildNode(children){let childrenLength=children.length;for(let i=0;i<childrenLength;++i){if(children[i].nodeType===fragmentNode)return firstFragmentChildNode(children[i].children);return children[i].node}return void 0}function removeFragmentChildren(parent,children){let childrenLength=children.length;for(let i=0;i<childrenLength;++i)if(children[i].nodeType===fragmentNode)removeFragmentChildren(children[i].children);else parent.removeChild(children[i].node)}function clearNode(node){node.textContent=""}F.prototype.updateChildrenNodes=function(parent,currentHtml2,updatedHtml){let currentChildren=currentHtml2.children,updatedChildren=updatedHtml.children;if(currentChildren===void 0||currentChildren.length===0){let updatedChildrenLength;if(updatedChildren!==void 0&&(updatedChildrenLength=updatedChildren.length)>0){if(currentHtml2.text!==void 0||hasInnerHtml(currentHtml2.nodeData))clearNode(parent);for(let i=0;i<updatedChildrenLength;++i)updatedChildren[i]=this.checkCreateAllNodes(parent,updatedChildren[i])}}else if(updatedChildren===void 0||updatedChildren.length===0){if(currentChildren!==void 0&&(currentChildren.length>0||currentHtml2.text!==void 0)&&!hasInnerHtml(updatedHtml.nodeData))clearNode(parent)}else if(currentChildren[0].nodeData!==void 0&&currentChildren[0].nodeData.key!==void 0&&updatedChildren[0].nodeData!==void 0&&updatedChildren[0].nodeData.key!==void 0)this.updateKeyedChildrenNodes(parent,currentChildren,updatedChildren);else this.updateNonKeyedChildrenNodes(parent,currentChildren,updatedChildren)};function hasInnerHtml(parentNodeData){return parentNodeData!==void 0&&parentNodeData.properties!==void 0&&parentNodeData.properties.innerHTML!==void 0}F.prototype.updateKeyedChildrenNodes=function(parent,currentChildren,updatedChildren){let currentStart=0,updatedStart=0,currentEnd=currentChildren.length-1,updatedEnd=updatedChildren.length-1;let afterNode,currentStartNode=currentChildren[currentStart].node,updatedStartNode=currentStartNode,currentEndNode=currentChildren[currentEnd].node;let loop=true;fixes:while(loop){loop=false;let currentHtml2=currentChildren[currentStart],updatedHtml=updatedChildren[updatedStart];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){updatedHtml=this.updateAllNodes(parent,currentHtml2,updatedHtml);updatedStartNode=currentStartNode=currentHtml2.node.nextSibling;currentStart++;updatedStart++;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedStart]}currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedEnd];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){updatedHtml=this.updateAllNodes(parent,currentHtml2,updatedHtml);afterNode=currentEndNode;currentEndNode=currentEndNode.previousSibling;currentEnd--;updatedEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedEnd]}currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedStart];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){loop=true;updatedHtml=this.updateAllNodes(parent,currentHtml2,updatedHtml);currentEndNode=currentHtml2.node.previousSibling;parent.insertBefore(currentHtml2.node,updatedStartNode);updatedStart++;currentEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentEnd];updatedHtml=updatedChildren[updatedStart]}currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedEnd];while(currentHtml2.nodeData.key===updatedHtml.nodeData.key){loop=true;updatedHtml=this.updateAllNodes(parent,currentHtml2,updatedHtml);parent.insertBefore(currentHtml2.node,afterNode);afterNode=currentHtml2.node;currentStart++;updatedEnd--;if(currentEnd<currentStart||updatedEnd<updatedStart)break fixes;currentHtml2=currentChildren[currentStart];updatedHtml=updatedChildren[updatedEnd]}}if(updatedEnd<updatedStart)while(currentStart<=currentEnd){parent.removeChild(currentChildren[currentEnd].node);currentEnd--}else if(currentEnd<currentStart)while(updatedStart<=updatedEnd){updatedChildren[updatedStart]=this.checkCreateAllNodes(parent,updatedChildren[updatedStart],afterNode);updatedStart++}else{let P=new Int32Array(updatedEnd+1-updatedStart);let I=new Map;for(let i=updatedStart;i<=updatedEnd;i++){P[i]=-1;I.set(updatedChildren[i].nodeData.key,i)}let reusingNodes=updatedStart+updatedChildren.length-1-updatedEnd,toRemove=[];for(let i=currentStart;i<=currentEnd;i++)if(I.has(currentChildren[i].nodeData.key)){P[I.get(currentChildren[i].nodeData.key)]=i;reusingNodes++}else toRemove.push(i);if(reusingNodes===0){parent.textContent="";for(let i=updatedStart;i<=updatedEnd;i++)updatedChildren[i]=this.checkCreateAllNodes(parent,updatedChildren[i])}else{let toRemoveLength=toRemove.length;for(let i=0;i<toRemoveLength;i++)parent.removeChild(currentChildren[toRemove[i]].node);let longestSeq=longestSubsequence(P,updatedStart),seqIndex=longestSeq.length-1;for(let i=updatedEnd;i>=updatedStart;i--){if(longestSeq[seqIndex]===i){currentHtml=currentChildren[P[longestSeq[seqIndex]]];updatedChildren[i]=this.updateAllNodes(parent,currentHtml,updatedChildren[i]);afterNode=currentHtml.node;seqIndex--}else{if(P[i]===-1){updatedChildren[i]=this.checkCreateAllNodes(parent,updatedChildren[i],afterNode);afterNode=updatedChildren[i].node}else{currentHtml=currentChildren[P[i]];updatedChildren[i]=this.updateAllNodes(parent,currentHtml,updatedChildren[i]);parent.insertBefore(currentHtml.node,afterNode);afterNode=currentHtml.node}}}}}};function longestSubsequence(ns,updatedStart){let seq=[],is=[],l=-1,i,len,pre=new Int32Array(ns.length);for(i=updatedStart,len=ns.length;i<len;i++){let n=ns[i];if(n<0)continue;let j=findGreatestIndex(seq,n);if(j!==-1)pre[i]=is[j];if(j===l){l++;seq[l]=n;is[l]=i}else if(n<seq[j+1]){seq[j+1]=n;is[j+1]=i}}for(i=is[l];l>=0;i=pre[i],l--)seq[l]=i;return seq}function findGreatestIndex(seq,n){let lo=-1,hi=seq.length;if(hi>0&&seq[hi-1]<=n)return hi-1;while(hi-lo>1){let mid=Math.floor((lo+hi)/2);if(seq[mid]>n)hi=mid;else lo=mid}return lo}F.prototype.updateNonKeyedChildrenNodes=function(parent,currentChildren,updatedChildren){let currentChildrenLength=currentChildren.length,updatedChildrenLength=updatedChildren.length,commonLength=Math.min(currentChildrenLength,updatedChildrenLength);for(let i=0;i<commonLength;++i)updatedChildren[i]=this.updateAllNodes(parent,currentChildren[i],updatedChildren[i]);if(currentChildrenLength<updatedChildrenLength)for(let i=commonLength;i<updatedChildrenLength;++i)updatedChildren[i]=this.checkCreateAllNodes(parent,updatedChildren[i]);else if(currentChildrenLength>updatedChildrenLength)for(let i=commonLength;i<currentChildrenLength;++i)parent.removeChild(currentChildren[i].node)};F.prototype.updateNodeData=function(node,currentNodeData,updatedHtml,isSvg){updateStyles(node,currentNodeData.styles,updatedHtml.nodeData.styles);updateAttributes(node,currentNodeData.attributes,updatedHtml.nodeData.attributes);updateClasses(node,currentNodeData.classes,updatedHtml.nodeData.classes,isSvg);updateProperties(node,currentNodeData.properties,updatedHtml.nodeData.properties);this.updateEvents(node,currentNodeData.events,updatedHtml)};function updateStyles(node,currentStyles,updatedStyles){if(currentStyles===void 0){if(updatedStyles!==void 0)createStyles(node,updatedStyles)}else if(updatedStyles===void 0){if(currentStyles!==void 0)node.removeAttribute("style")}else{let matchCount=0;for(let key in currentStyles){let current=currentStyles[key],updated=updatedStyles[key],hasUpdated=updatedStyles[key]!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node.style.setProperty(key,updated);else node.style.removeProperty(key)}let newKeys=Object.keys(updatedStyles),newKeysLength=newKeys.length;for(let i=0;matchCount<newKeysLength&&i<newKeysLength;++i){let key=newKeys[i];if(currentStyles[key]===void 0){let updated=updatedStyles[key];++matchCount;node.style.setProperty(key,updated)}}}}function updateClasses(node,currentClasses,updatedClasses,isSvg){let classUpdated=updatedClasses!==void 0&&updatedClasses.length>0;if(currentClasses!==void 0&&currentClasses.length>0&&!classUpdated)createClasses(node,[],isSvg);else if(classUpdated)createClasses(node,updatedClasses,isSvg)}function updateAttributes(node,currentAttributes,updatedAttributes){if(currentAttributes===void 0){if(updatedAttributes!==void 0)createAttributes(node,updatedAttributes)}else if(updatedAttributes===void 0){if(currentAttributes!==void 0)for(let key in currentAttributes)node.removeAttribute(key)}else{let matchCount=0;for(let key in currentAttributes){let current=currentAttributes[key],updated=updatedAttributes[key],hasUpdated=updated!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node.setAttribute(key,updated);else node.removeAttribute(key)}let newKeys=Object.keys(updatedAttributes),newKeysLength=newKeys.length;for(let i=0;matchCount<newKeysLength&&i<newKeysLength;++i){let key=newKeys[i];if(currentAttributes[key]===void 0){let updated=updatedAttributes[key];++matchCount;node.setAttribute(key,updated)}}}}function updateProperties(node,currentProperties,updatedProperties){let addAll=currentProperties===void 0,removeAll=updatedProperties===void 0;if(addAll){if(!removeAll)for(let key in updatedProperties)node[key]=updatedProperties[key]}else if(removeAll){if(!addAll)for(let key in currentProperties)node.removeAttribute(key)}else{let matchCount=0;for(let key in currentProperties){let current=currentProperties[key],updated=updatedProperties[key],hasUpdated=updated!==void 0;if(hasUpdated)matchCount++;if(current!==updated)if(hasUpdated)node[key]=updated;else node.removeAttribute(key)}let newKeys=Object.keys(updatedProperties),newKeysLength=newKeys.length;for(let i=0;matchCount<newKeysLength&&i<newKeysLength;++i){let key=newKeys[i];if(currentProperties[key]===void 0){let updated=updatedProperties[key];++matchCount;node[key]=updated}}}}F.prototype.updateEvents=function(node,currentEvents,updatedHtml){let updatedEvents=updatedHtml.nodeData.events;if(currentEvents===void 0){if(updatedEvents!==void 0)this.createAllEvents(node,updatedHtml)}else if(updatedEvents===void 0){if(currentEvents!==void 0)for(let key in currentEvents)this.removeEvent(node,key)}else{let matchCount=0;for(let key in currentEvents){let current=currentEvents[key],updated=updatedEvents[key],hasUpdated=false;if(updated===void 0)this.removeEvent(node,key);else{let currentLength=current.length,updatedLength=updated.length;if(currentLength!=updatedLength)hasUpdated=true;else{for(let i=0;i<currentLength;++i)if(current[i]!=updated[i]){hasUpdated=true;break}}}if(hasUpdated){matchCount++;this.removeEvent(node,key);this.createEvent(node,key,updatedHtml)}}let newKeys=Object.keys(updatedEvents),newKeysLength=newKeys.length;for(let i=0;matchCount<newKeysLength&&i<newKeysLength;++i){let key=newKeys[i];if(currentEvents[key]===void 0){++matchCount;this.createEvent(node,key,updatedHtml)}}}};F.prototype.removeEvent=function(node,name2){let eventKey=eventPrefix+name2;if(nonBubblingEvents.includes(name2)){let runNonBubblingEvent=node[eventKey];node.removeEventListener(name2,runNonBubblingEvent,false)}else{let count=--this.applicationEvents.get(name2).count;if(count===0){this.root.removeEventListener(name2,this.applicationEvents.get(name2).handler,false);this.applicationEvents.delete(name2)}}node[eventKey+eventPostfix]=void 0;node[eventKey]=void 0};function lazyMessageMap(mapper,html){html.messageMapper=mapper;if(html.children!==void 0&&html.children.length>0)for(let i=0;i<html.children.length;++i)lazyMessageMap(mapper,html.children[i])}var pure2=pure(applicativeEffect);var resume=runEffectFn2(resume_);var maybeUpdater=function(updater){return function(v){if(v instanceof Just){return updater(v.value0)}return pure2(unit)}};var start=function(parent){return function(updater){return runEffectFn4(start_)(Just.create)(parent)(maybeUpdater(updater))}};var startFrom=function(parent){return function(updater){return runEffectFn4(startFrom_)(Just.create)(parent)(maybeUpdater(updater))}};var applicationIds=new Set;function checkApplicationId_(id3){if(applicationIds.has(id3))throw`Error mounting application: id ${id3} already registered!`;applicationIds.add(id3)}var Window=function(){function Window2(){}Window2.value=new Window2;return Window2}();var Document=function(){function Document2(){}Document2.value=new Document2;return Document2}();var Custom=function(){function Custom2(){}Custom2.value=new Custom2;return Custom2}();var isArray=Array.isArray||function(value2){return Object.prototype.toString.call(value2)==="[object Array]"};var unsafeFromForeign=unsafeCoerce2;var createSubscription=function(updater){return function(v){if(v.value0 instanceof Window){return createWindowListener(v.value1.value0)((function($13){return updater(v.value1.value1.value0($13))}))}if(v.value0 instanceof Document){return createDocumentListener(v.value1.value0)((function($14){return updater(v.value1.value1.value0($14))}))}if(v.value0 instanceof Custom){return createCustomListener(v.value1.value0)((function($15){return updater(v.value1.value1.value0($15))}))}throw new Error("Failed pattern match at Flame.Subscription.Internal.Listener (line 31, column 83 - line 34, column 75): "+[v.value0.constructor.name])}};var checkApplicationId=runEffectFn1(checkApplicationId_);var createMessageListener=function(appId){return function(updater){return function __do(){checkApplicationId(appId)();return createCustomListener(appId)((function($16){return updater(unsafeFromForeign($16))}))()}}};var when2=when(applicativeEffect);var for_2=for_(applicativeEffect)(foldableArray);var pure3=pure(applicativeEffect);var traverse_2=traverse_(applicativeEffect)(foldableArray);var map3=map(functorMaybe);var showId=function(dictShow){var show4=show(dictShow);return function(v){return show4(v)}};var run3=function(parent){return function(isResumed){return function(appId){return function(v){return function __do(){var modelState=$$new(v.init.value0)();var renderingState=$$new(21)();var render2=function(model){return function __do2(){var rendering2=read(renderingState)();resume(rendering2)(v.view(model))();return write(model)(modelState)()}};var runUpdate=function(message2){return function __do2(){var currentModel=read(modelState)();var v1=v.update(currentModel)(message2);when2(modelHasChanged(currentModel)(v1.value0))(render2(v1.value0))();return runMessages(v1.value1)()}};var runMessages=function(affs){return for_2(affs)(runAff_((function(v1){if(v1 instanceof Left){return log(message(v1.value0))}if(v1 instanceof Right&&v1.value0 instanceof Just){return runUpdate(v1.value0.value0)}return pure3(unit)})))};var rendering=function(){if(isResumed){return startFrom(parent)(runUpdate)(v.view(v.init.value0))()}return start(parent)(runUpdate)(v.view(v.init.value0))()}();write(rendering)(renderingState)();runMessages(v.init.value1)();(function(){if(appId instanceof Nothing){return unit}if(appId instanceof Just){return createMessageListener(appId.value0)(runUpdate)()}throw new Error("Failed pattern match at Flame.Application.EffectList (line 142, column 7 - line 144, column 62): "+[appId.constructor.name])})();return traverse_2(createSubscription(runUpdate))(v.subscribe)()}}}}};var noAppId=function(){return Nothing.value}();var mountWith=function(dictShow){var showId1=showId(dictShow);return function(v){return function(appId){return function(application){return function __do(){var maybeElement=querySelector(v)();if(maybeElement instanceof Just){return run3(maybeElement.value0)(false)(map3(showId1)(appId))(application)()}if(maybeElement instanceof Nothing){return $$throw("Error mounting application")()}throw new Error("Failed pattern match at Flame.Application.EffectList (line 101, column 7 - line 103, column 62): "+[maybeElement.constructor.name])}}}}};var mountWith1=mountWith(showUnit);var mount_=function(selector){return mountWith1(selector)(noAppId)};var random=Math.random;var randomInt=function(low){return function(high){return function __do(){var n=random();var asNumber=(toNumber(high)-toNumber(low)+1)*n+toNumber(low);return floor2(asNumber)}}};var messageEventData=5;var rawEventData=6;function createEvent_(name2){return function(message2){return[messageEventData,name2,message2]}}function createRawEvent_(name2){return function(handler){return[rawEventData,name2,handler]}}function nodeValue_(event){if(event.target.contentEditable===true||event.target.contentEditable==="true"||event.target.contentEditable==="")return event.target.innerText;return event.target.value}function checkedValue_(event){if(event.target.tagName==="INPUT"&&(event.target.type==="checkbox"||event.target.type==="radio"))return event.target.checked;return false}var map4=map(functorEffect);var nodeValue=runEffectFn1(nodeValue_);var createRawEvent=function(name2){return function(handler){return createRawEvent_(name2)(handler)}};var onInput=function(constructor){var handler=function(event){return map4((function($6){return Just.create(constructor($6))}))(nodeValue(event))};return createRawEvent("input")(handler)};var createEvent=function(name2){return function(message2){return createEvent_(name2)(message2)}};var onClick=createEvent("click");var checkedValue=runEffectFn1(checkedValue_);var onCheck=function(constructor){var handler=function(event){return map4((function($9){return Just.create(constructor($9))}))(checkedValue(event))};return createRawEvent("input")(handler)};var toNodeArray2=toNodeArray(toNodeHtmlHtml);var article_2=article_(toNodeArray2);var nav_2=nav_(toNodeArray2);var toNodeArray1=toNodeArray(toNodeNodeDataNodeData);var div4=div3(toNodeArray1)(toNodeArray2);var class$prime2=class$prime(toClassListString);var button2=button(toNodeArray1)(toNodeArray2);var i_2=i_(toNodeArray2);var max3=max(ordInt);var min3=min(ordInt);var show3=show(showInt);var div_2=div_(toNodeArray2);var input2=input(toNodeArray1);var span4=span(toNodeArray1)(toNodeArray2);var label2=label(toNodeArray1)(toNodeArray2);var span_2=span_(toNodeArray2);var eqRec2=eqRec()(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowCons(eqRowNil)()({reflectSymbol:function(){return"targetDC"}})(eqInt))()({reflectSymbol:function(){return"saveRoll"}})(eqArray(eqInt)))()({reflectSymbol:function(){return"saveBonus"}})(eqInt))()({reflectSymbol:function(){return"disadvantage"}})(eqBoolean))()({reflectSymbol:function(){return"description"}})(eqString))()({reflectSymbol:function(){return"advantage"}})(eqBoolean));var pure1=pure(applicativeAff);var map5=map(functorAff);var liftEffect3=liftEffect(monadEffectAff);var $$delete3=$$delete(eqRec2);var nav2=nav(toNodeArray1)(toNodeArray2);var main2=main(toNodeArray1)(toNodeArray2);var header2=header(toNodeArray1)(toNodeArray2);var h62=h6(toNodeArray1)(toNodeArray2);var div_1=div_(toNodeArray(toNodeArray2));var map1=map(functorArray);var Update=function(){function Update2(value0,value1){this.value0=value0;this.value1=value1}Update2.create=function(value0){return function(value1){return new Update2(value0,value1)}};return Update2}();var Description=function(){function Description2(value0,value1){this.value0=value0;this.value1=value1}Description2.create=function(value0){return function(value1){return new Description2(value0,value1)}};return Description2}();var Bonus=function(){function Bonus2(value0,value1){this.value0=value0;this.value1=value1}Bonus2.create=function(value0){return function(value1){return new Bonus2(value0,value1)}};return Bonus2}();var DC=function(){function DC2(value0,value1){this.value0=value0;this.value1=value1}DC2.create=function(value0){return function(value1){return new DC2(value0,value1)}};return DC2}();var Roll=function(){function Roll2(value0){this.value0=value0}Roll2.create=function(value0){return new Roll2(value0)};return Roll2}();var Remove=function(){function Remove2(value0){this.value0=value0}Remove2.create=function(value0){return new Remove2(value0)};return Remove2}();var Advantage=function(){function Advantage2(value0,value1){this.value0=value0;this.value1=value1}Advantage2.create=function(value0){return function(value1){return new Advantage2(value0,value1)}};return Advantage2}();var Disadvantage=function(){function Disadvantage2(value0,value1){this.value0=value0;this.value1=value1}Disadvantage2.create=function(value0){return function(value1){return new Disadvantage2(value0,value1)}};return Disadvantage2}();var Add=function(){function Add2(){}Add2.value=new Add2;return Add2}();var D4=function(){function D42(){}D42.value=new D42;return D42}();var D6=function(){function D62(){}D62.value=new D62;return D62}();var D8=function(){function D82(){}D82.value=new D82;return D82}();var D10=function(){function D102(){}D102.value=new D102;return D102}();var D12=function(){function D122(){}D122.value=new D122;return D122}();var D20=function(){function D202(){}D202.value=new D202;return D202}();var Acid=function(){function Acid2(){}Acid2.value=new Acid2;return Acid2}();var Fire=function(){function Fire2(){}Fire2.value=new Fire2;return Fire2}();var Thunder=function(){function Thunder2(){}Thunder2.value=new Thunder2;return Thunder2}();var AddAttackRoll=function(){function AddAttackRoll2(){}AddAttackRoll2.value=new AddAttackRoll2;return AddAttackRoll2}();var RemoveAttackRoll=function(){function RemoveAttackRoll2(value0){this.value0=value0}RemoveAttackRoll2.create=function(value0){return new RemoveAttackRoll2(value0)};return RemoveAttackRoll2}();var Save=function(){function Save2(value0){this.value0=value0}Save2.create=function(value0){return new Save2(value0)};return Save2}();var viewAttackRoll=function(attack){return article_2([nav_2([text("Attack Roll:"),div4([class$prime2("max")])([text("")]),button2([class$prime2("square round extra"),onClick(new RemoveAttackRoll(attack))])([i_2([text("delete")])])])])};var updateArray=function(dictEq){var eq2=eq(dictEq);return function(arr){return function(item){return function(newItem){var v=findIndex((function(x){return eq2(x)(item)}))(arr);if(v instanceof Nothing){return arr}if(v instanceof Just){var v1=updateAt(v.value0)(newItem)(arr);if(v1 instanceof Nothing){return arr}if(v1 instanceof Just){return v1.value0}throw new Error("Failed pattern match at ToolsApp (line 147, column 17 - line 149, column 28): "+[v1.constructor.name])}throw new Error("Failed pattern match at ToolsApp (line 145, column 3 - line 149, column 28): "+[v.constructor.name])}}}};var updateArray1=updateArray(eqRec2);var saveRoll=function(save){if(save.saveRoll.length===2){var $102=[save.advantage,save.disadvantage];if($102.length===2&&($102[0]&&!$102[1])){return max3(save["saveRoll"][0])(save["saveRoll"][1])}if($102.length===2&&(!$102[0]&&$102[1])){return min3(save["saveRoll"][0])(save["saveRoll"][1])}return save["saveRoll"][0]}return 0};var saveLine2=function(save){var $109=save.targetDC===0;if($109){return Nothing.value}var $110=(saveRoll(save)+save.saveBonus|0)>=save.targetDC;if($110){return new Just(div4([class$prime2("primary")])([text("Target DC: "+(show3(save.targetDC)+", Success!"))]))}return new Just(div4([class$prime2("error")])([text("Target DC: "+(show3(save.targetDC)+", Failure!"))]))};var saveLine1=function(save){if(save.saveRoll.length===2){var $112=save.advantage===save.disadvantage;if($112){return"Roll ["+(show3(save["saveRoll"][0])+("] + Bonus ["+(show3(save.saveBonus)+("] = "+show3(saveRoll(save)+save.saveBonus|0)))))}return"Roll ["+(show3(save["saveRoll"][0])+(","+(show3(save["saveRoll"][1])+("] + Bonus ["+(show3(save.saveBonus)+("] = "+show3(saveRoll(save)+save.saveBonus|0)))))))}return"-"};var showSaveResult=function(save){var v=saveLine2(save);if(v instanceof Nothing){return div_2([text(saveLine1(save))])}if(v instanceof Just){return div_2([div_2([text(saveLine1(save))]),v.value0])}throw new Error("Failed pattern match at ToolsApp (line 210, column 3 - line 216, column 8): "+[v.constructor.name])};var rollDice=function(v){if(v instanceof D4){return randomInt(1)(4)}if(v instanceof D6){return randomInt(1)(6)}if(v instanceof D8){return randomInt(1)(8)}if(v instanceof D10){return randomInt(1)(10)}if(v instanceof D12){return randomInt(1)(12)}if(v instanceof D20){return randomInt(1)(20)}throw new Error("Failed pattern match at ToolsApp (line 82, column 1 - line 82, column 35): "+[v.constructor.name])};var rollSave=function(save){return function __do(){var a=rollDice(D20.value)();var b=rollDice(D20.value)();var roll=[a,b];return{advantage:save.advantage,description:save.description,disadvantage:save.disadvantage,saveBonus:save.saveBonus,targetDC:save.targetDC,saveRoll:roll}}};var mkText=function(caption){return function(msg){return function(value2){return div4([class$prime2("field border")])([input2([type$prime("text"),value(value2),onInput(msg)]),span4([class$prime2("helper")])([text(caption)])])}}};var mkCheckbox=function(caption){return function(icon){return function(msg){return function(value2){return label2([class$prime2("switch icon")])([input2([type$prime("checkbox"),checked(value2),onCheck(msg)]),span_2([i_2([text(icon)])]),div4([class$prime2("tooltip")])([text(caption)])])}}}};var mkButton=function(msg){return function(icon){return button2([class$prime2("square round extra"),onClick(msg)])([i_2([text(icon)])])}};var initSave={description:"",advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:0};var updateSave=function(v){return function(v1){if(v1 instanceof Update){return new Tuple({attackRolls:v.attackRolls,savingThrows:updateArray1(v.savingThrows)(v1.value0)(v1.value1)},[])}if(v1 instanceof Description){return new Tuple(v,[pure1(new Just(new Save(new Update(v1.value0,{advantage:v1.value0.advantage,disadvantage:v1.value0.disadvantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,description:v1.value1}))))])}if(v1 instanceof Bonus){return new Tuple(v,[pure1(new Just(new Save(new Update(v1.value0,{description:v1.value0.description,advantage:v1.value0.advantage,disadvantage:v1.value0.disadvantage,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,saveBonus:v1.value1}))))])}if(v1 instanceof DC){return new Tuple(v,[pure1(new Just(new Save(new Update(v1.value0,{description:v1.value0.description,advantage:v1.value0.advantage,disadvantage:v1.value0.disadvantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value1}))))])}if(v1 instanceof Advantage){return new Tuple(v,[pure1(new Just(new Save(new Update(v1.value0,{description:v1.value0.description,disadvantage:v1.value0.disadvantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,advantage:v1.value1}))))])}if(v1 instanceof Disadvantage){return new Tuple(v,[pure1(new Just(new Save(new Update(v1.value0,{description:v1.value0.description,advantage:v1.value0.advantage,saveBonus:v1.value0.saveBonus,saveRoll:v1.value0.saveRoll,targetDC:v1.value0.targetDC,disadvantage:v1.value1}))))])}if(v1 instanceof Roll){return new Tuple(v,[map5((function($139){return Just.create(Save.create($139))}))(map5(Update.create(v1.value0))(liftEffect3(rollSave(v1.value0))))])}if(v1 instanceof Remove){return new Tuple({attackRolls:v.attackRolls,savingThrows:$$delete3(v1.value0)(v.savingThrows)},[])}if(v1 instanceof Add){return new Tuple({attackRolls:v.attackRolls,savingThrows:snoc(v.savingThrows)(initSave)},[])}throw new Error("Failed pattern match at ToolsApp (line 106, column 1 - line 106, column 75): "+[v.constructor.name,v1.constructor.name])}};var update=function(v){return function(v1){if(v1 instanceof Save){return updateSave(v)(v1.value0)}return new Tuple(v,[])}};var init3=function(){return new Tuple({attackRolls:[{attackBonus:5,advantage:false,disadvantage:false,damageCount:0,description:"Guantlet GFB",targetAC:10,attackRoll:0,damageDice:[{diceType:D8.value,diceCount:1,damageBonus:7,damageRoll:0,damageType:Thunder.value},{diceType:D4.value,diceCount:1,damageBonus:0,damageRoll:0,damageType:Acid.value},{diceType:D8.value,diceCount:2,damageBonus:10,damageRoll:0,damageType:Fire.value}]}],savingThrows:[{advantage:false,disadvantage:false,saveBonus:0,saveRoll:[],targetDC:0,description:"STR Save"},{advantage:false,disadvantage:false,saveBonus:10,saveRoll:[],targetDC:0,description:"INT Save"}]},[])}();var fromStr=function(s){var v=fromString(s);if(v instanceof Nothing){return 0}if(v instanceof Just){return v.value0}throw new Error("Failed pattern match at ToolsApp (line 261, column 3 - line 263, column 17): "+[v.constructor.name])};var mkNumber=function(caption){return function(msg){return function(value2){return div4([class$prime2("field border")])([input2([type$prime("number"),value(show3(value2)),onInput((function(x){return msg(fromStr(x))}))]),span4([class$prime2("helper")])([text(caption)])])}}};var viewSavingThrow=function(save){return article_2([nav2([class$prime2("grid")])([div4([class$prime2("s2")])([mkText("Description")((function(s){return new Save(new Description(save,s))}))(save.description)]),div4([class$prime2("s2")])([mkNumber("Save Bonus")((function(b){return new Save(new Bonus(save,b))}))(save.saveBonus)]),div4([class$prime2("s1")])([mkCheckbox("Advantage")("arrow_upward")((function(b){return new Save(new Advantage(save,b))}))(save.advantage),mkCheckbox("Disadvantage")("arrow_downward")((function(b){return new Save(new Disadvantage(save,b))}))(save.disadvantage)]),div4([class$prime2("s2")])([mkNumber("Target DC")((function(d){return new Save(new DC(save,d))}))(save.targetDC)]),div4([class$prime2("s1")])([mkButton(new Save(new Roll(save)))("Casino")]),div4([class$prime2("s3")])([showSaveResult(save)]),div4([class$prime2("s1")])([mkButton(new Save(new Remove(save)))("delete")])])])};var view=function(model){return main2([class$prime2("responsive")])([div_2([header2([class$prime2("fill")])([nav_2([h62([class$prime2("max left-align")])([text("Attack Rolls")]),div4([class$prime2("max")])([text("")]),button2([class$prime2("square round extra"),onClick(AddAttackRoll.value)])([i_2([text("add")])])])]),div_1([map1(viewAttackRoll)(model.attackRolls)]),br,header2([class$prime2("fill")])([nav_2([h62([class$prime2("max left-align")])([text("Saving Throws")]),div4([class$prime2("max")])([text("")]),button2([class$prime2("square round extra"),onClick(new Save(Add.value))])([i_2([text("add")])])])]),div_1([map1(viewSavingThrow)(model.savingThrows)])])])};var main3=mount_("body")({init:init3,subscribe:[],update:update,view:view});main3()})();
